;
; +-------------------------------------------------------------------------+
; |      This file was generated by The Interactive Disassembler (IDA)      |
; |           Copyright (c) 2020 Hex-Rays, <support@hex-rays.com>           |
; |                      License info: 48-3F44-37CB-25                      |
; |                             IDA PRO 7.5 SP3                             |
; +-------------------------------------------------------------------------+
;
; Input SHA256 : 3854367C72EC7F6011C901C8FC7AC2B4C3D2E126F00E3ADB9B3AD045FA6420AB
; Input MD5    : B5EA0A98E1BA55A17BB8EF22EF123670
; Input CRC32  : 334566E9

; File Name   : C:\Users\mbks\Desktop\goodprogram\comparator\get_statistic\test_file\vuln2.exe
; Format      : Portable executable for 80386 (PE)
; Imagebase   : 400000
; Timestamp   : 56E72FD5 (Mon Mar 14 21:40:37 2016)
; Section 1. (virtual address 00001000)
; Virtual size                  : 000076F4 (  30452.)
; Section size in file          : 00007800 (  30720.)
; Offset to raw data for section: 00000400
; Flags 60500060: Text Data Executable Readable
; Alignment     : 16 bytes
; OS type         :  MS Windows
; Application type:  Executable 32bit

                .686p
                .mmx
                .model flat
.intel_syntax noprefix

; ===========================================================================

; Segment type: Pure code
; Segment permissions: Read/Execute
_text           segment para public 'CODE' use32
                assume cs:_text
                ;org 401000h
                assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B R O U T I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter proc near       ; DATA XREF: sub_401180:loc_4011AC\u2193o

Signal          = dword ptr -1Ch
Function        = dword ptr -18h
var_10          = dword ptr -10h
ExceptionInfo   = dword ptr  4

                push    ebx
                sub     esp, 18h
                mov     eax, [esp+1Ch+ExceptionInfo]
                mov     eax, [eax]
                mov     eax, [eax]
                cmp     eax, 0C0000091h
                ja      short loc_401060
                cmp     eax, 0C000008Dh
                jnb     short loc_401075
                cmp     eax, 0C0000005h
                jnz     loc_4010B3
                mov     [esp+1Ch+Function], 0 ; Function
                mov     [esp+1Ch+Signal], 0Bh ; Signal
                call    signal
                cmp     eax, 1
                jz      loc_401103
                test    eax, eax
                jnz     loc_4010F0
                lea     esi, [esi+0]

loc_401050:                             ; CODE XREF: TopLevelExceptionFilter+73\u2193j
                                        ; TopLevelExceptionFilter+A1\u2193j ...
                xor     eax, eax

loc_401052:                             ; CODE XREF: TopLevelExceptionFilter+B1\u2193j
                                        ; TopLevelExceptionFilter+E9\u2193j ...
                add     esp, 18h
                pop     ebx
                retn    4
; ---------------------------------------------------------------------------
                align 10h

loc_401060:                             ; CODE XREF: TopLevelExceptionFilter+11\u2191j
                cmp     eax, 0C0000094h
                jz      short loc_401080
                cmp     eax, 0C0000096h
                jz      short loc_4010BA
                cmp     eax, 0C0000093h
                jnz     short loc_401050

loc_401075:                             ; CODE XREF: TopLevelExceptionFilter+18\u2191j
                mov     ebx, 1
                jmp     short loc_401082
; ---------------------------------------------------------------------------
                align 10h

loc_401080:                             ; CODE XREF: TopLevelExceptionFilter+65\u2191j
                xor     ebx, ebx

loc_401082:                             ; CODE XREF: TopLevelExceptionFilter+7A\u2191j
                mov     [esp+1Ch+Function], 0 ; Function
                mov     [esp+1Ch+Signal], 8 ; Signal
                call    signal
                cmp     eax, 1
                jz      loc_401140
                test    eax, eax
                jz      short loc_401050
                mov     [esp+1Ch+Signal], 8
                call    eax
                mov     eax, 0FFFFFFFFh
                jmp     short loc_401052
; ---------------------------------------------------------------------------

loc_4010B3:                             ; CODE XREF: TopLevelExceptionFilter+1F\u2191j
                cmp     eax, 0C000001Dh
                jnz     short loc_401050

loc_4010BA:                             ; CODE XREF: TopLevelExceptionFilter+6C\u2191j
                mov     [esp+1Ch+Function], 0 ; Function
                mov     [esp+1Ch+Signal], 4 ; Signal
                call    signal
                cmp     eax, 1
                jz      short loc_40111F
                test    eax, eax
                jz      loc_401050
                mov     [esp+1Ch+Signal], 4
                call    eax
                mov     eax, 0FFFFFFFFh
                jmp     loc_401052
; ---------------------------------------------------------------------------
                align 10h

loc_4010F0:                             ; CODE XREF: TopLevelExceptionFilter+44\u2191j
                mov     [esp+1Ch+Signal], 0Bh
                call    eax
                mov     eax, 0FFFFFFFFh
                jmp     loc_401052
; ---------------------------------------------------------------------------

loc_401103:                             ; CODE XREF: TopLevelExceptionFilter+3C\u2191j
                mov     [esp+1Ch+Function], 1 ; Function
                mov     [esp+1Ch+Signal], 0Bh ; Signal
                call    signal
                or      eax, 0FFFFFFFFh
                jmp     loc_401052
; ---------------------------------------------------------------------------

loc_40111F:                             ; CODE XREF: TopLevelExceptionFilter+D1\u2191j
                mov     [esp+1Ch+Function], 1 ; Function
                mov     [esp+1Ch+Signal], 4 ; Signal
                call    signal
                or      eax, 0FFFFFFFFh
                jmp     loc_401052
; ---------------------------------------------------------------------------
                align 10h

loc_401140:                             ; CODE XREF: TopLevelExceptionFilter+99\u2191j
                mov     [esp+1Ch+Function], 1 ; Function
                mov     [esp+1Ch+Signal], 8 ; Signal
                call    signal
                test    ebx, ebx
                mov     eax, 0FFFFFFFFh
                jz      loc_401052
                mov     [esp+1Ch+var_10], eax
                call    sub_401B40
                mov     eax, [esp+1Ch+var_10]
                jmp     loc_401052
TopLevelExceptionFilter endp

; ---------------------------------------------------------------------------
                align 10h
; [000000DF BYTES: COLLAPSED FUNCTION sub_401180. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h

; =============== S U B R O U T I N E =======================================


sub_401260      proc near               ; CODE XREF: sub_401750:loc_401A20\u2193p

var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_14          = byte ptr -14h
var_10          = dword ptr -10h

                sub     esp, 3Ch
                lea     eax, [esp+3Ch+var_10]
                mov     [esp+3Ch+var_2C], eax
                mov     eax, dword_40900C
                mov     [esp+3Ch+var_38], offset argv
                mov     [esp+3Ch+var_3C], offset argc
                mov     [esp+3Ch+var_10], 0
                and     eax, 1
                mov     [esp+3Ch+var_30], eax
                lea     eax, [esp+3Ch+var_14]
                mov     [esp+3Ch+var_34], eax
                call    __getmainargs
                add     esp, 3Ch
                retn
sub_401260      endp

; ---------------------------------------------------------------------------
                align 10h
; [00000015 BYTES: COLLAPSED FUNCTION start. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
                sub     esp, 1Ch
                mov     dword ptr [esp], 2
                call    ds:__set_app_type
                call    sub_401180
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_4012E0      proc near               ; CODE XREF: sub_401BD0-27\u2193p
                                        ; sub_407710+84\u2193p ...
                mov     eax, ds:atexit
                jmp     eax
sub_4012E0      endp

; ---------------------------------------------------------------------------
                align 10h
                mov     eax, ds:_onexit
                jmp     eax
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_401300      proc near               ; CODE XREF: sub_4086C0+6\u2193p
                push    ebp
                mov     ebp, esp
                sub     esp, 18h
                mov     dword ptr [esp], offset ModuleName ; "libgcc_s_dw2-1.dll"
                call    GetModuleHandleA
                mov     edx, 0
                sub     esp, 4
                test    eax, eax
                jz      short loc_401333
                mov     dword ptr [esp+4], offset ProcName ; "__register_frame_info"
                mov     [esp], eax      ; hModule
                call    GetProcAddress
                sub     esp, 8
                mov     edx, eax

loc_401333:                             ; CODE XREF: sub_401300+1C\u2191j
                test    edx, edx
                jz      short loc_401348
                mov     dword ptr [esp+4], offset dword_40D008
                mov     dword ptr [esp], offset dword_40B0C0
                call    edx

loc_401348:                             ; CODE XREF: sub_401300+35\u2191j
                mov     eax, dword_409030
                test    eax, eax
                jz      short locret_40138B
                mov     dword ptr [esp], offset aLibgcj13Dll ; "libgcj-13.dll"
                call    GetModuleHandleA
                mov     edx, 0
                sub     esp, 4
                test    eax, eax
                jz      short loc_40137E
                mov     dword ptr [esp+4], offset aJvRegisterclas ; "_Jv_RegisterClasses"
                mov     [esp], eax      ; hModule
                call    GetProcAddress
                sub     esp, 8
                mov     edx, eax

loc_40137E:                             ; CODE XREF: sub_401300+67\u2191j
                test    edx, edx
                jz      short locret_40138B
                mov     dword ptr [esp], offset dword_409030
                call    edx

locret_40138B:                          ; CODE XREF: sub_401300+4F\u2191j
                                        ; sub_401300+80\u2191j
                leave
                retn
sub_401300      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_401390      proc near               ; DATA XREF: sub_4086C0+B\u2193o
                push    ebp
                mov     ebp, esp
                sub     esp, 18h
                mov     dword ptr [esp], offset ModuleName ; "libgcc_s_dw2-1.dll"
                call    GetModuleHandleA
                mov     edx, 0
                sub     esp, 4
                test    eax, eax
                jz      short loc_4013C3
                mov     dword ptr [esp+4], offset aDeregisterFram ; "__deregister_frame_info"
                mov     [esp], eax      ; hModule
                call    GetProcAddress
                sub     esp, 8
                mov     edx, eax

loc_4013C3:                             ; CODE XREF: sub_401390+1C\u2191j
                test    edx, edx
                jz      short locret_4013D0
                mov     dword ptr [esp], offset dword_40B0C0
                call    edx

locret_4013D0:                          ; CODE XREF: sub_401390+35\u2191j
                leave
                retn
sub_401390      endp

; ---------------------------------------------------------------------------
                align 10h
; Exported entry   4. parse_string

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

; int __cdecl parse_string(char *Str)
                public parse_string
parse_string    proc near               ; CODE XREF: parse_string+5B\u2193p
                                        ; _main+135\u2193p

var_C           = dword ptr -0Ch
Str             = dword ptr  8

                push    ebp
                mov     ebp, esp
                sub     esp, 28h
                mov     dword ptr [esp+4], offset start_str ; "/start"
                mov     eax, [ebp+Str]
                mov     [esp], eax      ; Str
                call    strstr
                mov     [ebp+var_C], eax
                cmp     [ebp+var_C], 0
                jnz     short loc_401427
                mov     edx, ds:dword_40DA28
                mov     eax, ds:dword_40DA24
                mov     [esp+8], edx
                mov     [esp+4], eax
                mov     eax, [ebp+Str]
                mov     [esp], eax
                call    vuln_func
                mov     eax, 1
                jmp     short locret_401445
; ---------------------------------------------------------------------------

loc_401427:                             ; CODE XREF: parse_string+20\u2191j
                mov     dword ptr [esp], offset start_str ; "/start"
                call    strlen
                mov     edx, [ebp+var_C]
                add     eax, edx
                mov     [esp], eax      ; Str
                call    parse_string
                mov     eax, 0

locret_401445:                          ; CODE XREF: parse_string+45\u2191j
                leave
                retn
parse_string    endp

; Exported entry   3. main

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fuzzy-sp

; int __cdecl main(int argc, const char **argv, const char **envp)
                public _main
_main           proc near               ; CODE XREF: sub_401180+CB\u2191p

Buffer          = byte ptr -20Ch
var_10C         = dword ptr -10Ch
argc            = dword ptr  8
argv            = dword ptr  0Ch
envp            = dword ptr  10h

                push    ebp
                mov     ebp, esp
                push    edi
                push    ebx
                and     esp, 0FFFFFFF0h
                sub     esp, 220h
                call    sub_401BD0
                mov     dword ptr [esp+121h], 666E6F63h
                mov     dword ptr [esp+125h], 6769h
                lea     edx, [esp+129h]
                mov     ebx, 0F7h ; '÷'
                mov     eax, 0
                mov     ecx, edx
                and     ecx, 1
                test    ecx, ecx
                jz      short loc_401492
                mov     [edx], al
                add     edx, 1
                sub     ebx, 1

loc_401492:                             ; CODE XREF: _main+41\u2191j
                mov     ecx, edx
                and     ecx, 2
                test    ecx, ecx
                jz      short loc_4014A4
                mov     [edx], ax
                add     edx, 2
                sub     ebx, 2

loc_4014A4:                             ; CODE XREF: _main+52\u2191j
                mov     ecx, ebx
                shr     ecx, 2
                mov     edi, edx
                rep stosd
                mov     edx, edi
                mov     ecx, ebx
                and     ecx, 2
                test    ecx, ecx
                jz      short loc_4014BE
                mov     [edx], ax
                add     edx, 2

loc_4014BE:                             ; CODE XREF: _main+6F\u2191j
                and     ebx, 1
                mov     ecx, ebx
                test    ecx, ecx
                jz      short loc_4014CC
                mov     [edx], al
                add     edx, 1

loc_4014CC:                             ; CODE XREF: _main+7E\u2191j
                mov     dword ptr [esp], offset Buffer ; "\nVERSION: 0.3"
                call    puts
                mov     dword ptr [esp], offset asc_40A078 ; "\n====================================="...
                call    puts
                mov     eax, 2
                cmp     eax, 2
                jz      short loc_401512
                mov     eax, 2
                mov     [esp+8], eax
                mov     dword ptr [esp+4], 2
                mov     dword ptr [esp], offset Format ; "ERROR: Variant in binary was changed (%"...
                call    printf
                mov     eax, 0FFFFFFFFh
                jmp     short loc_401586
; ---------------------------------------------------------------------------

loc_401512:                             ; CODE XREF: _main+A5\u2191j
                mov     dword ptr [esp+4], 2
                mov     dword ptr [esp], offset aVariantD ; "Variant: %d\n"
                call    printf
                mov     dword ptr [esp], offset asc_40A0F8 ; "======================================="...
                call    puts
                call    Func1
                mov     dword ptr [esp+8], 2
                mov     dword ptr [esp+4], offset aConfigD ; "config_%d"
                lea     eax, [esp+228h+Buffer]
                mov     [esp], eax      ; Buffer
                call    sprintf
                lea     eax, [esp+228h+var_10C]
                mov     [esp+8], eax    ; int
                mov     dword ptr [esp+4], offset cfg ; void *
                lea     eax, [esp+228h+Buffer]
                mov     [esp], eax      ; FileName
                call    read_config
                mov     eax, [esp+11Ch]
                mov     [esp], eax      ; Str
                call    parse_string
                mov     eax, 0

loc_401586:                             ; CODE XREF: _main+C9\u2191j
                lea     esp, [ebp-8]
                pop     ebx
                pop     edi
                pop     ebp
                retn
_main           endp

; Exported entry   8. vuln_func

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

                public vuln_func
vuln_func       proc near               ; CODE XREF: parse_string+3B\u2191p

var_9CC         = byte ptr -9CCh
arg_0           = dword ptr  8
arg_8           = dword ptr  10h

                push    ebp
                mov     ebp, esp
                sub     esp, 9E8h
                mov     dword ptr [esp+8], 9C4h ; Size
                mov     dword ptr [esp+4], 62h ; 'b' ; Val
                lea     eax, [ebp+var_9CC]
                mov     [esp], eax      ; void *
                call    memset
                mov     eax, [ebp+arg_8]
                mov     edx, [ebp+arg_0]
                mov     [esp+0Ch], edx
                mov     dword ptr [esp+8], offset aS ; "%s"
                mov     [esp+4], eax
                lea     eax, [ebp+var_9CC]
                mov     [esp], eax
                call    sub_402270
                lea     eax, [ebp+var_9CC]
                mov     [esp+4], eax
                mov     dword ptr [esp], offset aBufferS ; "buffer: %s\n"
                call    printf
                leave
                retn
vuln_func       endp

; Exported entry   5. read_config

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

; int __cdecl read_config(char *FileName, void *, int)
                public read_config
read_config     proc near               ; CODE XREF: _main+126\u2191p

Buffer          = dword ptr -14h
ElementCount    = dword ptr -10h
Stream          = dword ptr -0Ch
FileName        = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h

                push    ebp
                mov     ebp, esp
                sub     esp, 28h
                mov     dword ptr [esp+4], offset aRb ; "rb"
                mov     eax, [ebp+FileName]
                mov     [esp], eax      ; FileName
                call    fopen
                mov     [ebp+Stream], eax
                cmp     [ebp+Stream], 0
                jnz     short loc_401631
                mov     eax, [ebp+FileName]
                mov     [esp+4], eax
                mov     dword ptr [esp], offset aErrorCouldnTOp ; "Error: couldn`t open config file '%s'\n"
                call    printf
                mov     dword ptr [esp], 0FFFFFFFFh ; Code
                call    exit
; ---------------------------------------------------------------------------

loc_401631:                             ; CODE XREF: read_config+20\u2191j
                mov     dword ptr [esp+8], 2 ; Origin
                mov     dword ptr [esp+4], 0 ; Offset
                mov     eax, [ebp+Stream]
                mov     [esp], eax      ; Stream
                call    fseek
                mov     eax, [ebp+Stream]
                mov     [esp], eax      ; Stream
                call    ftell
                mov     [ebp+ElementCount], eax
                mov     dword ptr [esp+8], 0 ; Origin
                mov     dword ptr [esp+4], 0 ; Offset
                mov     eax, [ebp+Stream]
                mov     [esp], eax      ; Stream
                call    fseek
                mov     eax, [ebp+ElementCount]
                add     eax, 1
                mov     [esp], eax      ; Size
                call    malloc
                mov     [ebp+Buffer], eax
                mov     eax, [ebp+ElementCount]
                mov     edx, [ebp+Stream]
                mov     [esp+0Ch], edx  ; Stream
                mov     [esp+8], eax    ; ElementCount
                mov     dword ptr [esp+4], 1 ; ElementSize
                mov     eax, [ebp+Buffer]
                mov     [esp], eax      ; Buffer
                call    fread
                mov     edx, [ebp+ElementCount]
                mov     eax, [ebp+Buffer]
                add     eax, edx
                mov     byte ptr [eax], 0
                mov     eax, [ebp+ElementCount]
                cmp     eax, 2Fh ; '/'
                jbe     short loc_4016D4
                mov     dword ptr [esp+8], 30h ; '0' ; Size
                mov     eax, [ebp+Buffer]
                mov     [esp+4], eax    ; Src
                mov     eax, [ebp+arg_4]
                mov     [esp], eax      ; void *
                call    memcpy

loc_4016D4:                             ; CODE XREF: read_config+C8\u2191j
                mov     eax, [ebp+Buffer]
                lea     edx, [eax+30h]
                mov     eax, [ebp+arg_8]
                mov     [eax], edx
                mov     eax, [ebp+arg_4]
                mov     edx, [eax+8]
                mov     eax, [ebp+arg_4]
                mov     eax, [eax+4]
                mov     [esp+8], edx
                mov     [esp+4], eax
                mov     dword ptr [esp], offset aReadConfigShel ; "read config:  shell_len %d  dst_len %d"...
                call    printf
                mov     eax, [ebp+Stream]
                mov     [esp], eax      ; Stream
                call    fflush
                mov     eax, [ebp+Stream]
                mov     [esp], eax      ; Stream
                call    fclose
                mov     eax, [ebp+arg_4]
                movzx   eax, byte ptr [eax]
                cmp     al, 2
                jz      short loc_401737
                mov     dword ptr [esp], offset aErrorVariantDo ; "ERROR: variant does not match"
                call    puts
                mov     dword ptr [esp], 0FFFFFFFFh ; Code
                call    exit
; ---------------------------------------------------------------------------

loc_401737:                             ; CODE XREF: read_config+12D\u2191j
                mov     eax, 0
                leave
                retn
read_config     endp

; ---------------------------------------------------------------------------
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION Func1. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_401750      proc near               ; CODE XREF: sub_401180+45\u2191p

var_40          = dword ptr -40h
Str             = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                push    ebx
                sub     esp, 4Ch
                test    byte ptr dword_40900C, 2
                jz      loc_401A20
                call    GetCommandLineA
                mov     [ebp+var_40], esp
                mov     [esp], eax      ; Str
                mov     esi, eax
                call    strlen
                lea     eax, [eax+eax+11h]
                and     eax, 0FFFFFFF0h
                call    sub_402240
                sub     esp, eax
                lea     eax, [esp+10h]
                mov     edx, eax
                mov     [ebp+Str], eax
                mov     eax, dword_40900C
                mov     [ebp+var_1C], 0
                mov     [ebp+var_30], 0
                mov     [ebp+var_34], 0
                and     eax, 40h
                cmp     eax, 1
                sbb     eax, eax
                mov     [ebp+var_38], eax
                xor     eax, eax
                and     [ebp+var_38], 0FFFFC000h
                add     [ebp+var_38], 4010h
                mov     [ebp+var_2C], edx

loc_4017C7:                             ; CODE XREF: sub_401750+178\u2193j
                                        ; sub_401750+1E0\u2193j ...
                add     esi, 1
                movzx   ebx, byte ptr [esi-1]
                movsx   ecx, bl
                test    ecx, ecx
                jz      short loc_401850

loc_4017D5:                             ; CODE XREF: sub_401750+F8\u2193j
                cmp     bl, 3Fh ; '?'
                jz      loc_4018F1
                jg      loc_4018D0
                cmp     bl, 27h ; '''
                jz      loc_4019D0
                cmp     bl, 2Ah ; '*'
                jz      loc_4018F1
                cmp     bl, 22h ; '"'
                jnz     loc_401935
                mov     ebx, eax
                sar     ebx, 1
                jz      loc_401A47
                mov     edx, [ebp+var_2C]
                add     ebx, edx
                xchg    ax, ax

loc_401810:                             ; CODE XREF: sub_401750+C9\u2193j
                add     edx, 1
                cmp     edx, ebx
                mov     byte ptr [edx-1], 5Ch ; '\'
                jnz     short loc_401810

loc_40181B:                             ; CODE XREF: sub_401750+2FA\u2193j
                test    al, 1
                jnz     loc_4018B6
                cmp     [ebp+var_30], 27h ; '''
                jz      loc_4018B6

loc_40182D:                             ; CODE XREF: sub_401750+2AB\u2193j
                add     esi, 1
                xor     eax, eax
                mov     [ebp+var_2C], ebx
                movzx   ebx, byte ptr [esi-1]
                xor     [ebp+var_30], ecx
                mov     [ebp+var_34], 1
                movsx   ecx, bl
                test    ecx, ecx
                jnz     short loc_4017D5
                lea     esi, [esi+0]

loc_401850:                             ; CODE XREF: sub_401750+83\u2191j
                test    eax, eax
                mov     edx, [ebp+var_2C]
                jz      loc_401A4F
                add     eax, edx
                lea     esi, [esi+0]

loc_401860:                             ; CODE XREF: sub_401750+119\u2193j
                add     edx, 1
                cmp     edx, eax
                mov     byte ptr [edx-1], 5Ch ; '\'
                jnz     short loc_401860

loc_40186B:                             ; CODE XREF: sub_401750+301\u2193j
                mov     edx, [ebp+var_34]
                test    edx, edx
                jnz     short loc_401877
                cmp     [ebp+Str], eax
                jnb     short loc_40189B

loc_401877:                             ; CODE XREF: sub_401750+120\u2191j
                mov     byte ptr [eax], 0
                lea     eax, [ebp+var_28]
                mov     [esp+0Ch], eax  ; int
                mov     dword ptr [esp+8], 0 ; int
                mov     eax, [ebp+var_38]
                mov     [esp+4], eax    ; int
                mov     eax, [ebp+Str]
                mov     [esp], eax      ; Str
                call    sub_402F20

loc_40189B:                             ; CODE XREF: sub_401750+125\u2191j
                mov     eax, [ebp+var_24]
                mov     ds:argc, eax
                mov     eax, [ebp+var_20]
                mov     ds:argv, eax
                mov     esp, [ebp+var_40]
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4018B6:                             ; CODE XREF: sub_401750+CD\u2191j
                                        ; sub_401750+D7\u2191j
                lea     eax, [ebx+1]
                mov     [ebp+var_2C], eax
                xor     eax, eax
                mov     byte ptr [ebx], 22h ; '"'
                mov     [ebp+var_34], 1
                jmp     loc_4017C7
; ---------------------------------------------------------------------------
                align 10h

loc_4018D0:                             ; CODE XREF: sub_401750+8E\u2191j
                cmp     bl, 5Ch ; '\'
                jz      loc_401A18
                cmp     bl, 7Fh
                jz      short loc_4018F1
                cmp     bl, 5Bh ; '['
                jnz     short loc_401935
                test    byte ptr dword_40900C, 20h
                mov     edi, 1
                jz      short loc_4018FB

loc_4018F1:                             ; CODE XREF: sub_401750+88\u2191j
                                        ; sub_401750+A0\u2191j ...
                mov     edx, [ebp+var_30]
                test    edx, edx
                setnz   dl
                mov     edi, edx

loc_4018FB:                             ; CODE XREF: sub_401750+19F\u2191j
                test    eax, eax
                jz      loc_401A37
                mov     edx, [ebp+var_2C]
                add     eax, edx

loc_401908:                             ; CODE XREF: sub_401750+1C1\u2193j
                add     edx, 1
                cmp     edx, eax
                mov     byte ptr [edx-1], 5Ch ; '\'
                jnz     short loc_401908

loc_401913:                             ; CODE XREF: sub_401750+2EA\u2193j
                mov     edx, edi
                test    dl, dl
                jnz     loc_4019C0
                cmp     ecx, 7Fh
                jz      loc_4019C0

loc_401926:                             ; CODE XREF: sub_401750+276\u2193j
                lea     ecx, [eax+1]
                mov     [eax], bl
                xor     eax, eax
                mov     [ebp+var_2C], ecx
                jmp     loc_4017C7
; ---------------------------------------------------------------------------

loc_401935:                             ; CODE XREF: sub_401750+A9\u2191j
                                        ; sub_401750+191\u2191j ...
                mov     edi, [ebp+var_2C]
                mov     edx, [ebp+var_2C]
                add     edi, eax
                test    eax, eax
                jz      loc_401A3F

loc_401945:                             ; CODE XREF: sub_401750+1FE\u2193j
                add     edx, 1
                cmp     edx, edi
                mov     byte ptr [edx-1], 5Ch ; '\'
                jnz     short loc_401945

loc_401950:                             ; CODE XREF: sub_401750+2F2\u2193j
                mov     eax, [ebp+var_30]
                test    eax, eax
                jnz     short loc_4019B0
                mov     [esp], ecx      ; C
                call    isspace
                test    eax, eax
                jz      short loc_4019B0
                mov     ecx, [ebp+var_34]
                test    ecx, ecx
                jnz     short loc_401973
                cmp     [ebp+Str], edi
                jnb     loc_401A2D

loc_401973:                             ; CODE XREF: sub_401750+218\u2191j
                lea     eax, [ebp+var_28]
                mov     byte ptr [edi], 0
                mov     [esp+0Ch], eax  ; int
                mov     dword ptr [esp+8], 0 ; int
                mov     eax, [ebp+var_38]
                mov     [esp+4], eax    ; int
                mov     edi, [ebp+Str]
                mov     [esp], edi      ; Str
                call    sub_402F20
                xor     eax, eax
                or      [ebp+var_38], 1
                mov     [ebp+var_2C], edi
                mov     [ebp+var_34], 0
                jmp     loc_4017C7
; ---------------------------------------------------------------------------
                align 10h

loc_4019B0:                             ; CODE XREF: sub_401750+205\u2191j
                                        ; sub_401750+211\u2191j
                lea     eax, [edi+1]
                mov     [ebp+var_2C], eax
                xor     eax, eax
                mov     [edi], bl
                jmp     loc_4017C7
; ---------------------------------------------------------------------------
                align 10h

loc_4019C0:                             ; CODE XREF: sub_401750+1C7\u2191j
                                        ; sub_401750+1D0\u2191j
                mov     byte ptr [eax], 7Fh
                add     eax, 1
                jmp     loc_401926
; ---------------------------------------------------------------------------
                align 10h

loc_4019D0:                             ; CODE XREF: sub_401750+97\u2191j
                test    byte ptr dword_40900C, 10h
                jz      loc_401935
                mov     ebx, eax
                sar     ebx, 1
                jz      short loc_401A56
                mov     edx, [ebp+var_2C]
                add     ebx, edx

loc_4019E8:                             ; CODE XREF: sub_401750+2A1\u2193j
                add     edx, 1
                cmp     edx, ebx
                mov     byte ptr [edx-1], 5Ch ; '\'
                jnz     short loc_4019E8

loc_4019F3:                             ; CODE XREF: sub_401750+309\u2193j
                test    al, 1
                jnz     short loc_401A01
                cmp     [ebp+var_30], 22h ; '"'
                jnz     loc_40182D

loc_401A01:                             ; CODE XREF: sub_401750+2A5\u2191j
                lea     eax, [ebx+1]
                mov     [ebp+var_2C], eax
                xor     eax, eax
                mov     byte ptr [ebx], 27h ; '''
                mov     [ebp+var_34], 1
                jmp     loc_4017C7
; ---------------------------------------------------------------------------

loc_401A18:                             ; CODE XREF: sub_401750+183\u2191j
                add     eax, 1
                jmp     loc_4017C7
; ---------------------------------------------------------------------------

loc_401A20:                             ; CODE XREF: sub_401750+10\u2191j
                call    sub_401260
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_401A2D:                             ; CODE XREF: sub_401750+21D\u2191j
                mov     [ebp+var_2C], edi
                xor     eax, eax
                jmp     loc_4017C7
; ---------------------------------------------------------------------------

loc_401A37:                             ; CODE XREF: sub_401750+1AD\u2191j
                mov     eax, [ebp+var_2C]
                jmp     loc_401913
; ---------------------------------------------------------------------------

loc_401A3F:                             ; CODE XREF: sub_401750+1EF\u2191j
                mov     edi, [ebp+var_2C]
                jmp     loc_401950
; ---------------------------------------------------------------------------

loc_401A47:                             ; CODE XREF: sub_401750+B3\u2191j
                mov     ebx, [ebp+var_2C]
                jmp     loc_40181B
; ---------------------------------------------------------------------------

loc_401A4F:                             ; CODE XREF: sub_401750+105\u2191j
                mov     eax, edx
                jmp     loc_40186B
; ---------------------------------------------------------------------------

loc_401A56:                             ; CODE XREF: sub_401750+291\u2191j
                mov     ebx, [ebp+var_2C]
                jmp     short loc_4019F3
sub_401750      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_401A60      proc near               ; CODE XREF: sub_401180+3B\u2191p
                pushf
                pushf
                pop     eax
                mov     edx, eax
                xor     eax, 200000h
                push    eax
                popf
                pushf
                pop     eax
                popf
                xor     eax, edx
                test    eax, 200000h
                jz      locret_401B21
                push    ebx
                xor     eax, eax
                cpuid
                test    eax, eax
                jz      loc_401B20
                mov     eax, 1
                cpuid
                test    dh, 1
                jz      short loc_401A9C
                or      ds:dword_40D024, 1

loc_401A9C:                             ; CODE XREF: sub_401A60+33\u2191j
                test    dh, 80h
                jz      short loc_401AA8
                or      ds:dword_40D024, 2

loc_401AA8:                             ; CODE XREF: sub_401A60+3F\u2191j
                test    edx, 800000h
                jz      short loc_401AB7
                or      ds:dword_40D024, 4

loc_401AB7:                             ; CODE XREF: sub_401A60+4E\u2191j
                test    edx, 1000000h
                jz      short loc_401AC6
                or      ds:dword_40D024, 8

loc_401AC6:                             ; CODE XREF: sub_401A60+5D\u2191j
                test    edx, 2000000h
                jz      short loc_401AD5
                or      ds:dword_40D024, 10h

loc_401AD5:                             ; CODE XREF: sub_401A60+6C\u2191j
                and     edx, 4000000h
                jz      short loc_401AE4
                or      ds:dword_40D024, 20h

loc_401AE4:                             ; CODE XREF: sub_401A60+7B\u2191j
                test    cl, 1
                jz      short loc_401AF0
                or      ds:dword_40D024, 40h

loc_401AF0:                             ; CODE XREF: sub_401A60+87\u2191j
                and     ch, 20h
                jnz     short loc_401B23

loc_401AF5:                             ; CODE XREF: sub_401A60+CD\u2193j
                mov     eax, 80000000h
                cpuid
                cmp     eax, 80000000h
                jbe     short loc_401B20
                mov     eax, 80000001h
                cpuid
                test    edx, edx
                js      short loc_401B30

loc_401B0E:                             ; CODE XREF: sub_401A60+DA\u2193j
                and     edx, 40000000h
                jz      short loc_401B20
                or      ds:dword_40D024, 200h

loc_401B20:                             ; CODE XREF: sub_401A60+23\u2191j
                                        ; sub_401A60+A1\u2191j ...
                pop     ebx

locret_401B21:                          ; CODE XREF: sub_401A60+16\u2191j
                rep retn
; ---------------------------------------------------------------------------

loc_401B23:                             ; CODE XREF: sub_401A60+93\u2191j
                or      ds:dword_40D024, 80h
                jmp     short loc_401AF5
; ---------------------------------------------------------------------------
                align 10h

loc_401B30:                             ; CODE XREF: sub_401A60+AC\u2191j
                or      ds:dword_40D024, 100h
                jmp     short loc_401B0E
sub_401A60      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_401B40      proc near               ; CODE XREF: TopLevelExceptionFilter+165\u2191p
                                        ; sub_401180+40\u2191p
                fninit
                retn
sub_401B40      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_401B50      proc near               ; DATA XREF: sub_401BD0:loc_401BA2\u2193o
                mov     eax, off_409014
                mov     eax, [eax]
                test    eax, eax
                jz      short locret_401B7A
                sub     esp, 0Ch
                xchg    ax, ax

loc_401B60:                             ; CODE XREF: sub_401B50+25\u2193j
                call    eax
                mov     eax, off_409014
                lea     edx, [eax+4]
                mov     eax, [eax+4]
                mov     off_409014, edx
                test    eax, eax
                jnz     short loc_401B60
                add     esp, 0Ch

locret_401B7A:                          ; CODE XREF: sub_401B50+9\u2191j
                rep retn
sub_401B50      endp

; ---------------------------------------------------------------------------
                align 10h
; START OF FUNCTION CHUNK FOR sub_401BD0

loc_401B80:                             ; CODE XREF: sub_401BD0+1A\u2193j
                push    ebx
                sub     esp, 18h
                mov     ebx, ds:dword_4086E0
                cmp     ebx, 0FFFFFFFFh
                jz      short loc_401BB3

loc_401B8F:                             ; CODE XREF: sub_401BD0-9\u2193j
                test    ebx, ebx
                jz      short loc_401BA2

loc_401B93:                             ; CODE XREF: sub_401BD0-30\u2193j
                call    ds:dword_4086E0[ebx*4]
                sub     ebx, 1
                lea     esi, [esi+0]
                jnz     short loc_401B93

loc_401BA2:                             ; CODE XREF: sub_401BD0-3F\u2191j
                mov     [esp+1Ch+var_1C], offset sub_401B50
                call    sub_4012E0
                add     esp, 18h
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_401BB3:                             ; CODE XREF: sub_401BD0-43\u2191j
                xor     ebx, ebx
                jmp     short loc_401BB9
; ---------------------------------------------------------------------------

loc_401BB7:                             ; CODE XREF: sub_401BD0-B\u2193j
                mov     ebx, eax

loc_401BB9:                             ; CODE XREF: sub_401BD0-1B\u2191j
                lea     eax, [ebx+1]
                mov     edx, ds:dword_4086E0[eax*4]
                test    edx, edx
                jnz     short loc_401BB7
                jmp     short loc_401B8F
; END OF FUNCTION CHUNK FOR sub_401BD0
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_401BD0      proc near               ; CODE XREF: sub_401180+AA\u2191p
                                        ; _main+E\u2191p

var_1C          = dword ptr -1Ch

; FUNCTION CHUNK AT 00401B80 SIZE 00000049 BYTES

                mov     ecx, ds:dword_40D028
                test    ecx, ecx
                jz      short loc_401BE0
                rep retn
; ---------------------------------------------------------------------------
                align 10h

loc_401BE0:                             ; CODE XREF: sub_401BD0+8\u2191j
                mov     ds:dword_40D028, 1
                jmp     short loc_401B80
sub_401BD0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


                public TlsCallback_1
TlsCallback_1   proc near               ; DATA XREF: .CRT:00410008\u2193o

var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 1Ch
                mov     eax, [esp+1Ch+arg_4]
                test    eax, eax
                jz      short loc_401C10
                cmp     eax, 3
                jz      short loc_401C10
                mov     eax, 1
                add     esp, 1Ch
                retn    0Ch
; ---------------------------------------------------------------------------
                align 10h

loc_401C10:                             ; CODE XREF: TlsCallback_1+9\u2191j
                                        ; TlsCallback_1+E\u2191j
                mov     edx, [esp+1Ch+arg_8]
                mov     [esp+1Ch+var_18], eax
                mov     eax, [esp+1Ch+arg_0]
                mov     [esp+1Ch+var_14], edx
                mov     [esp+1Ch+var_1C], eax
                call    sub_401E80
                mov     eax, 1
                add     esp, 1Ch
                retn    0Ch
TlsCallback_1   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


                public TlsCallback_0
TlsCallback_0   proc near               ; CODE XREF: sub_401180+27\u2191p
                                        ; DATA XREF: .rdata:off_40A1C4\u2193o ...

var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                push    esi
                push    ebx
                sub     esp, 14h
                cmp     ds:dword_40D064, 2
                mov     eax, [esp+1Ch+arg_4]
                jz      short loc_401C5C
                mov     ds:dword_40D064, 2

loc_401C5C:                             ; CODE XREF: TlsCallback_0+10\u2191j
                cmp     eax, 2
                jz      short loc_401C73
                cmp     eax, 1
                jz      short loc_401CA8

loc_401C66:                             ; CODE XREF: TlsCallback_0+43\u2193j
                                        ; TlsCallback_0+84\u2193j
                add     esp, 14h
                mov     eax, 1
                pop     ebx
                pop     esi
                retn    0Ch
; ---------------------------------------------------------------------------

loc_401C73:                             ; CODE XREF: TlsCallback_0+1F\u2191j
                mov     esi, offset dword_410014
                sub     esi, offset dword_410014
                sar     esi, 2
                test    esi, esi
                jle     short loc_401C66
                xor     ebx, ebx

loc_401C87:                             ; CODE XREF: TlsCallback_0+59\u2193j
                mov     eax, ds:dword_410014[ebx*4]
                test    eax, eax
                jz      short loc_401C94
                call    eax ; dword_410014

loc_401C94:                             ; CODE XREF: TlsCallback_0+50\u2191j
                add     ebx, 1
                cmp     ebx, esi
                jnz     short loc_401C87
                add     esp, 14h
                mov     eax, 1
                pop     ebx
                pop     esi
                retn    0Ch
; ---------------------------------------------------------------------------

loc_401CA8:                             ; CODE XREF: TlsCallback_0+24\u2191j
                mov     eax, [esp+1Ch+arg_8]
                mov     [esp+1Ch+var_18], 1
                mov     [esp+1Ch+var_14], eax
                mov     eax, [esp+1Ch+arg_0]
                mov     [esp+1Ch+var_1C], eax
                call    sub_401E80
                jmp     short loc_401C66
TlsCallback_0   endp

; ---------------------------------------------------------------------------
                align 10h
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_401CE0      proc near               ; CODE XREF: sub_401E80:loc_401F01\u2193p
                                        ; sub_401E80+90\u2193p
                push    ebp
                mov     ebp, esp
                push    esi
                push    ebx
                sub     esp, 10h
                mov     dword ptr [esp], offset CriticalSection ; lpCriticalSection
                call    EnterCriticalSection
                mov     ebx, ds:dword_40D03C
                sub     esp, 4
                test    ebx, ebx
                jz      short loc_401D2C

loc_401D01:                             ; CODE XREF: sub_401CE0+4A\u2193j
                mov     eax, [ebx]
                mov     [esp], eax      ; dwTlsIndex
                call    TlsGetValue
                sub     esp, 4
                mov     esi, eax
                call    GetLastError
                test    eax, eax
                jnz     short loc_401D25
                test    esi, esi
                jz      short loc_401D25
                mov     eax, [ebx+4]
                mov     [esp], esi
                call    eax

loc_401D25:                             ; CODE XREF: sub_401CE0+37\u2191j
                                        ; sub_401CE0+3B\u2191j
                mov     ebx, [ebx+8]
                test    ebx, ebx
                jnz     short loc_401D01

loc_401D2C:                             ; CODE XREF: sub_401CE0+1F\u2191j
                mov     dword ptr [esp], offset CriticalSection ; lpCriticalSection
                call    LeaveCriticalSection
                sub     esp, 4
                lea     esp, [ebp-8]
                pop     ebx
                pop     esi
                pop     ebp
                retn
sub_401CE0      endp

; ---------------------------------------------------------------------------
                align 10h
                push    ebp
                mov     ebp, esp
                push    esi
                xor     esi, esi
                push    ebx
                sub     esp, 10h
                mov     eax, ds:dword_40D040
                test    eax, eax
                jnz     short loc_401D70

loc_401D63:                             ; CODE XREF: .text:00401DCF\u2193j
                lea     esp, [ebp-8]
                mov     eax, esi
                pop     ebx
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_401D70:                             ; CODE XREF: .text:00401D61\u2191j
                mov     dword ptr [esp+4], 0Ch
                mov     dword ptr [esp], 1
                call    calloc
                test    eax, eax
                mov     ebx, eax
                jz      short loc_401DCA
                mov     eax, [ebp+8]
                mov     dword ptr [esp], offset CriticalSection
                mov     [ebx], eax
                mov     eax, [ebp+0Ch]
                mov     [ebx+4], eax
                call    EnterCriticalSection
                mov     eax, ds:dword_40D03C
                mov     ds:dword_40D03C, ebx
                mov     [ebx+8], eax
                sub     esp, 4
                mov     dword ptr [esp], offset CriticalSection
                call    LeaveCriticalSection
                mov     eax, esi
                sub     esp, 4
                lea     esp, [ebp-8]
                pop     ebx
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_401DCA:                             ; CODE XREF: .text:00401D88\u2191j
                mov     esi, 0FFFFFFFFh
                jmp     short loc_401D63
; ---------------------------------------------------------------------------
                jmp     short loc_401DE0
; ---------------------------------------------------------------------------
                align 10h

loc_401DE0:                             ; CODE XREF: .text:00401DD1\u2191j
                push    ebp
                mov     ebp, esp
                push    ebx
                sub     esp, 14h
                mov     eax, ds:dword_40D040
                mov     ebx, [ebp+8]
                test    eax, eax
                jnz     short loc_401E00
                xor     eax, eax
                mov     ebx, [ebp-4]
                leave
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_401E00:                             ; CODE XREF: .text:00401DF1\u2191j
                mov     dword ptr [esp], offset CriticalSection
                call    EnterCriticalSection
                mov     edx, ds:dword_40D03C
                sub     esp, 4
                test    edx, edx
                jz      short loc_401E30
                mov     eax, [edx]
                cmp     eax, ebx
                jnz     short loc_401E29
                jmp     short loc_401E65
; ---------------------------------------------------------------------------

loc_401E21:                             ; CODE XREF: .text:00401E2E\u2193j
                mov     ecx, [eax]
                cmp     ecx, ebx
                jz      short loc_401E46
                mov     edx, eax

loc_401E29:                             ; CODE XREF: .text:00401E1D\u2191j
                mov     eax, [edx+8]
                test    eax, eax
                jnz     short loc_401E21

loc_401E30:                             ; CODE XREF: .text:00401E17\u2191j
                mov     dword ptr [esp], offset CriticalSection
                call    LeaveCriticalSection
                sub     esp, 4

loc_401E3F:                             ; CODE XREF: .text:00401E63\u2193j
                xor     eax, eax
                mov     ebx, [ebp-4]
                leave
                retn
; ---------------------------------------------------------------------------

loc_401E46:                             ; CODE XREF: .text:00401E25\u2191j
                mov     ecx, [eax+8]
                mov     [edx+8], ecx

loc_401E4C:                             ; CODE XREF: .text:00401E6F\u2193j
                mov     [esp], eax
                call    free
                mov     dword ptr [esp], offset CriticalSection
                call    LeaveCriticalSection
                sub     esp, 4
                jmp     short loc_401E3F
; ---------------------------------------------------------------------------

loc_401E65:                             ; CODE XREF: .text:00401E1F\u2191j
                mov     eax, [edx+8]
                mov     ds:dword_40D03C, eax
                mov     eax, edx
                jmp     short loc_401E4C
; ---------------------------------------------------------------------------
                jmp     short sub_401E80
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_401E80      proc near               ; CODE XREF: TlsCallback_1+33\u2191p
                                        ; TlsCallback_0+7F\u2191p ...

arg_4           = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                sub     esp, 18h
                mov     eax, [ebp+arg_4]
                cmp     eax, 1
                jz      short loc_401ED3
                jb      short loc_401EA5
                cmp     eax, 3
                jnz     short loc_401E9E
                mov     eax, ds:dword_40D040
                test    eax, eax
                jnz     short loc_401F01

loc_401E9E:                             ; CODE XREF: sub_401E80+13\u2191j
                                        ; sub_401E80+36\u2193j ...
                mov     eax, 1
                leave
                retn
; ---------------------------------------------------------------------------

loc_401EA5:                             ; CODE XREF: sub_401E80+E\u2191j
                mov     eax, ds:dword_40D040
                test    eax, eax
                jnz     short loc_401F08

loc_401EAE:                             ; CODE XREF: sub_401E80+95\u2193j
                mov     eax, ds:dword_40D040
                cmp     eax, 1
                jnz     short loc_401E9E
                mov     dword ptr [esp], offset CriticalSection ; lpCriticalSection
                mov     ds:dword_40D040, 0
                call    DeleteCriticalSection
                sub     esp, 4
                jmp     short loc_401E9E
; ---------------------------------------------------------------------------

loc_401ED3:                             ; CODE XREF: sub_401E80+C\u2191j
                mov     eax, ds:dword_40D040
                test    eax, eax
                jz      short loc_401EF0

loc_401EDC:                             ; CODE XREF: sub_401E80+7F\u2193j
                mov     ds:dword_40D040, 1
                mov     eax, 1
                leave
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_401EF0:                             ; CODE XREF: sub_401E80+5A\u2191j
                mov     dword ptr [esp], offset CriticalSection ; lpCriticalSection
                call    InitializeCriticalSection
                sub     esp, 4
                jmp     short loc_401EDC
; ---------------------------------------------------------------------------

loc_401F01:                             ; CODE XREF: sub_401E80+1C\u2191j
                call    sub_401CE0
                jmp     short loc_401E9E
; ---------------------------------------------------------------------------

loc_401F08:                             ; CODE XREF: sub_401E80+2C\u2191j
                nop
                lea     esi, [esi+0]
                call    sub_401CE0
                jmp     short loc_401EAE
sub_401E80      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: noreturn

; void __cdecl __noreturn sub_401F20(char *Format, char ArgList)
sub_401F20      proc near               ; CODE XREF: sub_401F70+DE\u2193p
                                        ; sub_402060+CA\u2193p ...

Buffer          = dword ptr -1Ch
ElementSize     = dword ptr -18h
ElementCount    = dword ptr -14h
Stream          = dword ptr -10h
Format          = dword ptr  4
ArgList         = byte ptr  8

                push    esi
                push    ebx
                sub     esp, 14h
                mov     eax, ds:_iob
                mov     [esp+1Ch+ElementCount], 17h ; ElementCount
                lea     esi, [esp+1Ch+ArgList]
                mov     [esp+1Ch+ElementSize], 1 ; ElementSize
                mov     [esp+1Ch+Buffer], offset aMingwRuntimeFa ; "Mingw runtime failure:\n"
                lea     ebx, [eax+40h]
                mov     [esp+1Ch+Stream], ebx ; Stream
                call    fwrite
                mov     eax, [esp+1Ch+Format]
                mov     [esp+1Ch+ElementCount], esi ; ArgList
                mov     [esp+1Ch+Buffer], ebx ; Stream
                mov     [esp+1Ch+ElementSize], eax ; Format
                call    vfprintf
                call    abort
sub_401F20      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

; int __fastcall sub_401F70(size_t Size, void *Src)
sub_401F70      proc near               ; CODE XREF: sub_402060+102\u2193p
                                        ; sub_402060+15C\u2193p ...

var_40          = dword ptr -40h
lpflOldProtect  = dword ptr -3Ch
flOldProtect    = dword ptr -38h
Buffer          = _MEMORY_BASIC_INFORMATION ptr -34h

                push    ebp
                mov     ebp, esp
                push    edi
                mov     edi, ecx
                push    esi
                mov     esi, edx
                push    ebx
                mov     ebx, eax
                sub     esp, 4Ch
                lea     eax, [ebp+Buffer]
                mov     dword ptr [esp+8], 1Ch ; dwLength
                mov     [esp+4], eax    ; lpBuffer
                mov     [esp], ebx      ; lpAddress
                call    VirtualQuery
                sub     esp, 0Ch
                test    eax, eax
                jz      loc_40203B
                mov     eax, [ebp+Buffer.Protect]
                cmp     eax, 4
                jnz     short loc_401FC1

loc_401FA9:                             ; CODE XREF: sub_401F70+54\u2193j
                mov     [esp+8], edi    ; Size
                mov     [esp+4], esi    ; Src
                mov     [esp], ebx      ; void *
                call    memcpy

loc_401FB9:                             ; CODE XREF: sub_401F70+99\u2193j
                                        ; sub_401F70+9E\u2193j
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_401FC1:                             ; CODE XREF: sub_401F70+37\u2191j
                cmp     eax, 40h ; '@'
                jz      short loc_401FA9
                mov     eax, [ebp+Buffer.RegionSize]
                lea     edx, [ebp+flOldProtect]
                mov     [esp+0Ch], edx  ; lpflOldProtect
                mov     dword ptr [esp+8], 40h ; '@' ; flNewProtect
                mov     [ebp+lpflOldProtect], edx
                mov     [esp+4], eax    ; dwSize
                mov     eax, [ebp+Buffer.BaseAddress]
                mov     [esp], eax      ; lpAddress
                call    VirtualProtect
                mov     ecx, [ebp+Buffer.Protect]
                mov     [ebp+var_40], ecx
                sub     esp, 10h
                mov     [esp+8], edi    ; Size
                mov     [esp+4], esi    ; Src
                mov     [esp], ebx      ; void *
                call    memcpy
                mov     ecx, [ebp+var_40]
                cmp     ecx, 4
                jz      short loc_401FB9
                cmp     ecx, 40h ; '@'
                jz      short loc_401FB9
                mov     eax, [ebp+flOldProtect]
                mov     edx, [ebp+lpflOldProtect]
                mov     [esp+8], eax    ; flNewProtect
                mov     eax, [ebp+Buffer.RegionSize]
                mov     [esp+0Ch], edx  ; lpflOldProtect
                mov     [esp+4], eax    ; dwSize
                mov     eax, [ebp+Buffer.BaseAddress]
                mov     [esp], eax      ; lpAddress
                call    VirtualProtect
                sub     esp, 10h
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_40203B:                             ; CODE XREF: sub_401F70+2B\u2191j
                mov     [esp+8], ebx
                mov     dword ptr [esp+4], 1Ch ; ArgList
                mov     dword ptr [esp], offset aVirtualqueryFa ; "  VirtualQuery failed for %d bytes at a"...
                call    sub_401F20
sub_401F70      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_402060      proc near               ; CODE XREF: sub_401180+A2\u2191p

Format          = dword ptr -2Ch
ArgList         = byte ptr -28h
Src             = dword ptr -10h

                mov     eax, ds:dword_40D05C
                test    eax, eax
                jz      short loc_402070

locret_402069:                          ; CODE XREF: sub_402060+27\u2193j
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_402070:                             ; CODE XREF: sub_402060+7\u2191j
                mov     eax, offset dword_40A880
                sub     eax, offset dword_40A880
                cmp     eax, 7
                mov     ds:dword_40D05C, 1
                jle     short locret_402069
                push    edi
                push    esi
                push    ebx
                sub     esp, 20h
                cmp     eax, 0Bh
                jle     loc_402176
                mov     esi, ds:dword_40A880
                test    esi, esi
                jnz     loc_402130
                mov     ebx, ds:dword_40A884
                test    ebx, ebx
                jnz     loc_402130
                mov     ecx, ds:dword_40A888
                mov     ebx, offset dword_40A88C
                test    ecx, ecx
                jz      loc_40217B
                mov     ebx, offset dword_40A880

loc_4020CC:                             ; CODE XREF: sub_402060+126\u2193j
                mov     eax, [ebx+8]
                cmp     eax, 1
                jnz     loc_402221

loc_4020D8:                             ; CODE XREF: sub_402060+161\u2193j
                                        ; sub_402060+194\u2193j ...
                add     ebx, 0Ch
                cmp     ebx, offset dword_40A880
                jnb     loc_40216F
                movzx   edx, byte ptr [ebx+8]
                mov     esi, [ebx+4]
                mov     ecx, [ebx]
                cmp     edx, 10h
                lea     eax, [esi+400000h]
                mov     edi, [ecx+400000h]
                jz      loc_402190
                cmp     edx, 20h ; ' '
                jz      loc_402200
                cmp     edx, 8
                jz      loc_4021C6
                mov     dword ptr [esp+2Ch+ArgList], edx ; ArgList
                mov     [esp+2Ch+Format], offset aUnknownPseudoR ; "  Unknown pseudo relocation bit size %d"...
                mov     [esp+2Ch+Src], 0
                call    sub_401F20
; ---------------------------------------------------------------------------
                align 10h

loc_402130:                             ; CODE XREF: sub_402060+40\u2191j
                                        ; sub_402060+4E\u2191j
                mov     ebx, offset dword_40A880

loc_402135:                             ; CODE XREF: sub_402060+11F\u2193j
                                        ; sub_402060+12C\u2193j
                cmp     ebx, offset dword_40A880
                jnb     short loc_40216F
                lea     esi, [esi+0]

loc_402140:                             ; CODE XREF: sub_402060+10D\u2193j
                mov     edx, [ebx+4]
                mov     ecx, 4          ; Size
                add     ebx, 8
                lea     eax, [edx+400000h]
                mov     edx, [edx+400000h]
                add     edx, [ebx-8]
                mov     [esp+2Ch+Src], edx
                lea     edx, [esp+2Ch+Src] ; Src
                call    sub_401F70
                cmp     ebx, offset dword_40A880
                jb      short loc_402140

loc_40216F:                             ; CODE XREF: sub_402060+81\u2191j
                                        ; sub_402060+DB\u2191j
                add     esp, 20h
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_402176:                             ; CODE XREF: sub_402060+32\u2191j
                mov     ebx, offset dword_40A880

loc_40217B:                             ; CODE XREF: sub_402060+61\u2191j
                mov     edx, [ebx]
                test    edx, edx
                jnz     short loc_402135
                mov     eax, [ebx+4]
                test    eax, eax
                jz      loc_4020CC
                jmp     short loc_402135
; ---------------------------------------------------------------------------
                align 10h

loc_402190:                             ; CODE XREF: sub_402060+9F\u2191j
                movzx   esi, word ptr [esi+400000h]
                test    si, si
                movzx   edx, si
                jns     short loc_4021A5
                or      edx, 0FFFF0000h

loc_4021A5:                             ; CODE XREF: sub_402060+13D\u2191j
                sub     edx, ecx
                mov     ecx, 2          ; Size
                sub     edx, 400000h
                add     edx, edi
                mov     [esp+2Ch+Src], edx
                lea     edx, [esp+2Ch+Src] ; Src
                call    sub_401F70
                jmp     loc_4020D8
; ---------------------------------------------------------------------------

loc_4021C6:                             ; CODE XREF: sub_402060+B1\u2191j
                movzx   edx, byte ptr [eax]
                test    dl, dl
                movzx   esi, dl
                jns     short loc_4021D6
                or      esi, 0FFFFFF00h

loc_4021D6:                             ; CODE XREF: sub_402060+16E\u2191j
                sub     esi, 400000h
                mov     edx, esi
                sub     edx, ecx
                mov     ecx, 1          ; Size
                add     edx, edi
                mov     [esp+2Ch+Src], edx
                lea     edx, [esp+2Ch+Src] ; Src
                call    sub_401F70
                jmp     loc_4020D8
; ---------------------------------------------------------------------------
                align 10h

loc_402200:                             ; CODE XREF: sub_402060+A8\u2191j
                add     ecx, 400000h
                sub     edi, ecx
                mov     ecx, 4          ; Size
                add     edi, [eax]
                lea     edx, [esp+2Ch+Src] ; Src
                mov     [esp+2Ch+Src], edi
                call    sub_401F70
                jmp     loc_4020D8
; ---------------------------------------------------------------------------

loc_402221:                             ; CODE XREF: sub_402060+72\u2191j
                mov     dword ptr [esp+2Ch+ArgList], eax ; ArgList
                mov     [esp+2Ch+Format], offset aUnknownPseudoR_0 ; "  Unknown pseudo relocation protocol ve"...
                call    sub_401F20
sub_402060      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_402240      proc near               ; CODE XREF: sub_401750+2F\u2191p
                                        ; sub_402970+22\u2193p ...

arg_0           = byte ptr  4

                push    ecx
                push    eax
                cmp     eax, 1000h
                lea     ecx, [esp+8+arg_0]
                jb      short loc_402262

loc_40224D:                             ; CODE XREF: sub_402240+20\u2193j
                sub     ecx, 1000h
                or      dword ptr [ecx], 0
                sub     eax, 1000h
                cmp     eax, 1000h
                ja      short loc_40224D

loc_402262:                             ; CODE XREF: sub_402240+B\u2191j
                sub     ecx, eax
                or      dword ptr [ecx], 0
                pop     eax
                pop     ecx
                retn
sub_402240      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_402270      proc near               ; CODE XREF: vuln_func+46\u2191p
                                        ; sub_403420+68\u2193p ...

var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
var_10          = dword ptr -10h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = byte ptr  10h

                sub     esp, 1Ch
                lea     eax, [esp+1Ch+arg_C]
                mov     [esp+1Ch+var_10], eax
                mov     eax, [esp+1Ch+arg_8]
                mov     [esp+1Ch+var_14], eax
                mov     eax, [esp+1Ch+arg_4]
                mov     [esp+1Ch+var_18], eax
                mov     eax, [esp+1Ch+arg_0]
                mov     [esp+1Ch+var_1C], eax
                call    sub_4022A0
                add     esp, 1Ch
                retn
sub_402270      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_4022A0      proc near               ; CODE XREF: sub_402270+22\u2191p

var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    esi
                push    ebx
                sub     esp, 24h
                mov     eax, [esp+2Ch+arg_4]
                mov     ebx, [esp+2Ch+arg_0]
                mov     edx, [esp+2Ch+arg_8]
                mov     ecx, [esp+2Ch+arg_C]
                test    eax, eax
                jz      short loc_4022F0
                lea     esi, [eax-1]
                mov     [esp+2Ch+var_20], edx
                mov     [esp+2Ch+var_1C], ecx
                mov     [esp+2Ch+var_24], esi
                mov     [esp+2Ch+var_28], ebx
                mov     [esp+2Ch+var_2C], 0
                call    sub_404E70
                cmp     eax, esi
                mov     edx, eax
                ja      short loc_4022E8

loc_4022DE:                             ; CODE XREF: sub_4022A0+4A\u2193j
                mov     byte ptr [ebx+edx], 0
                add     esp, 24h
                pop     ebx
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_4022E8:                             ; CODE XREF: sub_4022A0+3C\u2191j
                mov     edx, esi
                jmp     short loc_4022DE
; ---------------------------------------------------------------------------
                align 10h

loc_4022F0:                             ; CODE XREF: sub_4022A0+17\u2191j
                mov     [esp+2Ch+var_28], ebx
                mov     [esp+2Ch+var_1C], ecx
                mov     [esp+2Ch+var_20], edx
                mov     [esp+2Ch+var_24], 0
                mov     [esp+2Ch+var_2C], 0
                call    sub_404E70
                add     esp, 24h
                pop     ebx
                pop     esi
                retn
sub_4022A0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_402320      proc near               ; CODE XREF: sub_402970+69\u2193p
                                        ; sub_402970+50A\u2193p
                push    edi
                test    eax, eax
                push    esi
                push    ebx
                mov     ebx, eax
                jz      short loc_40236D
                movsx   ecx, byte ptr [ebx]
                mov     esi, edx
                xor     eax, eax
                and     esi, 20h
                lea     edx, [ebx+1]
                test    ecx, ecx
                jz      short loc_40236D
                lea     esi, [esi+0]

loc_402340:                             ; CODE XREF: sub_402320+4B\u2193j
                test    esi, esi
                mov     edi, esi
                jnz     short loc_40234B
                cmp     ecx, 7Fh
                jz      short loc_402390

loc_40234B:                             ; CODE XREF: sub_402320+24\u2191j
                                        ; sub_402320+77\u2193j
                test    eax, eax
                jnz     short loc_402375
                cmp     ecx, 3Fh ; '?'
                jz      short loc_4023A5
                cmp     ecx, 2Ah ; '*'
                jz      short loc_4023A5
                xor     eax, eax
                cmp     ecx, 5Bh ; '['
                setz    al
                mov     ebx, edx

loc_402363:                             ; CODE XREF: sub_402320+67\u2193j
                movsx   ecx, byte ptr [ebx]
                lea     edx, [ebx+1]
                test    ecx, ecx
                jnz     short loc_402340

loc_40236D:                             ; CODE XREF: sub_402320+7\u2191j
                                        ; sub_402320+18\u2191j
                xor     edi, edi

loc_40236F:                             ; CODE XREF: sub_402320+79\u2193j
                mov     eax, edi
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_402375:                             ; CODE XREF: sub_402320+2D\u2191j
                cmp     ecx, 5Dh ; ']'
                jz      short loc_4023A0

loc_40237A:                             ; CODE XREF: sub_402320+83\u2193j
                cmp     ecx, 21h ; '!'
                mov     ebx, edx
                setnz   cl
                movzx   ecx, cl
                add     eax, ecx
                jmp     short loc_402363
; ---------------------------------------------------------------------------
                align 10h

loc_402390:                             ; CODE XREF: sub_402320+29\u2191j
                cmp     byte ptr [ebx+1], 0
                lea     edx, [ebx+2]
                jnz     short loc_40234B
                jmp     short loc_40236F
; ---------------------------------------------------------------------------
                align 10h

loc_4023A0:                             ; CODE XREF: sub_402320+58\u2191j
                cmp     eax, 1
                jle     short loc_40237A

loc_4023A5:                             ; CODE XREF: sub_402320+32\u2191j
                                        ; sub_402320+37\u2191j
                mov     edi, 1
                mov     eax, edi
                pop     ebx
                pop     esi
                pop     edi
                retn
sub_402320      endp


; =============== S U B R O U T I N E =======================================


sub_4023B0      proc near               ; CODE XREF: sub_402620+118\u2193p
                                        ; sub_402620+199\u2193p

var_14          = dword ptr -14h

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 4
                movzx   ebx, byte ptr [eax]
                mov     [esp+14h+var_14], ecx
                movsx   edi, bl
                cmp     edi, 5Dh ; ']'
                jz      loc_4024A0
                cmp     edi, 2Dh ; '-'
                mov     ecx, ebx
                jnz     short loc_4023FE
                jmp     loc_4024A0
; ---------------------------------------------------------------------------

loc_4023D5:                             ; CODE XREF: sub_4023B0+60\u2193j
                test    ebx, ebx
                jz      loc_402490

loc_4023DD:                             ; CODE XREF: sub_4023B0+A4\u2193j
                                        ; sub_4023B0+B2\u2193j
                cmp     ebx, 5Ch ; '\'
                jz      loc_402490
                cmp     ebx, 2Fh ; '/'
                jz      loc_402490
                mov     edi, ebx
                movzx   ecx, byte ptr [esi]
                mov     eax, esi
                cmp     edi, edx
                jz      loc_4024C8

loc_4023FE:                             ; CODE XREF: sub_4023B0+1E\u2191j
                                        ; sub_4023B0+FF\u2193j ...
                movsx   ebx, cl
                cmp     ebx, 5Dh ; ']'
                lea     esi, [eax+1]
                jz      loc_402490
                cmp     ebx, 2Dh ; '-'
                jnz     short loc_4023D5
                movzx   ebx, byte ptr [eax+1]
                cmp     bl, 5Dh ; ']'
                jz      loc_4024B4
                movsx   ebp, bl
                test    ebp, ebp
                mov     ebx, ebp
                jz      short loc_402490
                cmp     edi, ebp
                lea     esi, [eax+2]
                jge     loc_4025B8
                cmp     edi, edx
                lea     eax, [edi+1]
                jnz     short loc_40244E
                jmp     loc_402500
; ---------------------------------------------------------------------------
                align 10h

loc_402440:                             ; CODE XREF: sub_4023B0+A0\u2193j
                add     eax, 1
                lea     edi, [eax-1]
                cmp     edx, edi
                jz      loc_402500

loc_40244E:                             ; CODE XREF: sub_4023B0+88\u2191j
                cmp     ebp, eax
                jg      short loc_402440

loc_402452:                             ; CODE XREF: sub_4023B0+20A\u2193j
                cmp     ebp, eax
                jge     short loc_4023DD
                cmp     edx, eax
                jz      short loc_40246F
                add     ebp, 1
                lea     esi, [esi+0]

loc_402460:                             ; CODE XREF: sub_4023B0+BD\u2193j
                cmp     eax, ebp
                jz      loc_4023DD
                sub     eax, 1
                cmp     edx, eax
                jnz     short loc_402460

loc_40246F:                             ; CODE XREF: sub_4023B0+A8\u2191j
                mov     ecx, [esp+14h+var_14]
                and     ecx, 20h

loc_402475:                             ; CODE XREF: sub_4023B0+DD\u2193j
                                        ; sub_4023B0+1A8\u2193j
                movzx   eax, byte ptr [esi]
                cmp     al, 5Dh ; ']'
                jz      loc_402523
                cmp     al, 7Fh
                jz      loc_402545

loc_402488:                             ; CODE XREF: sub_4023B0+1A0\u2193j
                add     esi, 1
                test    al, al
                jnz     short loc_402475
                nop

loc_402490:                             ; CODE XREF: sub_4023B0+27\u2191j
                                        ; sub_4023B0+30\u2191j ...
                add     esp, 4
                xor     eax, eax
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4024A0:                             ; CODE XREF: sub_4023B0+13\u2191j
                                        ; sub_4023B0+20\u2191j
                cmp     edi, edx
                jz      loc_402560
                movzx   ecx, byte ptr [eax+1]
                add     eax, 1
                jmp     loc_4023FE
; ---------------------------------------------------------------------------

loc_4024B4:                             ; CODE XREF: sub_4023B0+69\u2191j
                mov     edi, 2Dh ; '-'
                mov     eax, esi
                cmp     edi, edx
                mov     ecx, 5Dh ; ']'
                jnz     loc_4023FE

loc_4024C8:                             ; CODE XREF: sub_4023B0+48\u2191j
                mov     edx, [esp+14h+var_14]
                and     edx, 20h
                jmp     short loc_4024DA
; ---------------------------------------------------------------------------

loc_4024D0:                             ; CODE XREF: sub_4023B0+136\u2193j
                                        ; sub_4023B0+147\u2193j
                add     eax, 1
                test    cl, cl
                jz      short loc_402490

loc_4024D7:                             ; CODE XREF: sub_4023B0+203\u2193j
                movzx   ecx, byte ptr [eax]

loc_4024DA:                             ; CODE XREF: sub_4023B0+11E\u2191j
                cmp     cl, 5Dh ; ']'
                jz      loc_4025A5
                cmp     cl, 7Fh
                jnz     short loc_4024D0
                test    edx, edx
                jnz     loc_4025B0
                movzx   ecx, byte ptr [eax+1]
                add     eax, 1
                jmp     short loc_4024D0
; ---------------------------------------------------------------------------
                align 10h

loc_402500:                             ; CODE XREF: sub_4023B0+8A\u2191j
                                        ; sub_4023B0+98\u2191j
                mov     ecx, [esp+14h+var_14]
                and     ecx, 20h

loc_402506:                             ; CODE XREF: sub_4023B0+193\u2193j
                movzx   eax, byte ptr [esi]
                cmp     al, 5Dh ; ']'
                jz      short loc_402523

loc_40250D:                             ; CODE XREF: sub_4023B0+171\u2193j
                cmp     al, 7Fh
                jz      short loc_402530

loc_402511:                             ; CODE XREF: sub_4023B0+18B\u2193j
                add     esi, 1
                test    al, al
                jz      loc_402490
                movzx   eax, byte ptr [esi]
                cmp     al, 5Dh ; ']'
                jnz     short loc_40250D

loc_402523:                             ; CODE XREF: sub_4023B0+CA\u2191j
                                        ; sub_4023B0+15B\u2191j
                add     esp, 4
                pop     ebx
                lea     eax, [esi+1]
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_402530:                             ; CODE XREF: sub_4023B0+15F\u2191j
                test    ecx, ecx
                jnz     short loc_402540
                movzx   eax, byte ptr [esi+1]
                add     esi, 1
                jmp     short loc_402511
; ---------------------------------------------------------------------------
                align 10h

loc_402540:                             ; CODE XREF: sub_4023B0+182\u2191j
                add     esi, 1
                jmp     short loc_402506
; ---------------------------------------------------------------------------

loc_402545:                             ; CODE XREF: sub_4023B0+D2\u2191j
                test    ecx, ecx
                jnz     short loc_402555
                movzx   eax, byte ptr [esi+1]
                add     esi, 1
                jmp     loc_402488
; ---------------------------------------------------------------------------

loc_402555:                             ; CODE XREF: sub_4023B0+197\u2191j
                add     esi, 1
                jmp     loc_402475
; ---------------------------------------------------------------------------
                align 10h

loc_402560:                             ; CODE XREF: sub_4023B0+F2\u2191j
                mov     ecx, [esp+14h+var_14]
                add     eax, 1
                and     ecx, 20h
                lea     esi, [esi+0]

loc_402570:                             ; CODE XREF: sub_4023B0+1D2\u2193j
                                        ; sub_4023B0+1F3\u2193j
                movzx   edx, byte ptr [eax]
                cmp     dl, 5Dh ; ']'
                jz      short loc_4025A5
                cmp     dl, 7Fh
                jz      short loc_402590

loc_40257D:                             ; CODE XREF: sub_4023B0+1EB\u2193j
                add     eax, 1
                test    dl, dl
                jnz     short loc_402570
                jmp     loc_402490
; ---------------------------------------------------------------------------
                align 10h

loc_402590:                             ; CODE XREF: sub_4023B0+1CB\u2191j
                test    ecx, ecx
                jnz     short loc_4025A0
                movzx   edx, byte ptr [eax+1]
                add     eax, 1
                jmp     short loc_40257D
; ---------------------------------------------------------------------------
                align 10h

loc_4025A0:                             ; CODE XREF: sub_4023B0+1E2\u2191j
                add     eax, 1
                jmp     short loc_402570
; ---------------------------------------------------------------------------

loc_4025A5:                             ; CODE XREF: sub_4023B0+12D\u2191j
                                        ; sub_4023B0+1C6\u2191j
                add     esp, 4
                add     eax, 1
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4025B0:                             ; CODE XREF: sub_4023B0+13A\u2191j
                add     eax, 1
                jmp     loc_4024D7
; ---------------------------------------------------------------------------

loc_4025B8:                             ; CODE XREF: sub_4023B0+7D\u2191j
                mov     eax, edi
                jmp     loc_402452
sub_4023B0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_4025C0      proc near               ; CODE XREF: sub_402970+52\u2193p
                                        ; sub_402F20+28\u2193p

Size            = dword ptr -2Ch

                push    ebp
                push    edi
                push    esi
                mov     esi, eax
                push    ebx
                sub     esp, 1Ch
                test    eax, eax
                jz      short loc_402614
                mov     eax, [eax+0Ch]
                lea     edi, [eax+1]
                lea     ebp, ds:0[edi*4]
                mov     [esp+2Ch+Size], ebp ; Size
                call    malloc
                mov     ebx, eax
                test    ebx, ebx
                mov     [esi+8], eax
                mov     eax, 3
                jz      short loc_402616
                test    edi, edi
                mov     edx, edi
                mov     dword ptr [esi+4], 0
                jle     short loc_402614
                lea     ecx, [ebp-4]
                jmp     short loc_402605
; ---------------------------------------------------------------------------

loc_402602:                             ; CODE XREF: sub_4025C0+52\u2193j
                mov     ebx, [esi+8]

loc_402605:                             ; CODE XREF: sub_4025C0+40\u2191j
                mov     dword ptr [ebx+ecx], 0
                sub     ecx, 4
                sub     edx, 1
                jnz     short loc_402602

loc_402614:                             ; CODE XREF: sub_4025C0+B\u2191j
                                        ; sub_4025C0+3B\u2191j
                xor     eax, eax

loc_402616:                             ; CODE XREF: sub_4025C0+2E\u2191j
                add     esp, 1Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
sub_4025C0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_402620      proc near               ; CODE XREF: sub_402620+EF\u2193p
                                        ; sub_402970+175\u2193p

C               = dword ptr -3Ch
var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h

                push    ebp
                push    edi
                mov     edi, eax
                push    esi
                push    ebx
                sub     esp, 2Ch
                cmp     byte ptr [edx], 2Eh ; '.'
                mov     [esp+3Ch+var_2C], ecx
                jz      loc_402790
                movzx   ecx, byte ptr [eax]

loc_402639:                             ; CODE XREF: sub_402620+184\u2193j
                                        ; sub_402620+1B0\u2193j
                mov     esi, [esp+3Ch+var_2C]
                lea     ebp, [edx+1]
                mov     eax, esi
                and     eax, 20h
                mov     [esp+3Ch+var_28], eax
                mov     eax, esi
                and     eax, 4000h
                mov     [esp+3Ch+var_24], eax

loc_402654:                             ; CODE XREF: sub_402620+12D\u2193j
                movsx   edx, cl
                test    edx, edx
                lea     esi, [ebp-1]
                lea     eax, [edi+1]
                jz      loc_4027D5
                cmp     cl, 3Fh ; '?'
                jz      loc_402752
                cmp     cl, 5Bh ; '['
                jz      loc_402722
                cmp     cl, 2Ah ; '*'
                jz      short loc_4026D8
                mov     ecx, [esp+3Ch+var_28]
                test    ecx, ecx
                jz      loc_402760

loc_402688:                             ; CODE XREF: sub_402620+143\u2193j
                                        ; sub_402620+158\u2193j
                mov     edi, eax

loc_40268A:                             ; CODE XREF: sub_402620+152\u2193j
                movsx   ebx, byte ptr [ebp-1]
                test    bl, bl
                jz      loc_402828
                mov     eax, [esp+3Ch+var_24]
                test    eax, eax
                jnz     loc_402780
                mov     [esp+3Ch+C], edx ; C
                mov     [esp+3Ch+var_20], edx
                call    tolower
                mov     [esp+3Ch+C], ebx ; C
                mov     esi, eax
                call    tolower
                mov     edx, [esp+3Ch+var_20]
                sub     esi, eax

loc_4026BE:                             ; CODE XREF: sub_402620+164\u2193j
                test    esi, esi
                jz      loc_402747

loc_4026C6:                             ; CODE XREF: sub_402620+20A\u2193j
                mov     eax, edx
                sub     eax, ebx
                lea     esi, [esi+0]

loc_4026D0:                             ; CODE XREF: sub_402620+D2\u2193j
                                        ; sub_402620+E7\u2193j ...
                add     esp, 2Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4026D8:                             ; CODE XREF: sub_402620+5A\u2191j
                movzx   edx, byte ptr [edi+1]
                mov     ebx, eax
                cmp     dl, 2Ah ; '*'
                jnz     short loc_4026EE

loc_4026E3:                             ; CODE XREF: sub_402620+CC\u2193j
                add     ebx, 1
                movzx   edx, byte ptr [ebx]
                cmp     dl, 2Ah ; '*'
                jz      short loc_4026E3

loc_4026EE:                             ; CODE XREF: sub_402620+C1\u2191j
                xor     eax, eax
                test    dl, dl
                jz      short loc_4026D0
                mov     edi, [esp+3Ch+var_2C]
                or      edi, 10000h
                jmp     short loc_402709
; ---------------------------------------------------------------------------

loc_402700:                             ; CODE XREF: sub_402620+F6\u2193j
                add     esi, 1
                cmp     byte ptr [esi-1], 0
                jz      short loc_4026D0

loc_402709:                             ; CODE XREF: sub_402620+DE\u2191j
                mov     ecx, edi
                mov     edx, esi
                mov     eax, ebx
                call    sub_402620
                test    eax, eax
                jnz     short loc_402700
                add     esp, 2Ch
                xor     eax, eax
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_402722:                             ; CODE XREF: sub_402620+51\u2191j
                movsx   edx, byte ptr [ebp-1]
                test    edx, edx
                jz      loc_402839
                cmp     byte ptr [edi+1], 21h ; '!'
                jz      short loc_4027B0
                mov     ecx, [esp+3Ch+var_2C]
                call    sub_4023B0
                test    eax, eax
                mov     edi, eax
                jz      loc_40281E

loc_402747:                             ; CODE XREF: sub_402620+A0\u2191j
                                        ; sub_402620+13E\u2193j ...
                movzx   ecx, byte ptr [edi]
                add     ebp, 1
                jmp     loc_402654
; ---------------------------------------------------------------------------

loc_402752:                             ; CODE XREF: sub_402620+48\u2191j
                cmp     byte ptr [ebp-1], 0
                jz      loc_40282F
                mov     edi, eax
                jmp     short loc_402747
; ---------------------------------------------------------------------------

loc_402760:                             ; CODE XREF: sub_402620+62\u2191j
                cmp     edx, 7Fh
                jnz     loc_402688
                movsx   edx, byte ptr [edi+1]
                add     edi, 2
                test    edx, edx
                jnz     loc_40268A
                jmp     loc_402688
; ---------------------------------------------------------------------------
                align 10h

loc_402780:                             ; CODE XREF: sub_402620+7C\u2191j
                mov     esi, edx
                sub     esi, ebx
                jmp     loc_4026BE
; ---------------------------------------------------------------------------
                align 10h

loc_402790:                             ; CODE XREF: sub_402620+10\u2191j
                movsx   eax, byte ptr [eax]
                cmp     al, 2Eh ; '.'
                jz      short loc_4027C9
                mov     ecx, eax
                sub     eax, 2Eh ; '.'
                test    [esp+3Ch+var_2C], 10000h
                jnz     loc_402639
                jmp     loc_4026D0
; ---------------------------------------------------------------------------
                align 10h

loc_4027B0:                             ; CODE XREF: sub_402620+112\u2191j
                mov     ecx, [esp+3Ch+var_2C]
                lea     ebx, [edi+2]
                mov     eax, ebx
                call    sub_4023B0
                test    eax, eax
                jz      short loc_4027DF
                mov     edi, ebx
                jmp     loc_402747
; ---------------------------------------------------------------------------

loc_4027C9:                             ; CODE XREF: sub_402620+175\u2191j
                mov     ecx, 2Eh ; '.'
                xchg    ax, ax
                jmp     loc_402639
; ---------------------------------------------------------------------------

loc_4027D5:                             ; CODE XREF: sub_402620+3F\u2191j
                movsx   eax, byte ptr [esi]
                neg     eax
                jmp     loc_4026D0
; ---------------------------------------------------------------------------

loc_4027DF:                             ; CODE XREF: sub_402620+1A0\u2191j
                movzx   eax, byte ptr [edi+2]
                mov     edx, [esp+3Ch+var_28]
                cmp     al, 5Dh ; ']'
                jnz     short loc_4027FA
                jmp     short loc_402843
; ---------------------------------------------------------------------------
                align 10h

loc_4027F0:                             ; CODE XREF: sub_402620+1E0\u2193j
                                        ; sub_402620+1ED\u2193j
                add     ebx, 1
                test    al, al
                jz      short loc_40281E

loc_4027F7:                             ; CODE XREF: sub_402620+1F2\u2193j
                movzx   eax, byte ptr [ebx]

loc_4027FA:                             ; CODE XREF: sub_402620+1C9\u2191j
                                        ; sub_402620+22E\u2193j
                cmp     al, 5Dh ; ']'
                jz      short loc_402814
                cmp     al, 7Fh
                jnz     short loc_4027F0
                test    edx, edx
                jnz     short loc_40280F
                movzx   eax, byte ptr [ebx+1]
                add     ebx, 1
                jmp     short loc_4027F0
; ---------------------------------------------------------------------------

loc_40280F:                             ; CODE XREF: sub_402620+1E4\u2191j
                add     ebx, 1
                jmp     short loc_4027F7
; ---------------------------------------------------------------------------

loc_402814:                             ; CODE XREF: sub_402620+1DC\u2191j
                add     ebx, 1
                mov     edi, ebx
                jmp     loc_402747
; ---------------------------------------------------------------------------

loc_40281E:                             ; CODE XREF: sub_402620+121\u2191j
                                        ; sub_402620+1D5\u2191j
                mov     eax, 5Dh ; ']'
                jmp     loc_4026D0
; ---------------------------------------------------------------------------

loc_402828:                             ; CODE XREF: sub_402620+70\u2191j
                xor     ebx, ebx
                jmp     loc_4026C6
; ---------------------------------------------------------------------------

loc_40282F:                             ; CODE XREF: sub_402620+136\u2191j
                mov     eax, 3Fh ; '?'
                jmp     loc_4026D0
; ---------------------------------------------------------------------------

loc_402839:                             ; CODE XREF: sub_402620+108\u2191j
                mov     eax, 5Bh ; '['
                jmp     loc_4026D0
; ---------------------------------------------------------------------------

loc_402843:                             ; CODE XREF: sub_402620+1CB\u2191j
                lea     ebx, [edi+3]
                movzx   eax, byte ptr [edi+3]
                mov     edx, [esp+3Ch+var_28]
                jmp     short loc_4027FA
sub_402620      endp

; ---------------------------------------------------------------------------

loc_402850:                             ; CODE XREF: .text:loc_403010\u2193j
                push    edi
                mov     edi, eax
                push    esi
                push    ebx
                sub     esp, 10h
                mov     eax, [eax+4]
                mov     ecx, [edi+0Ch]
                test    eax, eax
                lea     esi, [eax-1]
                lea     ebx, ds:0[ecx*4]
                jle     short loc_402889
                lea     esi, [esi+0]

loc_402870:                             ; CODE XREF: .text:00402887\u2193j
                mov     edx, [edi+8]
                sub     esi, 1
                mov     edx, [edx+ebx]
                add     ebx, 4
                mov     [esp], edx
                call    free
                cmp     esi, 0FFFFFFFFh
                jnz     short loc_402870

loc_402889:                             ; CODE XREF: .text:0040286A\u2191j
                mov     eax, [edi+8]
                mov     [esp], eax
                call    free
                add     esp, 10h
                xor     eax, eax
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_4028A0      proc near               ; CODE XREF: sub_402910+14\u2193j
                                        ; sub_402970+33B\u2193p

Block           = dword ptr -1Ch
Size            = dword ptr -18h

                push    edi
                push    esi
                mov     esi, eax
                push    ebx
                mov     ebx, edx
                sub     esp, 10h
                mov     edx, [edx+4]
                add     edx, [ebx+0Ch]
                lea     eax, ds:8[edx*4]
                mov     [esp+1Ch+Size], eax ; Size
                mov     eax, [ebx+8]
                mov     [esp+1Ch+Block], eax ; Block
                call    realloc
                test    eax, eax
                mov     edx, eax
                jz      short loc_4028F5
                mov     edi, [ebx+4]
                mov     [ebx+8], eax
                mov     eax, [ebx+0Ch]
                lea     ecx, [edi+1]
                add     edi, eax
                add     eax, ecx
                mov     [ebx+4], ecx
                mov     [edx+edi*4], esi
                mov     edx, [ebx+8]
                mov     dword ptr [edx+eax*4], 0
                add     esp, 10h
                xor     eax, eax
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_4028F5:                             ; CODE XREF: sub_4028A0+2A\u2191j
                add     esp, 10h
                mov     eax, 1
                pop     ebx
                pop     esi
                pop     edi
                retn
sub_4028A0      endp

; ---------------------------------------------------------------------------
                jmp     short sub_402910
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_402910      proc near               ; CODE XREF: .text:00402901\u2191j
                                        ; sub_402930+19\u2193p ...
                test    eax, eax
                jnz     short loc_402920

loc_402914:                             ; CODE XREF: sub_402910+12\u2193j
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_402920:                             ; CODE XREF: sub_402910+2\u2191j
                test    edx, edx
                jz      short loc_402914
                jmp     sub_4028A0
sub_402910      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_402930      proc near               ; CODE XREF: sub_402930+F\u2193p
                                        ; sub_402930+27\u2193p ...

Block           = dword ptr -1Ch

                push    esi
                mov     esi, edx
                push    ebx
                mov     ebx, eax
                sub     esp, 14h
                mov     eax, [eax]
                test    eax, eax
                jz      short loc_402944
                call    sub_402930

loc_402944:                             ; CODE XREF: sub_402930+D\u2191j
                mov     eax, [ebx+8]
                mov     edx, esi
                call    sub_402910
                mov     eax, [ebx+4]
                test    eax, eax
                jz      short loc_40295C
                mov     edx, esi
                call    sub_402930

loc_40295C:                             ; CODE XREF: sub_402930+23\u2191j
                mov     [esp+1Ch+Block], ebx ; Block
                call    free
                add     esp, 14h
                pop     ebx
                pop     esi
                retn
sub_402930      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_402970      proc near               ; CODE XREF: sub_402970+88\u2193p
                                        ; sub_402F20+3D\u2193p

String          = byte ptr -6Ch
var_68          = dword ptr -68h
var_64          = dword ptr -64h
var_5D          = byte ptr -5Dh
var_5C          = dword ptr -5Ch
var_58          = dword ptr -58h
var_54          = dword ptr -54h
var_50          = dword ptr -50h
Size            = dword ptr -4Ch
Str             = dword ptr -48h
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_28          = byte ptr -28h
Block           = dword ptr -20h
var_1C          = dword ptr -1Ch
arg_0           = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                push    ebx
                mov     ebx, eax
                sub     esp, 6Ch
                mov     [ebp+var_34], edx
                mov     [ebp+var_5C], ecx
                mov     [esp], eax      ; Str
                call    strlen
                lea     edx, [eax+1]
                add     eax, 10h
                and     eax, 0FFFFFFF0h
                call    sub_402240
                sub     esp, eax
                lea     eax, [esp+78h+String]
                mov     [esp+8], edx    ; Size
                mov     [esp+4], ebx    ; Src
                mov     [esp], eax      ; void *
                call    memcpy
                mov     [esp], eax      ; Source
                call    sub_403020
                mov     [ebp+var_1C], 0
                mov     [ebp+Str], eax
                lea     eax, [ebp+var_28]
                call    sub_4025C0
                test    eax, eax
                jz      short loc_4029D3

loc_4029CB:                             ; CODE XREF: sub_402970+8F\u2193j
                                        ; sub_402970+330\u2193j
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4029D3:                             ; CODE XREF: sub_402970+59\u2191j
                mov     edx, [ebp+var_34]
                mov     eax, [ebp+Str]
                call    sub_402320
                test    eax, eax
                jz      loc_402C40
                mov     edx, [ebp+var_34]
                lea     eax, [ebp+var_28]
                mov     [esp], eax
                mov     ecx, [ebp+var_5C]
                mov     eax, [ebp+Str]
                or      dh, 80h
                call    sub_402970

loc_4029FD:                             ; CODE XREF: sub_402970+340\u2193j
                test    eax, eax
                jnz     short loc_4029CB
                movzx   eax, byte ptr [ebx+1]
                cmp     al, 5Ch ; '\'
                jz      loc_402D68
                cmp     al, 2Fh ; '/'
                jz      loc_402D68
                mov     esi, [ebp+Str]
                mov     edi, offset asc_40A274 ; "."
                mov     ecx, 2
                repe cmpsb
                jnz     loc_402D68
                mov     [ebp+var_5D], 5Ch ; '\'

loc_402A2E:                             ; CODE XREF: sub_402970+48E\u2193j
                test    byte ptr [ebp+var_34], 10h
                mov     [ebp+var_40], ebx
                mov     [ebp+Str], 0
                jnz     loc_402E75

loc_402A42:                             ; CODE XREF: sub_402970+485\u2193j
                                        ; sub_402970+511\u2193j
                mov     eax, [ebp+Block]
                mov     [ebp+var_38], eax
                mov     eax, [eax]
                test    eax, eax
                jz      loc_402EC3
                mov     ecx, [ebp+var_34]
                mov     [ebp+var_3C], 2
                mov     edi, ecx
                and     edi, 4
                mov     [ebp+var_68], edi
                mov     edi, ecx
                and     edi, 8000h
                mov     [ebp+var_30], edi
                nop

loc_402A70:                             ; CODE XREF: sub_402970+378\u2193j
                cmp     [ebp+var_3C], 1
                jz      loc_402CD2
                mov     [esp], eax      ; char *
                call    sub_403590
                test    eax, eax
                mov     [ebp+var_2C], eax
                jz      loc_402E03
                mov     eax, [ebp+Str]
                test    eax, eax
                jz      loc_402E55
                mov     eax, [ebp+var_38]
                mov     eax, [eax]
                mov     [esp], eax      ; Str
                call    strlen
                mov     [ebp+Size], eax

loc_402AA8:                             ; CODE XREF: sub_402970+4EC\u2193j
                mov     eax, [ebp+var_34]
                mov     [ebp+var_44], 0
                and     eax, 40h
                mov     [ebp+var_58], eax

loc_402AB8:                             ; CODE XREF: sub_402970+168\u2193j
                                        ; sub_402970+17C\u2193j ...
                mov     eax, [ebp+var_2C]
                mov     [esp], eax
                call    sub_403730
                test    eax, eax
                mov     esi, eax
                jz      loc_402CB5
                mov     eax, [ebp+var_30]
                test    eax, eax
                jz      short loc_402ADA
                cmp     dword ptr [esi+8], 10h
                jnz     short loc_402AB8

loc_402ADA:                             ; CODE XREF: sub_402970+162\u2191j
                mov     ecx, [ebp+var_34]
                lea     ebx, [esi+0Ch]
                mov     eax, [ebp+var_40]
                mov     edx, ebx
                call    sub_402620
                test    eax, eax
                jnz     short loc_402AB8
                movzx   edx, word ptr [esi+6]
                mov     ecx, [ebp+Size]
                mov     [ebp+var_50], esp
                lea     eax, [ecx+edx+11h]
                and     eax, 0FFFFFFF0h
                call    sub_402240
                sub     esp, eax
                xor     eax, eax
                lea     edi, [esp+78h+String]
                test    ecx, ecx
                mov     [ebp+var_54], edi
                jnz     loc_402D04

loc_402B17:                             ; CODE XREF: sub_402970+3CE\u2193j
                                        ; sub_402970+3F3\u2193j
                add     edx, 1
                add     eax, edi
                mov     [esp+8], edx    ; Size
                mov     [esp+4], ebx    ; Src
                mov     ebx, esp
                mov     [esp], eax      ; void *
                call    memcpy
                mov     [esp], edi      ; Str
                call    strlen
                add     eax, 10h
                and     eax, 0FFFFFFF0h
                call    sub_402240
                mov     esi, [ebp+var_54]
                sub     esp, eax
                lea     ecx, [esp+78h+String]
                mov     edx, ecx
                jmp     short loc_402B5D
; ---------------------------------------------------------------------------
                align 10h

loc_402B50:                             ; CODE XREF: sub_402970+1F2\u2193j
                add     edx, 1
                add     esi, 1
                test    al, al
                mov     [edx-1], al
                jz      short loc_402B78

loc_402B5D:                             ; CODE XREF: sub_402970+1DC\u2191j
                                        ; sub_402970+206\u2193j
                movzx   eax, byte ptr [esi]
                cmp     al, 7Fh
                jnz     short loc_402B50
                movzx   eax, byte ptr [esi+1]
                add     esi, 1
                add     edx, 1
                add     esi, 1
                test    al, al
                mov     [edx-1], al
                jnz     short loc_402B5D

loc_402B78:                             ; CODE XREF: sub_402970+1EB\u2191j
                mov     [esp], ecx      ; String
                call    _strdup
                mov     esp, ebx
                test    eax, eax
                mov     esi, eax
                jz      loc_402D52
                xor     eax, eax
                cmp     [ebp+var_3C], 2
                setz    al
                sub     eax, 1
                and     [ebp+var_3C], eax
                mov     eax, [ebp+var_58]
                test    eax, eax
                jnz     loc_402D43
                mov     ebx, [ebp+var_44]
                test    ebx, ebx
                jz      loc_402E6C
                mov     edi, [ebp+var_34]
                and     edi, 4000h
                jmp     short loc_402BD4
; ---------------------------------------------------------------------------
                align 10h

loc_402BC0:                             ; CODE XREF: sub_402970+270\u2193j
                call    strcoll
                mov     ecx, [ebx]
                mov     edx, [ebx+4]
                test    eax, eax
                jle     short loc_402BF0

loc_402BCE:                             ; CODE XREF: sub_402970+27E\u2193j
                test    edx, edx
                jz      short loc_402BF6

loc_402BD2:                             ; CODE XREF: sub_402970+284\u2193j
                mov     ebx, edx

loc_402BD4:                             ; CODE XREF: sub_402970+24A\u2191j
                mov     eax, [ebx+8]
                test    edi, edi
                mov     [esp], esi      ; String1
                mov     [esp+4], eax    ; String2
                jnz     short loc_402BC0
                call    _stricoll
                mov     ecx, [ebx]
                mov     edx, [ebx+4]
                test    eax, eax
                jg      short loc_402BCE

loc_402BF0:                             ; CODE XREF: sub_402970+25C\u2191j
                mov     edx, ecx
                test    edx, edx
                jnz     short loc_402BD2

loc_402BF6:                             ; CODE XREF: sub_402970+260\u2191j
                mov     ecx, eax

loc_402BF8:                             ; CODE XREF: sub_402970+500\u2193j
                mov     [ebp+var_54], ecx
                mov     dword ptr [esp], 0Ch ; Size
                call    malloc
                test    eax, eax
                jz      short loc_402C2D
                test    ebx, ebx
                mov     [eax+8], esi
                mov     dword ptr [eax+4], 0
                mov     dword ptr [eax], 0
                jz      short loc_402C2D
                mov     ecx, [ebp+var_54]
                test    ecx, ecx
                jle     loc_402E40
                mov     [ebx+4], eax

loc_402C2D:                             ; CODE XREF: sub_402970+299\u2191j
                                        ; sub_402970+2AD\u2191j
                mov     edi, [ebp+var_44]
                test    edi, edi
                jz      loc_402E4D

loc_402C38:                             ; CODE XREF: sub_402970+3DD\u2193j
                                        ; sub_402970+3E9\u2193j ...
                mov     esp, [ebp+var_50]
                jmp     loc_402AB8
; ---------------------------------------------------------------------------

loc_402C40:                             ; CODE XREF: sub_402970+70\u2191j
                mov     eax, [ebp+Str]
                mov     esi, esp
                mov     [esp], eax      ; Str
                call    strlen
                add     eax, 10h
                and     eax, 0FFFFFFF0h
                call    sub_402240
                mov     edx, [ebp+Str]
                sub     esp, eax
                lea     edi, [esp+78h+String]
                mov     ecx, edi
                jmp     short loc_402C72
; ---------------------------------------------------------------------------

loc_402C65:                             ; CODE XREF: sub_402970+307\u2193j
                add     ecx, 1
                add     edx, 1
                test    al, al
                mov     [ecx-1], al
                jz      short loc_402C8D

loc_402C72:                             ; CODE XREF: sub_402970+2F3\u2191j
                                        ; sub_402970+31B\u2193j
                movzx   eax, byte ptr [edx]
                cmp     al, 7Fh
                jnz     short loc_402C65
                movzx   eax, byte ptr [edx+1]
                add     edx, 1
                add     ecx, 1
                add     edx, 1
                test    al, al
                mov     [ecx-1], al
                jnz     short loc_402C72

loc_402C8D:                             ; CODE XREF: sub_402970+300\u2191j
                mov     [esp], edi      ; String
                call    _strdup
                mov     esp, esi
                mov     ecx, eax
                mov     eax, 1
                test    ecx, ecx
                jz      loc_4029CB
                lea     edx, [ebp+var_28]
                mov     eax, ecx
                call    sub_4028A0
                jmp     loc_4029FD
; ---------------------------------------------------------------------------

loc_402CB5:                             ; CODE XREF: sub_402970+157\u2191j
                mov     eax, [ebp+var_2C]
                mov     [esp], eax      ; Block
                call    sub_403780
                mov     esi, [ebp+var_44]
                test    esi, esi
                jz      short loc_402CD2
                mov     edx, [ebp+arg_0]
                mov     eax, [ebp+var_44]
                call    sub_402930

loc_402CD2:                             ; CODE XREF: sub_402970+104\u2191j
                                        ; sub_402970+355\u2191j ...
                add     [ebp+var_38], 4
                mov     edi, [ebp+var_38]
                mov     eax, [edi-4]
                mov     [esp], eax      ; Block
                call    free
                mov     eax, [edi]
                test    eax, eax
                jnz     loc_402A70
                mov     eax, [ebp+Block]

loc_402CF1:                             ; CODE XREF: sub_402970+55D\u2193j
                                        ; sub_402970+591\u2193j
                mov     [esp], eax      ; Block
                call    free
                mov     eax, [ebp+var_3C]
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_402D04:                             ; CODE XREF: sub_402970+1A1\u2191j
                mov     eax, [ebp+var_38]
                mov     esi, [ebp+Size]
                mov     [ebp+var_64], edx
                mov     eax, [eax]
                mov     [esp+8], esi    ; Size
                mov     [esp], edi      ; void *
                mov     [esp+4], eax    ; Src
                call    memcpy
                movzx   eax, byte ptr [esp+esi+0Bh]
                mov     edx, [ebp+var_64]
                cmp     al, 5Ch ; '\'
                jz      short loc_402D60
                cmp     al, 2Fh ; '/'
                jz      short loc_402D60
                mov     esi, [ebp+Size]
                movzx   ecx, [ebp+var_5D]
                mov     eax, esi
                add     eax, 1
                mov     [edi+esi], cl
                jmp     loc_402B17
; ---------------------------------------------------------------------------

loc_402D43:                             ; CODE XREF: sub_402970+230\u2191j
                mov     edx, [ebp+arg_0]
                mov     eax, esi
                call    sub_402910
                jmp     loc_402C38
; ---------------------------------------------------------------------------

loc_402D52:                             ; CODE XREF: sub_402970+216\u2191j
                mov     [ebp+var_3C], 3
                jmp     loc_402C38
; ---------------------------------------------------------------------------
                align 10h

loc_402D60:                             ; CODE XREF: sub_402970+3B9\u2191j
                                        ; sub_402970+3BD\u2191j
                mov     eax, [ebp+Size]
                jmp     loc_402B17
; ---------------------------------------------------------------------------

loc_402D68:                             ; CODE XREF: sub_402970+97\u2191j
                                        ; sub_402970+9F\u2191j ...
                mov     eax, [ebp+Str]
                mov     [esp], eax      ; Str
                call    strlen
                add     eax, ebx
                cmp     ebx, eax
                jnb     loc_402F11
                movzx   edx, byte ptr [eax]
                cmp     dl, 2Fh ; '/'
                jz      loc_402F06
                cmp     dl, 5Ch ; '\'
                jnz     short loc_402DAB
                xchg    ax, ax
                jmp     loc_402F06
; ---------------------------------------------------------------------------

loc_402D95:                             ; CODE XREF: sub_402970+440\u2193j
                movzx   eax, byte ptr [eax-1]
                cmp     al, 5Ch ; '\'
                jz      loc_402E61
                cmp     al, 2Fh ; '/'
                jz      loc_402E61
                mov     eax, edx

loc_402DAB:                             ; CODE XREF: sub_402970+41C\u2191j
                lea     edx, [eax-1]
                cmp     edx, ebx
                jnz     short loc_402D95
                movzx   eax, byte ptr [eax-1]
                mov     [ebp+var_40], edx
                mov     [ebp+var_5D], al

loc_402DBC:                             ; CODE XREF: sub_402970+4F7\u2193j
                                        ; sub_402970+59C\u2193j ...
                cmp     [ebp+var_5D], 5Ch ; '\'
                jnz     loc_402ED2

loc_402DC6:                             ; CODE XREF: sub_402970+566\u2193j
                mov     eax, [ebp+var_40]
                movzx   ecx, [ebp+var_5D]
                add     eax, 1
                movzx   edx, byte ptr [eax]
                cmp     dl, 5Ch ; '\'
                jnz     short loc_402DE5

loc_402DD8:                             ; CODE XREF: sub_402970+473\u2193j
                                        ; sub_402970+478\u2193j
                add     eax, 1
                mov     ecx, edx
                movzx   edx, byte ptr [eax]
                cmp     dl, 5Ch ; '\'
                jz      short loc_402DD8

loc_402DE5:                             ; CODE XREF: sub_402970+466\u2191j
                cmp     dl, 2Fh ; '/'
                jz      short loc_402DD8
                mov     [ebp+var_40], eax
                mov     [ebp+var_5D], cl

loc_402DF0:                             ; CODE XREF: sub_402970+570\u2193j
                mov     eax, [ebp+Str]
                test    eax, eax
                jnz     loc_402A42
                mov     ebx, [ebp+var_40]
                jmp     loc_402A2E
; ---------------------------------------------------------------------------

loc_402E03:                             ; CODE XREF: sub_402970+117\u2191j
                mov     ebx, [ebp+var_68]
                test    ebx, ebx
                jnz     short loc_402E32
                mov     edi, [ebp+var_5C]
                test    edi, edi
                jz      loc_402CD2
                call    _errno
                mov     eax, [eax]
                mov     [esp+4], eax
                mov     eax, [ebp+var_38]
                mov     eax, [eax]
                mov     [esp], eax
                call    edi
                test    eax, eax
                jz      loc_402CD2

loc_402E32:                             ; CODE XREF: sub_402970+498\u2191j
                mov     [ebp+var_3C], 1
                jmp     loc_402CD2
; ---------------------------------------------------------------------------
                align 10h

loc_402E40:                             ; CODE XREF: sub_402970+2B4\u2191j
                mov     edi, [ebp+var_44]
                mov     [ebx], eax
                test    edi, edi
                jnz     loc_402C38

loc_402E4D:                             ; CODE XREF: sub_402970+2C2\u2191j
                mov     [ebp+var_44], eax
                jmp     loc_402C38
; ---------------------------------------------------------------------------

loc_402E55:                             ; CODE XREF: sub_402970+122\u2191j
                mov     [ebp+Size], 0
                jmp     loc_402AA8
; ---------------------------------------------------------------------------

loc_402E61:                             ; CODE XREF: sub_402970+42B\u2191j
                                        ; sub_402970+433\u2191j
                mov     [ebp+var_40], edx
                mov     [ebp+var_5D], al
                jmp     loc_402DBC
; ---------------------------------------------------------------------------

loc_402E6C:                             ; CODE XREF: sub_402970+23B\u2191j
                xor     ebx, ebx
                xor     ecx, ecx
                jmp     loc_402BF8
; ---------------------------------------------------------------------------

loc_402E75:                             ; CODE XREF: sub_402970+CC\u2191j
                mov     edx, [ebp+var_34]
                mov     eax, ebx
                call    sub_402320
                test    eax, eax
                jnz     loc_402A42
                mov     [esp], ebx      ; Str
                mov     esi, esp
                call    strlen
                add     eax, 10h
                and     eax, 0FFFFFFF0h
                call    sub_402240
                sub     esp, eax
                lea     ecx, [esp+78h+String]
                mov     edx, ecx
                jmp     short loc_402EB3
; ---------------------------------------------------------------------------

loc_402EA6:                             ; CODE XREF: sub_402970+548\u2193j
                                        ; sub_402970+551\u2193j
                add     edx, 1
                add     ebx, 1
                test    al, al
                mov     [edx-1], al
                jz      short loc_402EE5

loc_402EB3:                             ; CODE XREF: sub_402970+534\u2191j
                movzx   eax, byte ptr [ebx]
                cmp     al, 7Fh
                jnz     short loc_402EA6
                movzx   eax, byte ptr [ebx+1]
                add     ebx, 1
                jmp     short loc_402EA6
; ---------------------------------------------------------------------------

loc_402EC3:                             ; CODE XREF: sub_402970+DC\u2191j
                mov     eax, [ebp+var_38]
                mov     [ebp+var_3C], 2
                jmp     loc_402CF1
; ---------------------------------------------------------------------------

loc_402ED2:                             ; CODE XREF: sub_402970+450\u2191j
                cmp     [ebp+var_5D], 2Fh ; '/'
                jz      loc_402DC6
                mov     [ebp+var_5D], 5Ch ; '\'
                jmp     loc_402DF0
; ---------------------------------------------------------------------------

loc_402EE5:                             ; CODE XREF: sub_402970+541\u2191j
                mov     [esp], ecx      ; String
                call    _strdup
                mov     edx, [ebp+arg_0]
                mov     esp, esi
                call    sub_402910
                mov     eax, [ebp+Block]
                mov     [ebp+var_3C], 0
                jmp     loc_402CF1
; ---------------------------------------------------------------------------

loc_402F06:                             ; CODE XREF: sub_402970+413\u2191j
                                        ; sub_402970+420\u2191j
                mov     [ebp+var_5D], dl
                mov     [ebp+var_40], eax
                jmp     loc_402DBC
; ---------------------------------------------------------------------------

loc_402F11:                             ; CODE XREF: sub_402970+407\u2191j
                movzx   ecx, byte ptr [eax]
                mov     [ebp+var_40], eax
                mov     [ebp+var_5D], cl
                jmp     loc_402DBC
sub_402970      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402F20(char *Str, int, int, int)
sub_402F20      proc near               ; CODE XREF: sub_401750+146\u2191p
                                        ; sub_401750+242\u2191p

String          = byte ptr -24h
var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
Str             = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                push    ebx
                sub     esp, 1Ch
                mov     esi, [ebp+arg_C]
                mov     ebx, [ebp+Str]
                mov     edi, [ebp+arg_4]
                test    esi, esi
                jz      short loc_402F3E
                test    edi, 2
                jz      short loc_402F73

loc_402F3E:                             ; CODE XREF: sub_402F20+14\u2191j
                                        ; sub_402F20+5A\u2193j
                cmp     dword ptr [esi], offset aGlob10Mingw32 ; "glob-1.0-mingw32"
                jz      short loc_402F53
                mov     eax, esi
                call    sub_4025C0
                mov     dword ptr [esi], offset aGlob10Mingw32 ; "glob-1.0-mingw32"

loc_402F53:                             ; CODE XREF: sub_402F20+24\u2191j
                mov     [esp], esi
                mov     ecx, [ebp+arg_8]
                mov     edx, edi
                mov     eax, ebx
                call    sub_402970
                cmp     eax, 2
                mov     ecx, eax
                jz      short loc_402F80

loc_402F69:                             ; CODE XREF: sub_402F20+63\u2193j
                lea     esp, [ebp-0Ch]
                mov     eax, ecx
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_402F73:                             ; CODE XREF: sub_402F20+1C\u2191j
                mov     dword ptr [esi+0Ch], 0
                jmp     short loc_402F3E
; ---------------------------------------------------------------------------
                align 10h

loc_402F80:                             ; CODE XREF: sub_402F20+47\u2191j
                and     edi, 10h
                jz      short loc_402F69
                mov     [ebp+var_20], eax
                mov     [ebp+var_1C], esp
                mov     [esp], ebx      ; Str
                call    strlen
                add     eax, 10h
                and     eax, 0FFFFFFF0h
                call    sub_402240
                mov     ecx, [ebp+var_20]
                sub     esp, eax
                lea     edi, [esp+28h+String]
                mov     edx, edi
                jmp     short loc_402FBD
; ---------------------------------------------------------------------------
                align 10h

loc_402FB0:                             ; CODE XREF: sub_402F20+A2\u2193j
                add     edx, 1
                add     ebx, 1
                test    al, al
                mov     [edx-1], al
                jz      short loc_402FD8

loc_402FBD:                             ; CODE XREF: sub_402F20+89\u2191j
                                        ; sub_402F20+B6\u2193j
                movzx   eax, byte ptr [ebx]
                cmp     al, 7Fh
                jnz     short loc_402FB0
                movzx   eax, byte ptr [ebx+1]
                add     ebx, 1
                add     edx, 1
                add     ebx, 1
                test    al, al
                mov     [edx-1], al
                jnz     short loc_402FBD

loc_402FD8:                             ; CODE XREF: sub_402F20+9B\u2191j
                mov     [ebp+var_20], ecx
                mov     [esp], edi      ; String
                call    _strdup
                mov     esp, [ebp+var_1C]
                mov     edx, esi
                call    sub_402910
                mov     ecx, [ebp+var_20]
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                mov     eax, ecx
                pop     ebp
                retn
sub_402F20      endp

; ---------------------------------------------------------------------------
                align 10h
                mov     eax, [esp+4]
                cmp     dword ptr [eax], offset aGlob10Mingw32 ; "glob-1.0-mingw32"
                jz      short loc_403010
                rep retn
; ---------------------------------------------------------------------------
                align 10h

loc_403010:                             ; CODE XREF: .text:0040300A\u2191j
                jmp     loc_402850
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403020(char *Source)
sub_403020      proc near               ; CODE XREF: sub_402970+40\u2191p

MaxCount        = dword ptr -30h
var_2C          = dword ptr -2Ch
var_26          = word ptr -26h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
Source          = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                push    ebx
                sub     esp, 3Ch
                mov     esi, [ebp+Source]
                mov     dword ptr [esp+4], 0 ; Locale
                mov     dword ptr [esp], 2 ; Category
                call    setlocale
                test    eax, eax
                mov     ebx, eax
                jz      short loc_403050
                mov     [esp], eax      ; String
                call    _strdup
                mov     ebx, eax

loc_403050:                             ; CODE XREF: sub_403020+24\u2191j
                mov     dword ptr [esp+4], offset Locale ; Locale
                mov     dword ptr [esp], 2 ; Category
                call    setlocale
                test    esi, esi
                jz      short loc_40306D
                cmp     byte ptr [esi], 0
                jnz     short loc_4030E0

loc_40306D:                             ; CODE XREF: sub_403020+46\u2191j
                                        ; sub_403020+35A\u2193j
                mov     dword ptr [esp+8], 0 ; MaxCount
                mov     dword ptr [esp+4], offset Source ; "."
                mov     dword ptr [esp], 0 ; Dest
                call    wcstombs
                lea     esi, [eax+1]
                mov     [esp+4], esi    ; Size
                mov     eax, ds:Block
                mov     [esp], eax      ; Block
                call    realloc
                mov     ds:Block, eax
                mov     [esp+8], esi    ; MaxCount
                mov     dword ptr [esp+4], offset Source ; "."
                mov     [esp], eax      ; Dest
                call    wcstombs
                mov     [esp+4], ebx    ; Locale
                mov     dword ptr [esp], 2 ; Category
                call    setlocale
                mov     [esp], ebx      ; Block
                call    free
                mov     eax, ds:Block
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4030E0:                             ; CODE XREF: sub_403020+4B\u2191j
                mov     [ebp+var_2C], esp
                mov     dword ptr [esp+8], 0 ; MaxCount
                mov     [esp+4], esi    ; Source
                mov     dword ptr [esp], 0 ; Dest
                call    mbstowcs
                mov     edx, eax
                lea     eax, [eax+eax+12h]
                and     eax, 0FFFFFFF0h
                call    sub_402240
                sub     esp, eax
                lea     eax, [esp+0Dh]
                mov     [ebp+var_1C], eax
                shr     [ebp+var_1C], 1
                mov     eax, [ebp+var_1C]
                add     eax, eax
                mov     [ebp+var_20], eax
                mov     edi, eax
                mov     [esp+8], edx    ; MaxCount
                mov     [esp+4], esi    ; Source
                mov     [esp], eax      ; Dest
                call    mbstowcs
                xor     ecx, ecx
                mov     [edi+eax*2], cx
                cmp     eax, 1
                mov     [ebp+MaxCount], eax
                mov     eax, [ebp+var_1C]
                movzx   eax, word ptr [eax+eax]
                mov     [ebp+var_26], ax
                jbe     loc_40323E
                cmp     ax, 5Ch ; '\'
                jz      short loc_40315C
                cmp     ax, 2Fh ; '/'
                jnz     loc_403266

loc_40315C:                             ; CODE XREF: sub_403020+130\u2191j
                mov     edi, [ebp+var_20]
                mov     [ebp+var_24], edi
                mov     edi, [ebp+var_1C]
                cmp     ax, [edi+edi+2]
                jz      loc_4033BF

loc_403170:                             ; CODE XREF: sub_403020+224\u2193j
                                        ; sub_403020+255\u2193j ...
                movzx   eax, [ebp+var_26]
                test    ax, ax
                jz      loc_403377
                mov     edx, [ebp+var_24]
                mov     edi, edx
                jmp     short loc_403198
; ---------------------------------------------------------------------------

loc_403184:                             ; CODE XREF: sub_403020+17C\u2193j
                cmp     ax, 2Fh ; '/'
                jz      short loc_4031AA
                movzx   eax, word ptr [edx+2]
                lea     ecx, [edx+2]
                test    ax, ax
                jz      short loc_4031CC

loc_403196:                             ; CODE XREF: sub_403020+1AA\u2193j
                mov     edx, ecx

loc_403198:                             ; CODE XREF: sub_403020+162\u2191j
                cmp     ax, 5Ch ; '\'
                jnz     short loc_403184
                movzx   eax, word ptr [edx]
                cmp     ax, 5Ch ; '\'
                jnz     short loc_4031B3

loc_4031A7:                             ; CODE XREF: sub_403020+191\u2193j
                                        ; sub_403020+197\u2193j
                add     edx, 2

loc_4031AA:                             ; CODE XREF: sub_403020+168\u2191j
                movzx   eax, word ptr [edx]
                cmp     ax, 5Ch ; '\'
                jz      short loc_4031A7

loc_4031B3:                             ; CODE XREF: sub_403020+185\u2191j
                cmp     ax, 2Fh ; '/'
                jz      short loc_4031A7
                test    ax, ax
                jz      short loc_4031CC
                movzx   eax, word ptr [edx+2]
                mov     edi, edx
                lea     ecx, [edx+2]
                test    ax, ax
                jnz     short loc_403196

loc_4031CC:                             ; CODE XREF: sub_403020+174\u2191j
                                        ; sub_403020+19C\u2191j
                mov     ecx, [ebp+var_24]
                cmp     ecx, edi
                jb      short loc_403251
                cmp     [ebp+var_26], 5Ch ; '\'
                jz      short loc_4031E5
                cmp     [ebp+var_26], 2Fh ; '/'
                jnz     loc_40339F

loc_4031E5:                             ; CODE XREF: sub_403020+1B8\u2191j
                mov     eax, [ebp+var_24]
                add     eax, 2

loc_4031EB:                             ; CODE XREF: sub_403020+38F\u2193j
                xor     edx, edx
                mov     [eax], dx
                mov     dword ptr [esp+8], 0 ; MaxCount
                mov     eax, [ebp+var_20]
                mov     dword ptr [esp], 0 ; Dest
                mov     [esp+4], eax    ; Source
                call    wcstombs
                lea     edi, [eax+1]
                mov     [esp+4], edi    ; Size
                mov     eax, ds:Block
                mov     [esp], eax      ; Block
                call    realloc
                mov     ds:Block, eax
                mov     esi, eax
                mov     [esp+8], edi    ; MaxCount
                mov     eax, [ebp+var_20]
                mov     [esp], esi      ; Dest
                mov     [esp+4], eax    ; Source
                call    wcstombs
                jmp     loc_403327
; ---------------------------------------------------------------------------

loc_40323E:                             ; CODE XREF: sub_403020+126\u2191j
                mov     eax, [ebp+var_20]
                mov     [ebp+var_24], eax
                jmp     loc_403170
; ---------------------------------------------------------------------------

loc_403249:                             ; CODE XREF: sub_403020+240\u2193j
                cmp     dx, 2Fh ; '/'
                jnz     short loc_403295
                mov     edi, eax

loc_403251:                             ; CODE XREF: sub_403020+1B1\u2191j
                                        ; sub_403020+244\u2193j
                lea     eax, [edi-2]
                cmp     ecx, eax
                jnb     short loc_403295
                movzx   edx, word ptr [edi-2]
                cmp     dx, 5Ch ; '\'
                jnz     short loc_403249
                mov     edi, eax
                jmp     short loc_403251
; ---------------------------------------------------------------------------

loc_403266:                             ; CODE XREF: sub_403020+136\u2191j
                mov     eax, [ebp+var_20]
                mov     [ebp+var_24], eax
                mov     eax, [ebp+var_1C]
                cmp     word ptr [eax+eax+2], 3Ah ; ':'
                jnz     loc_403170
                mov     eax, [ebp+var_20]
                add     eax, 4
                mov     [ebp+var_24], eax
                mov     eax, [ebp+var_1C]
                movzx   eax, word ptr [eax+eax+4]
                mov     [ebp+var_26], ax
                jmp     loc_403170
; ---------------------------------------------------------------------------

loc_403295:                             ; CODE XREF: sub_403020+22D\u2191j
                                        ; sub_403020+236\u2191j
                cmp     [ebp+var_24], eax
                jz      loc_4033D5

loc_40329E:                             ; CODE XREF: sub_403020+3C4\u2193j
                                        ; sub_403020+3D5\u2193j ...
                xor     edx, edx
                mov     [eax+2], dx
                mov     eax, [ebp+var_1C]
                movzx   edx, word ptr [eax+eax]
                mov     eax, [ebp+var_20]
                cmp     dx, 5Ch ; '\'
                jnz     loc_40337F

loc_4032B8:                             ; CODE XREF: sub_403020+2A2\u2193j
                                        ; sub_403020+2A8\u2193j ...
                add     eax, 2
                movzx   ecx, word ptr [eax]
                cmp     cx, 5Ch ; '\'
                jz      short loc_4032B8
                cmp     cx, 2Fh ; '/'
                jz      short loc_4032B8
                mov     ecx, eax
                sub     ecx, [ebp+var_20]
                cmp     ecx, 5
                jle     loc_403389

loc_4032D8:                             ; CODE XREF: sub_403020+371\u2193j
                mov     eax, [ebp+var_20]

loc_4032DB:                             ; CODE XREF: sub_403020+37A\u2193j
                mov     ecx, eax

loc_4032DD:                             ; CODE XREF: sub_403020+352\u2193j
                                        ; sub_403020+39A\u2193j
                test    dx, dx
                jz      short loc_403303

loc_4032E2:                             ; CODE XREF: sub_403020+2E1\u2193j
                add     ecx, 2
                cmp     dx, 2Fh ; '/'
                mov     [ecx-2], dx
                jz      short loc_403352
                cmp     word ptr [eax], 5Ch ; '\'
                lea     edi, [eax+2]
                jz      short loc_403350
                movzx   edx, word ptr [eax+2]
                mov     eax, edi
                test    dx, dx
                jnz     short loc_4032E2

loc_403303:                             ; CODE XREF: sub_403020+2C0\u2191j
                mov     eax, [ebp+MaxCount]
                xor     edi, edi
                mov     [ecx], di
                mov     [esp+8], eax    ; MaxCount
                mov     eax, [ebp+var_20]
                mov     [esp], esi      ; Dest
                mov     [esp+4], eax    ; Source
                call    wcstombs
                cmp     eax, 0FFFFFFFFh
                jz      short loc_403327
                mov     byte ptr [esi+eax], 0

loc_403327:                             ; CODE XREF: sub_403020+219\u2191j
                                        ; sub_403020+301\u2191j ...
                mov     [esp+4], ebx    ; Locale
                mov     dword ptr [esp], 2 ; Category
                call    setlocale
                mov     [esp], ebx      ; Block
                call    free
                mov     esp, [ebp+var_2C]
                lea     esp, [ebp-0Ch]
                pop     ebx
                mov     eax, esi
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_403350:                             ; CODE XREF: sub_403020+2D6\u2191j
                mov     eax, edi

loc_403352:                             ; CODE XREF: sub_403020+2CD\u2191j
                movzx   edx, word ptr [eax]
                cmp     dx, 2Fh ; '/'
                jnz     short loc_4033B4
                nop
                lea     esi, [esi+0]

loc_403360:                             ; CODE XREF: sub_403020+34A\u2193j
                                        ; sub_403020+350\u2193j ...
                add     eax, 2
                movzx   edx, word ptr [eax]
                cmp     dx, 5Ch ; '\'
                jz      short loc_403360
                cmp     dx, 2Fh ; '/'
                jz      short loc_403360
                jmp     loc_4032DD
; ---------------------------------------------------------------------------

loc_403377:                             ; CODE XREF: sub_403020+157\u2191j
                mov     esp, [ebp+var_2C]
                jmp     loc_40306D
; ---------------------------------------------------------------------------

loc_40337F:                             ; CODE XREF: sub_403020+292\u2191j
                cmp     dx, 2Fh ; '/'
                jz      loc_4032B8

loc_403389:                             ; CODE XREF: sub_403020+2B2\u2191j
                mov     edi, [ebp+var_1C]
                cmp     [edi+edi+2], dx
                jnz     loc_4032D8
                movzx   edx, word ptr [eax]
                jmp     loc_4032DB
; ---------------------------------------------------------------------------

loc_40339F:                             ; CODE XREF: sub_403020+1BF\u2191j
                mov     edi, [ebp+var_24]
                mov     ecx, 2Eh ; '.'
                mov     eax, edi
                add     eax, 2
                mov     [edi], cx
                jmp     loc_4031EB
; ---------------------------------------------------------------------------

loc_4033B4:                             ; CODE XREF: sub_403020+339\u2191j
                cmp     dx, 5Ch ; '\'
                jz      short loc_403360
                jmp     loc_4032DD
; ---------------------------------------------------------------------------

loc_4033BF:                             ; CODE XREF: sub_403020+14A\u2191j
                cmp     word ptr [edi+edi+4], 0
                jnz     loc_403170
                nop
                lea     esi, [esi+0]
                jmp     loc_403327
; ---------------------------------------------------------------------------

loc_4033D5:                             ; CODE XREF: sub_403020+278\u2191j
                cmp     [ebp+var_26], 5Ch ; '\'
                jz      short loc_4033EA
                cmp     [ebp+var_26], 2Fh ; '/'
                mov     eax, [ebp+var_24]
                jnz     loc_40329E

loc_4033EA:                             ; CODE XREF: sub_403020+3BA\u2191j
                mov     eax, [ebp+var_24]
                movzx   ecx, [ebp+var_26]
                cmp     [eax+2], cx
                jnz     loc_40329E
                movzx   edx, word ptr [eax+4]
                cmp     dx, 2Fh ; '/'
                jz      loc_40329E
                cmp     dx, 5Ch ; '\'
                mov     eax, edi
                jnz     loc_40329E
                mov     eax, [ebp+var_24]
                jmp     loc_40329E
sub_403020      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_403420      proc near               ; CODE XREF: sub_403730+27\u2193p
                                        ; .text:00403890\u2193p

FindFileData    = _WIN32_FIND_DATAA ptr -148h

                push    ebp
                mov     ebp, esp
                push    esi
                mov     esi, edx
                push    ebx
                sub     esp, 150h
                lea     edx, [ebp+FindFileData]
                mov     [esp+4], edx    ; lpFindFileData
                mov     [esp], eax      ; hFindFile
                call    FindNextFileA
                sub     esp, 8
                test    eax, eax
                mov     ebx, eax
                jnz     short loc_403468
                call    GetLastError
                xor     ebx, ebx
                cmp     eax, 12h
                jz      short loc_40345F
                call    _errno
                mov     dword ptr [eax], 2

loc_40345F:                             ; CODE XREF: sub_403420+32\u2191j
                lea     esp, [ebp-8]
                mov     eax, ebx
                pop     ebx
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_403468:                             ; CODE XREF: sub_403420+26\u2191j
                lea     eax, [ebp+FindFileData.cFileName]
                mov     [esp+0Ch], eax
                lea     eax, [esi+0Ch]
                mov     dword ptr [esp+8], offset aS_0 ; "%s"
                mov     dword ptr [esp+4], 104h
                mov     [esp], eax
                call    sub_402270
                mov     [esi+6], ax
                mov     eax, [ebp+FindFileData.dwFileAttributes]
                and     al, 58h
                cmp     eax, 10h
                jbe     short loc_4034B0
                mov     dword ptr [esi+8], 18h
                lea     esp, [ebp-8]
                mov     eax, ebx
                pop     ebx
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4034B0:                             ; CODE XREF: sub_403420+7C\u2191j
                mov     [esi+8], eax
                lea     esp, [ebp-8]
                mov     eax, ebx
                pop     ebx
                pop     esi
                pop     ebp
                retn
sub_403420      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_4034C0      proc near               ; CODE XREF: sub_403590+102\u2193p
                                        ; sub_4037D0+3B\u2193p

FindFileData    = _WIN32_FIND_DATAA ptr -148h

                push    ebp
                mov     ebp, esp
                push    esi
                push    ebx
                mov     ebx, edx
                sub     esp, 150h
                lea     edx, [ebp+FindFileData]
                mov     [esp+4], edx    ; lpFindFileData
                mov     [esp], eax      ; lpFileName
                call    FindFirstFileA
                sub     esp, 8
                cmp     eax, 0FFFFFFFFh
                mov     esi, eax
                jz      short loc_403533
                lea     eax, [ebp+FindFileData.cFileName]
                mov     [esp+0Ch], eax
                lea     eax, [ebx+0Ch]
                mov     dword ptr [esp+8], offset aS_0 ; "%s"
                mov     dword ptr [esp+4], 104h
                mov     [esp], eax
                call    sub_402270
                mov     ecx, [ebp+FindFileData.dwFileAttributes]
                and     cl, 58h
                cmp     ecx, 10h
                mov     [ebx+6], ax
                mov     [ebx+8], ecx
                jbe     short loc_40352A
                mov     dword ptr [ebx+8], 18h

loc_40352A:                             ; CODE XREF: sub_4034C0+61\u2191j
                                        ; sub_4034C0+9B\u2193j ...
                lea     esp, [ebp-8]
                mov     eax, esi
                pop     ebx
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_403533:                             ; CODE XREF: sub_4034C0+27\u2191j
                call    _errno
                mov     ebx, eax
                call    GetLastError
                cmp     eax, 3
                mov     [ebx], eax
                jz      short loc_403570
                call    _errno
                cmp     dword ptr [eax], 10Bh
                jz      short loc_403580
                call    _errno
                cmp     dword ptr [eax], 2
                jz      short loc_40352A
                lea     esi, [esi+0]
                call    _errno
                mov     dword ptr [eax], 16h
                jmp     short loc_40352A
; ---------------------------------------------------------------------------
                align 10h

loc_403570:                             ; CODE XREF: sub_4034C0+84\u2191j
                call    _errno
                mov     dword ptr [eax], 2
                jmp     short loc_40352A
; ---------------------------------------------------------------------------
                align 10h

loc_403580:                             ; CODE XREF: sub_4034C0+91\u2191j
                call    _errno
                mov     dword ptr [eax], 14h
                jmp     short loc_40352A
sub_4034C0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


; int __cdecl sub_403590(char *)
sub_403590      proc near               ; CODE XREF: sub_402970+10D\u2191p

Buffer          = dword ptr -13Ch
Path            = dword ptr -138h
BufferCount     = dword ptr -134h
var_121         = byte ptr -121h
Src             = byte ptr -120h
arg_0           = dword ptr  4

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 12Ch
                mov     eax, [esp+13Ch+arg_0]
                test    eax, eax
                jz      loc_403710
                cmp     byte ptr [eax], 0
                jz      loc_4036F2
                lea     edi, [esp+13Ch+Src]
                mov     [esp+13Ch+BufferCount], 104h ; BufferCount
                mov     ebx, edi
                mov     [esp+13Ch+Path], eax ; Path
                mov     [esp+13Ch+Buffer], edi ; Buffer
                call    _fullpath
                cmp     [esp+13Ch+Src], 0
                jz      short loc_403630

loc_4035D3:                             ; CODE XREF: sub_403590+57\u2193j
                mov     edx, [ebx]
                add     ebx, 4
                lea     eax, [edx-1010101h]
                not     edx
                and     eax, edx
                and     eax, 80808080h
                jz      short loc_4035D3
                test    eax, 8080h
                jz      loc_4036D3
                add     al, al
                sbb     ebx, 3
                sub     ebx, edi
                movzx   eax, [esp+ebx+13Ch+var_121]
                cmp     al, 5Ch ; '\'
                jz      short loc_403654

loc_403604:                             ; CODE XREF: sub_403590+15D\u2193j
                cmp     al, 2Fh ; '/'
                jz      short loc_403654
                mov     ecx, 5Ch ; '\'
                mov     [edi+ebx], cx
                mov     ebx, edi

loc_403613:                             ; CODE XREF: sub_403590+97\u2193j
                mov     edx, [ebx]
                add     ebx, 4
                lea     eax, [edx-1010101h]
                not     edx
                and     eax, edx
                and     eax, 80808080h
                jz      short loc_403613
                jmp     short loc_403646
; ---------------------------------------------------------------------------
                align 10h

loc_403630:                             ; CODE XREF: sub_403590+41\u2191j
                                        ; sub_403590+B4\u2193j
                mov     edx, [ebx]
                add     ebx, 4
                lea     eax, [edx-1010101h]
                not     edx
                and     eax, edx
                and     eax, 80808080h
                jz      short loc_403630

loc_403646:                             ; CODE XREF: sub_403590+99\u2191j
                test    eax, 8080h
                jz      short loc_4036C8

loc_40364D:                             ; CODE XREF: sub_403590+13E\u2193j
                add     al, al
                sbb     ebx, 3
                sub     ebx, edi

loc_403654:                             ; CODE XREF: sub_403590+72\u2191j
                                        ; sub_403590+76\u2191j ...
                mov     edx, 2Ah ; '*'
                lea     eax, [ebx+11Dh]
                mov     [edi+ebx], dx
                mov     [esp+13Ch+Buffer], eax ; Size
                call    malloc
                test    eax, eax
                mov     esi, eax
                jz      loc_403701
                lea     ebp, [eax+118h]
                add     ebx, 2
                mov     [esp+13Ch+BufferCount], ebx ; Size
                mov     [esp+13Ch+Path], edi ; Src
                mov     [esp+13Ch+Buffer], ebp ; void *
                call    memcpy
                mov     edx, esi
                mov     eax, ebp
                call    sub_4034C0
                cmp     eax, 0FFFFFFFFh
                mov     [esi+110h], eax
                jz      short loc_40371F
                mov     eax, 110h
                mov     [esi+4], ax
                mov     eax, esi
                mov     dword ptr [esi+114h], 0
                mov     dword ptr [esi], 0

loc_4036BD:                             ; CODE XREF: sub_403590+16F\u2193j
                                        ; sub_403590+17E\u2193j ...
                add     esp, 12Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4036C8:                             ; CODE XREF: sub_403590+BB\u2191j
                shr     eax, 10h
                add     ebx, 2
                jmp     loc_40364D
; ---------------------------------------------------------------------------

loc_4036D3:                             ; CODE XREF: sub_403590+5E\u2191j
                shr     eax, 10h
                add     ebx, 2
                add     al, al
                sbb     ebx, 3
                sub     ebx, edi
                movzx   eax, [esp+ebx+13Ch+var_121]
                cmp     al, 5Ch ; '\'
                jz      loc_403654
                jmp     loc_403604
; ---------------------------------------------------------------------------

loc_4036F2:                             ; CODE XREF: sub_403590+1C\u2191j
                call    _errno
                mov     dword ptr [eax], 2
                xor     eax, eax
                jmp     short loc_4036BD
; ---------------------------------------------------------------------------

loc_403701:                             ; CODE XREF: sub_403590+DF\u2191j
                call    _errno
                mov     dword ptr [eax], 0Ch
                xor     eax, eax
                jmp     short loc_4036BD
; ---------------------------------------------------------------------------

loc_403710:                             ; CODE XREF: sub_403590+13\u2191j
                call    _errno
                mov     dword ptr [eax], 16h
                xor     eax, eax
                jmp     short loc_4036BD
; ---------------------------------------------------------------------------

loc_40371F:                             ; CODE XREF: sub_403590+110\u2191j
                mov     [esp+13Ch+Buffer], esi ; Block
                call    free
                xor     eax, eax
                jmp     short loc_4036BD
sub_403590      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_403730      proc near               ; CODE XREF: sub_402970+14E\u2191p

arg_0           = dword ptr  4

                push    ebx
                sub     esp, 8
                mov     ebx, [esp+0Ch+arg_0]
                test    ebx, ebx
                jz      short loc_403767
                mov     eax, [ebx+114h]
                lea     edx, [eax+1]
                test    eax, eax
                mov     [ebx+114h], edx
                jle     short loc_403760
                mov     eax, [ebx+110h]
                mov     edx, ebx
                call    sub_403420
                test    eax, eax
                jz      short loc_403762

loc_403760:                             ; CODE XREF: sub_403730+1D\u2191j
                mov     eax, ebx

loc_403762:                             ; CODE XREF: sub_403730+2E\u2191j
                                        ; sub_403730+44\u2193j
                add     esp, 8
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_403767:                             ; CODE XREF: sub_403730+A\u2191j
                call    _errno
                mov     dword ptr [eax], 9
                xor     eax, eax
                jmp     short loc_403762
sub_403730      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403780(void *Block)
sub_403780      proc near               ; CODE XREF: sub_402970+34B\u2191p

var_4           = dword ptr -4
Block           = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    ebx
                sub     esp, 14h
                mov     ebx, [ebp+Block]
                test    ebx, ebx
                jz      short loc_4037B2
                mov     eax, [ebx+110h]
                mov     [esp], eax      ; hFindFile
                call    FindClose
                sub     esp, 4
                test    eax, eax
                jz      short loc_4037B2
                mov     [esp], ebx      ; Block
                call    free
                xor     eax, eax

loc_4037AD:                             ; CODE XREF: sub_403780+42\u2193j
                mov     ebx, [ebp+var_4]
                leave
                retn
; ---------------------------------------------------------------------------

loc_4037B2:                             ; CODE XREF: sub_403780+C\u2191j
                                        ; sub_403780+21\u2191j
                call    _errno
                mov     dword ptr [eax], 9
                mov     eax, 0FFFFFFFFh
                jmp     short loc_4037AD
sub_403780      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_4037D0      proc near               ; CODE XREF: .text:00403874\u2193p

var_4           = dword ptr -4
arg_0           = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    ebx
                sub     esp, 14h
                mov     ebx, [ebp+arg_0]
                test    ebx, ebx
                jz      short loc_4037F3
                mov     eax, [ebx+110h]
                mov     [esp], eax      ; hFindFile
                call    FindClose
                sub     esp, 4
                test    eax, eax
                jnz     short loc_403803

loc_4037F3:                             ; CODE XREF: sub_4037D0+C\u2191j
                call    _errno
                mov     dword ptr [eax], 9

loc_4037FE:                             ; CODE XREF: sub_4037D0+49\u2193j
                mov     ebx, [ebp+var_4]
                leave
                retn
; ---------------------------------------------------------------------------

loc_403803:                             ; CODE XREF: sub_4037D0+21\u2191j
                lea     eax, [ebx+118h]
                mov     edx, ebx
                call    sub_4034C0
                cmp     eax, 0FFFFFFFFh
                mov     [ebx+110h], eax
                jz      short loc_4037FE
                mov     dword ptr [ebx+114h], 0
                mov     ebx, [ebp+var_4]
                leave
                retn
sub_4037D0      endp

; ---------------------------------------------------------------------------
                align 10h
                sub     esp, 0Ch
                mov     eax, [esp+10h]
                test    eax, eax
                jz      short loc_403845
                mov     eax, [eax+114h]

loc_403841:                             ; CODE XREF: .text:00403855\u2193j
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------

loc_403845:                             ; CODE XREF: .text:00403839\u2191j
                call    _errno
                mov     dword ptr [eax], 9
                mov     eax, 0FFFFFFFFh
                jmp     short loc_403841
; ---------------------------------------------------------------------------
                align 10h
                push    esi
                push    ebx
                sub     esp, 14h
                mov     esi, [esp+24h]
                mov     ebx, [esp+20h]
                test    esi, esi
                js      short loc_4038B2
                mov     [esp], ebx
                call    sub_4037D0
                test    esi, esi
                jz      short loc_4038AC
                cmp     dword ptr [ebx+110h], 0FFFFFFFFh
                jnz     short loc_403899
                jmp     short loc_4038AC
; ---------------------------------------------------------------------------

loc_403888:                             ; CODE XREF: .text:004038AA\u2193j
                mov     eax, [ebx+110h]
                mov     edx, ebx
                call    sub_403420
                test    eax, eax
                jz      short loc_4038AC

loc_403899:                             ; CODE XREF: .text:00403884\u2191j
                mov     eax, [ebx+114h]
                add     eax, 1
                cmp     esi, eax
                mov     [ebx+114h], eax
                jg      short loc_403888

loc_4038AC:                             ; CODE XREF: .text:0040387B\u2191j
                                        ; .text:00403886\u2191j ...
                add     esp, 14h
                pop     ebx
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_4038B2:                             ; CODE XREF: .text:0040386F\u2191j
                call    _errno
                mov     dword ptr [eax], 16h
                add     esp, 14h
                pop     ebx
                pop     esi
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_4038D0      proc near               ; CODE XREF: sub_404590+51\u2193p
                                        ; sub_404640+53\u2193p ...

var_4C          = dword ptr -4Ch
var_48          = dword ptr -48h
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = tbyte ptr -2Ch
var_20          = dword ptr -20h
var_14          = dword ptr -14h
var_10          = byte ptr -10h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
arg_18          = dword ptr  1Ch

                push    ebx
                mov     ecx, eax
                sub     esp, 48h
                mov     eax, [esp+4Ch+arg_0]
                mov     dword ptr [esp+4Ch+var_2C], eax
                mov     eax, [esp+4Ch+arg_4]
                mov     dword ptr [esp+4Ch+var_2C+4], eax
                mov     eax, [esp+4Ch+arg_8]
                mov     dword ptr [esp+4Ch+var_2C+8], eax
                mov     eax, [esp+4Ch+arg_C]
                fld     [esp+4Ch+var_2C]
                mov     [esp+4Ch+var_20], eax
                fxam
                fstsw   ax
                fstp    st
                test    ah, 1
                jz      short loc_403920
                test    ah, 4
                jz      loc_4039A0
                mov     [esp+4Ch+var_14], 3
                movzx   edx, word ptr [esp+4Ch+var_2C+8]
                xor     eax, eax
                jmp     short loc_403934
; ---------------------------------------------------------------------------

loc_403920:                             ; CODE XREF: sub_4038D0+34\u2191j
                test    ah, 4
                jnz     short loc_403981
                movzx   edx, word ptr [esp+4Ch+var_2C+8]
                xor     eax, eax
                mov     [esp+4Ch+var_14], 0

loc_403934:                             ; CODE XREF: sub_4038D0+4E\u2191j
                                        ; sub_4038D0+C8\u2193j ...
                and     edx, 8000h

loc_40393A:                             ; CODE XREF: sub_4038D0+DC\u2193j
                mov     ebx, [esp+4Ch+arg_18]
                mov     [ebx], edx
                lea     edx, [esp+4Ch+var_10]
                mov     [esp+4Ch+var_30], edx
                mov     edx, [esp+4Ch+arg_14]
                mov     [esp+4Ch+var_3C], ecx
                mov     [esp+4Ch+var_48], eax
                mov     [esp+4Ch+var_4C], offset dword_409018
                mov     [esp+4Ch+var_34], edx
                mov     edx, [esp+4Ch+arg_10]
                mov     [esp+4Ch+var_38], edx
                lea     edx, [esp+4Ch+var_14]
                mov     [esp+4Ch+var_40], edx
                lea     edx, [esp+4Ch+var_2C]
                mov     [esp+4Ch+var_44], edx
                call    sub_405E60
                add     esp, 48h
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_403981:                             ; CODE XREF: sub_4038D0+53\u2191j
                test    ah, 40h
                jz      short loc_4039B0
                mov     [esp+4Ch+var_14], 2
                movzx   edx, word ptr [esp+4Ch+var_2C+8]
                mov     eax, 0FFFFBFC3h
                jmp     short loc_403934
; ---------------------------------------------------------------------------
                align 10h

loc_4039A0:                             ; CODE XREF: sub_4038D0+39\u2191j
                mov     [esp+4Ch+var_14], 4
                xor     eax, eax
                xor     edx, edx
                jmp     short loc_40393A
; ---------------------------------------------------------------------------
                align 10h

loc_4039B0:                             ; CODE XREF: sub_4038D0+B4\u2191j
                movzx   edx, word ptr [esp+4Ch+var_2C+8]
                mov     [esp+4Ch+var_14], 1
                mov     eax, edx
                and     eax, 7FFFh
                sub     eax, 403Eh
                jmp     loc_403934
sub_4038D0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_4039D0      proc near               ; CODE XREF: sub_403A30+9C\u2193p
                                        ; sub_403A30+B7\u2193p ...

Character       = dword ptr -1Ch
Stream          = dword ptr -18h
var_10          = dword ptr -10h

                push    ebx
                sub     esp, 18h
                mov     ecx, [edx+4]
                test    ch, 20h
                jnz     short loc_4039E4
                mov     ebx, [edx+18h]
                cmp     [edx+1Ch], ebx
                jle     short loc_4039F4

loc_4039E4:                             ; CODE XREF: sub_4039D0+A\u2191j
                and     ch, 10h
                jnz     short loc_403A00
                mov     ebx, [edx]
                mov     ecx, [edx+18h]
                mov     [ebx+ecx], al
                mov     ebx, [edx+18h]

loc_4039F4:                             ; CODE XREF: sub_4039D0+12\u2191j
                add     ebx, 1
                mov     [edx+18h], ebx
                add     esp, 18h
                pop     ebx
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_403A00:                             ; CODE XREF: sub_4039D0+17\u2191j
                mov     ecx, [edx]
                mov     [esp+1Ch+Character], eax ; Character
                mov     [esp+1Ch+var_10], edx
                mov     [esp+1Ch+Stream], ecx ; Stream
                call    fputc
                mov     edx, [esp+1Ch+var_10]
                mov     ebx, [edx+18h]
                add     ebx, 1
                mov     [edx+18h], ebx
                add     esp, 18h
                pop     ebx
                retn
sub_4039D0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=28h

sub_403A30      proc near               ; CODE XREF: sub_404E70+527\u2193p
                                        ; sub_404E70+6D0\u2193p

MultiByteStr    = byte ptr -28h

                push    ebp
                push    edi
                push    esi
                mov     esi, edx
                push    ebx
                mov     ebx, ecx
                sub     esp, 4Ch
                mov     [esp+18h], eax
                lea     ebp, [esp+58h+MultiByteStr]
                lea     eax, [esp+2Ch]
                mov     [esp+8], eax
                mov     dword ptr [esp+4], 0 ; int
                mov     [esp], ebp      ; lpMultiByteStr
                call    sub_405C90
                mov     eax, [ebx+0Ch]
                test    eax, eax
                js      short loc_403A6A
                cmp     esi, eax
                jg      loc_403B31

loc_403A6A:                             ; CODE XREF: sub_403A30+30\u2191j
                                        ; sub_403A30+103\u2193j
                mov     eax, [ebx+8]
                cmp     esi, eax
                jge     loc_403B01
                sub     eax, esi
                test    eax, eax
                mov     [ebx+8], eax
                jle     short loc_403A88
                test    byte ptr [ebx+5], 4
                jz      loc_403B0D

loc_403A88:                             ; CODE XREF: sub_403A30+4C\u2191j
                                        ; sub_403A30+D8\u2193j ...
                mov     [esp+1Ch], esi
                lea     esi, [esi+0]

loc_403A90:                             ; CODE XREF: sub_403A30+AA\u2193j
                mov     eax, [esp+1Ch]
                test    eax, eax
                jle     short loc_403AEC
                add     dword ptr [esp+18h], 2
                lea     eax, [esp+2Ch]
                mov     [esp+8], eax
                mov     eax, [esp+18h]
                movzx   eax, word ptr [eax-2]
                mov     [esp], ebp      ; lpMultiByteStr
                mov     [esp+4], eax    ; int
                call    sub_405C90
                test    eax, eax
                jle     short loc_403AEC
                lea     esi, [ebp+eax+28h+MultiByteStr]
                mov     edi, ebp

loc_403AC3:                             ; CODE XREF: sub_403A30+A3\u2193j
                add     edi, 1
                movsx   eax, byte ptr [edi-1]
                mov     edx, ebx
                call    sub_4039D0
                cmp     edi, esi
                jnz     short loc_403AC3
                sub     dword ptr [esp+1Ch], 1
                jmp     short loc_403A90
; ---------------------------------------------------------------------------
                align 10h

loc_403AE0:                             ; CODE XREF: sub_403A30+C7\u2193j
                mov     edx, ebx
                mov     eax, 20h ; ' '
                call    sub_4039D0

loc_403AEC:                             ; CODE XREF: sub_403A30+66\u2191j
                                        ; sub_403A30+8B\u2191j
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jg      short loc_403AE0
                add     esp, 4Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_403B01:                             ; CODE XREF: sub_403A30+3F\u2191j
                mov     dword ptr [ebx+8], 0FFFFFFFFh
                jmp     loc_403A88
; ---------------------------------------------------------------------------

loc_403B0D:                             ; CODE XREF: sub_403A30+52\u2191j
                sub     eax, 1
                mov     [ebx+8], eax

loc_403B13:                             ; CODE XREF: sub_403A30+FA\u2193j
                mov     edx, ebx
                mov     eax, 20h ; ' '
                call    sub_4039D0
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jnz     short loc_403B13
                jmp     loc_403A88
; ---------------------------------------------------------------------------

loc_403B31:                             ; CODE XREF: sub_403A30+34\u2191j
                mov     esi, eax
                jmp     loc_403A6A
sub_403A30      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_403B40      proc near               ; CODE XREF: sub_403BF0+40\u2193p
                                        ; sub_404E70+1C6\u2193p ...
                push    edi
                mov     edi, eax
                mov     eax, [ecx+0Ch]
                push    esi
                mov     esi, edx
                push    ebx
                mov     ebx, ecx
                test    eax, eax
                js      short loc_403B58
                cmp     edx, eax
                jg      loc_403BE0

loc_403B58:                             ; CODE XREF: sub_403B40+E\u2191j
                                        ; sub_403B40+A2\u2193j
                mov     eax, [ebx+8]
                cmp     esi, eax
                jge     short loc_403BD0
                sub     eax, esi
                test    eax, eax
                mov     [ebx+8], eax
                jle     short loc_403B8D
                test    byte ptr [ebx+5], 4
                jnz     short loc_403B8D
                sub     eax, 1
                mov     [ebx+8], eax

loc_403B74:                             ; CODE XREF: sub_403B40+4B\u2193j
                mov     edx, ebx
                mov     eax, 20h ; ' '
                call    sub_4039D0
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jnz     short loc_403B74

loc_403B8D:                             ; CODE XREF: sub_403B40+26\u2191j
                                        ; sub_403B40+2C\u2191j ...
                test    esi, esi
                jz      short loc_403BBD

loc_403B91:                             ; CODE XREF: sub_403B40+62\u2193j
                add     edi, 1
                movsx   eax, byte ptr [edi-1]
                mov     edx, ebx
                call    sub_4039D0
                sub     esi, 1
                jnz     short loc_403B91
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jle     short loc_403BCA

loc_403BB1:                             ; CODE XREF: sub_403B40+88\u2193j
                mov     edx, ebx
                mov     eax, 20h ; ' '
                call    sub_4039D0

loc_403BBD:                             ; CODE XREF: sub_403B40+4F\u2191j
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jg      short loc_403BB1

loc_403BCA:                             ; CODE XREF: sub_403B40+6F\u2191j
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_403BD0:                             ; CODE XREF: sub_403B40+1D\u2191j
                mov     dword ptr [ebx+8], 0FFFFFFFFh
                jmp     short loc_403B8D
; ---------------------------------------------------------------------------
                align 10h

loc_403BE0:                             ; CODE XREF: sub_403B40+12\u2191j
                mov     esi, eax
                jmp     loc_403B58
sub_403B40      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_403BF0      proc near               ; CODE XREF: sub_404590+98\u2193p
                                        ; sub_404640+C9\u2193p ...

var_20          = byte ptr -20h
var_1F          = byte ptr -1Fh

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 1Ch
                test    eax, eax
                mov     dword ptr [ecx+0Ch], 0FFFFFFFFh
                jz      short loc_403C40
                mov     ebp, [ecx+4]
                lea     edi, [esp+2Ch+var_1F]
                mov     [esp+2Ch+var_20], 2Dh ; '-'
                lea     eax, [esp+2Ch+var_20]

loc_403C12:                             ; CODE XREF: sub_403BF0+68\u2193j
                                        ; sub_403BF0+85\u2193j ...
                and     ebp, 20h
                xor     esi, esi

loc_403C17:                             ; CODE XREF: sub_403BF0+39\u2193j
                movzx   ebx, byte ptr [edx+esi]
                and     ebx, 0FFFFFFDFh
                or      ebx, ebp
                mov     [edi+esi], bl
                add     esi, 1
                cmp     esi, 3
                jnz     short loc_403C17
                lea     edx, [edi+3]
                sub     edx, eax
                call    sub_403B40
                add     esp, 1Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_403C40:                             ; CODE XREF: sub_403BF0+10\u2191j
                mov     ebp, [ecx+4]
                test    ebp, 100h
                jz      short loc_403C60
                mov     [esp+2Ch+var_20], 2Bh ; '+'
                lea     edi, [esp+2Ch+var_1F]
                lea     eax, [esp+2Ch+var_20]
                jmp     short loc_403C12
; ---------------------------------------------------------------------------
                align 10h

loc_403C60:                             ; CODE XREF: sub_403BF0+59\u2191j
                test    ebp, 40h
                jz      short loc_403C77
                mov     [esp+2Ch+var_20], 20h ; ' '
                lea     edi, [esp+2Ch+var_1F]
                lea     eax, [esp+2Ch+var_20]
                jmp     short loc_403C12
; ---------------------------------------------------------------------------

loc_403C77:                             ; CODE XREF: sub_403BF0+76\u2191j
                lea     eax, [esp+2Ch+var_20]
                mov     edi, eax
                jmp     short loc_403C12
sub_403BF0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_403C80      proc near               ; CODE XREF: sub_4044C0+B1\u2193p
                                        ; sub_4048A0+47D\u2193p ...

var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_1C          = dword ptr -1Ch

                push    ebp
                mov     ebp, esp
                push    edi
                mov     edi, edx
                push    esi
                mov     esi, eax
                push    ebx
                mov     ebx, ecx
                sub     esp, 2Ch
                mov     [ebp+var_24], edx
                mov     edx, [ecx+0Ch]
                mov     [ebp+var_28], eax
                mov     ecx, [ecx+8]
                mov     eax, edx
                sar     eax, 1Fh
                not     eax
                and     eax, edx
                add     eax, 17h
                cmp     eax, ecx
                jge     short loc_403CAD
                mov     eax, ecx

loc_403CAD:                             ; CODE XREF: sub_403C80+29\u2191j
                add     eax, 0Fh
                and     eax, 0FFFFFFF0h
                call    sub_402240
                sub     esp, eax
                lea     eax, [esp+10h]
                mov     [ebp+var_1C], eax
                mov     eax, [ebx+4]
                test    al, 80h
                jz      short loc_403CD5
                test    edi, edi
                js      loc_403E80
                and     al, 7Fh
                mov     [ebx+4], eax

loc_403CD5:                             ; CODE XREF: sub_403C80+46\u2191j
                                        ; sub_403C80+20D\u2193j
                mov     ecx, [ebp+var_24]
                mov     edi, [ebp+var_28]
                mov     esi, [ebp+var_1C]
                mov     eax, ecx
                or      eax, edi
                jz      short loc_403D41
                mov     [ebp+var_28], ebx
                mov     ebx, ecx
                lea     esi, [esi+0]

loc_403CF0:                             ; CODE XREF: sub_403C80+B9\u2193j
                mov     [esp], edi
                add     esi, 1
                mov     [esp+4], ebx
                mov     dword ptr [esp+8], 0Ah
                mov     dword ptr [esp+0Ch], 0
                call    sub_408560
                add     eax, 30h ; '0'
                mov     [esi-1], al
                mov     [esp], edi
                mov     [esp+4], ebx
                mov     dword ptr [esp+8], 0Ah
                mov     dword ptr [esp+0Ch], 0
                call    sub_408450
                mov     edi, eax
                mov     eax, edx
                or      eax, edi
                mov     ebx, edx
                jnz     short loc_403CF0
                mov     ebx, [ebp+var_28]
                mov     edx, [ebx+0Ch]

loc_403D41:                             ; CODE XREF: sub_403C80+62\u2191j
                test    edx, edx
                mov     edi, esi
                jle     short loc_403D60
                mov     eax, [ebp+var_1C]
                sub     eax, esi
                add     edx, eax
                test    edx, edx
                jle     short loc_403D60
                lea     edi, [esi+edx]

loc_403D55:                             ; CODE XREF: sub_403C80+DE\u2193j
                add     esi, 1
                cmp     esi, edi
                mov     byte ptr [esi-1], 30h ; '0'
                jnz     short loc_403D55

loc_403D60:                             ; CODE XREF: sub_403C80+C5\u2191j
                                        ; sub_403C80+D0\u2191j
                cmp     edi, [ebp+var_1C]
                jz      loc_403E92

loc_403D69:                             ; CODE XREF: sub_403C80+217\u2193j
                                        ; sub_403C80+223\u2193j
                mov     eax, [ebx+8]
                test    eax, eax
                jle     short loc_403DC9
                mov     edx, [ebp+var_1C]
                sub     edx, edi
                add     edx, eax
                mov     eax, [ebx+4]
                test    edx, edx
                mov     [ebx+8], edx
                jle     short loc_403DCC
                test    eax, 1C0h
                jz      short loc_403D8E
                sub     edx, 1
                mov     [ebx+8], edx

loc_403D8E:                             ; CODE XREF: sub_403C80+106\u2191j
                mov     edx, [ebx+0Ch]
                test    edx, edx
                js      loc_403E40

loc_403D99:                             ; CODE XREF: sub_403C80+1CE\u2193j
                test    ah, 4
                jnz     short loc_403DCC
                mov     edx, [ebx+8]
                lea     ecx, [edx-1]
                test    edx, edx
                mov     [ebx+8], ecx
                jle     short loc_403DCC
                nop
                lea     esi, [esi+0]

loc_403DB0:                             ; CODE XREF: sub_403C80+147\u2193j
                mov     edx, ebx
                mov     eax, 20h ; ' '
                call    sub_4039D0
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jg      short loc_403DB0

loc_403DC9:                             ; CODE XREF: sub_403C80+EE\u2191j
                                        ; sub_403C80+1F9\u2193j
                mov     eax, [ebx+4]

loc_403DCC:                             ; CODE XREF: sub_403C80+FF\u2191j
                                        ; sub_403C80+11C\u2191j ...
                test    al, 80h
                jz      short loc_403E21
                lea     esi, [edi+1]
                mov     byte ptr [edi], 2Dh ; '-'

loc_403DD6:                             ; CODE XREF: sub_403C80+1AC\u2193j
                                        ; sub_403C80+1B4\u2193j ...
                cmp     [ebp+var_1C], esi
                mov     edi, [ebp+var_1C]
                jnb     short loc_403E0C
                xchg    ax, ax

loc_403DE0:                             ; CODE XREF: sub_403C80+16F\u2193j
                sub     esi, 1
                movsx   eax, byte ptr [esi]
                mov     edx, ebx
                call    sub_4039D0
                cmp     esi, edi
                jnz     short loc_403DE0
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jle     short loc_403E19
                xchg    ax, ax

loc_403E00:                             ; CODE XREF: sub_403C80+197\u2193j
                mov     edx, ebx
                mov     eax, 20h ; ' '
                call    sub_4039D0

loc_403E0C:                             ; CODE XREF: sub_403C80+15C\u2191j
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jg      short loc_403E00

loc_403E19:                             ; CODE XREF: sub_403C80+17C\u2191j
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_403E21:                             ; CODE XREF: sub_403C80+14E\u2191j
                test    ah, 1
                jz      short loc_403E30
                lea     esi, [edi+1]
                mov     byte ptr [edi], 2Bh ; '+'
                jmp     short loc_403DD6
; ---------------------------------------------------------------------------
                align 10h

loc_403E30:                             ; CODE XREF: sub_403C80+1A4\u2191j
                test    al, 40h
                mov     esi, edi
                jz      short loc_403DD6
                add     esi, 1
                mov     byte ptr [edi], 20h ; ' '
                jmp     short loc_403DD6
; ---------------------------------------------------------------------------
                align 10h

loc_403E40:                             ; CODE XREF: sub_403C80+113\u2191j
                mov     edx, eax
                and     edx, 600h
                cmp     edx, 200h
                jnz     loc_403D99
                mov     edx, [ebx+8]
                lea     ecx, [edx-1]
                test    edx, edx
                mov     [ebx+8], ecx
                jle     loc_403DCC

loc_403E65:                             ; CODE XREF: sub_403C80+1F7\u2193j
                add     edi, 1
                mov     byte ptr [edi-1], 30h ; '0'
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jg      short loc_403E65
                jmp     loc_403DC9
; ---------------------------------------------------------------------------
                align 10h

loc_403E80:                             ; CODE XREF: sub_403C80+4A\u2191j
                neg     esi
                adc     edi, 0
                neg     edi
                mov     [ebp+var_28], esi
                mov     [ebp+var_24], edi
                jmp     loc_403CD5
; ---------------------------------------------------------------------------

loc_403E92:                             ; CODE XREF: sub_403C80+E3\u2191j
                mov     ecx, [ebx+0Ch]
                test    ecx, ecx
                jz      loc_403D69
                mov     byte ptr [edi], 30h ; '0'
                add     edi, 1
                jmp     loc_403D69
sub_403C80      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_403EB0      proc near               ; CODE XREF: sub_404E70+2D2\u2193p
                                        ; sub_404E70+36A\u2193p

var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
arg_0           = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    edi
                mov     edi, ecx
                push    esi
                mov     esi, edx
                push    ebx
                sub     esp, 2Ch
                mov     [ebp+var_24], edx
                xor     edx, edx
                cmp     eax, 6Fh ; 'o'
                setz    dl
                sub     edx, 1
                and     edx, 0FFFFFFFAh
                mov     [ebp+var_2C], ecx
                xor     ecx, ecx
                cmp     eax, 6Fh ; 'o'
                setnz   cl
                mov     [ebp+var_28], eax
                mov     eax, ecx
                mov     [ebp+var_1C], eax
                mov     eax, [ebp+arg_0]
                lea     ebx, ds:7[ecx*8]
                mov     [ebp+var_30], ebx
                mov     ecx, [ebp+arg_0]
                add     [ebp+var_1C], 3
                mov     ebx, [eax+0Ch]
                mov     ecx, [ecx+8]
                mov     eax, ebx
                sar     eax, 1Fh
                not     eax
                and     eax, ebx
                lea     eax, [edx+eax+18h]
                cmp     eax, ecx
                jge     short loc_403F0E
                mov     eax, ecx

loc_403F0E:                             ; CODE XREF: sub_403EB0+5A\u2191j
                add     eax, 0Fh
                and     eax, 0FFFFFFF0h
                call    sub_402240
                sub     esp, eax
                mov     eax, [ebp+var_2C]
                or      eax, [ebp+var_24]
                mov     [ebp+var_20], esp
                jz      loc_404174
                movzx   ecx, byte ptr [ebp+var_28]
                mov     eax, esp
                movzx   ebx, byte ptr [ebp+var_30]
                and     ecx, 20h
                mov     byte ptr [ebp+var_24], cl
                jmp     short loc_403F5B
; ---------------------------------------------------------------------------
                align 10h

loc_403F40:                             ; CODE XREF: sub_403EB0+B8\u2193j
                mov     [eax-1], cl

loc_403F43:                             ; CODE XREF: sub_403EB0+C3\u2193j
                movzx   ecx, byte ptr [ebp+var_1C]
                shrd    esi, edi, cl
                shr     edi, cl
                test    cl, 20h
                jz      short loc_403F55
                mov     esi, edi
                xor     edi, edi

loc_403F55:                             ; CODE XREF: sub_403EB0+9F\u2191j
                mov     ecx, edi
                or      ecx, esi
                jz      short loc_403F75

loc_403F5B:                             ; CODE XREF: sub_403EB0+8A\u2191j
                mov     edx, esi
                add     eax, 1
                and     edx, ebx
                lea     ecx, [edx+30h]
                cmp     cl, 39h ; '9'
                jle     short loc_403F40
                add     edx, 37h ; '7'
                or      dl, byte ptr [ebp+var_24]
                mov     [eax-1], dl
                jmp     short loc_403F43
; ---------------------------------------------------------------------------

loc_403F75:                             ; CODE XREF: sub_403EB0+A9\u2191j
                cmp     [ebp+var_20], eax
                jz      loc_40416E
                mov     edi, [ebp+arg_0]
                mov     ebx, [edi+0Ch]

loc_403F84:                             ; CODE XREF: sub_403EB0+2D1\u2193j
                test    ebx, ebx
                jle     loc_404131
                mov     ecx, [ebp+var_20]
                sub     ecx, eax
                add     ebx, ecx
                test    ebx, ebx
                jle     loc_404131
                lea     edi, [eax+ebx]
                xchg    ax, ax

loc_403FA0:                             ; CODE XREF: sub_403EB0+F9\u2193j
                add     eax, 1
                cmp     eax, edi
                mov     byte ptr [eax-1], 30h ; '0'
                jnz     short loc_403FA0

loc_403FAB:                             ; CODE XREF: sub_403EB0+287\u2193j
                                        ; sub_403EB0+294\u2193j ...
                cmp     edi, [ebp+var_20]
                jz      loc_404155

loc_403FB4:                             ; CODE XREF: sub_403EB0+2AD\u2193j
                                        ; sub_403EB0+2B9\u2193j
                mov     eax, [ebp+arg_0]
                mov     esi, [eax+8]
                mov     eax, edi
                sub     eax, [ebp+var_20]
                cmp     esi, eax
                jle     loc_404070
                sub     esi, eax
                mov     eax, [ebp+arg_0]
                test    esi, esi
                mov     [eax+8], esi
                jle     short loc_403FF4
                cmp     [ebp+var_28], 6Fh ; 'o'
                jz      short loc_403FE6
                mov     eax, [ebp+arg_0]
                test    byte ptr [eax+5], 8
                jnz     loc_4040E6

loc_403FE6:                             ; CODE XREF: sub_403EB0+127\u2191j
                mov     eax, [ebp+arg_0]
                mov     ebx, [eax+0Ch]
                test    ebx, ebx
                js      loc_4040FD

loc_403FF4:                             ; CODE XREF: sub_403EB0+121\u2191j
                                        ; sub_403EB0+247\u2193j ...
                lea     eax, [esi-1]
                mov     [ebp+var_1C], eax

loc_403FFA:                             ; CODE XREF: sub_403EB0+1D6\u2193j
                                        ; sub_403EB0+27C\u2193j
                mov     eax, [ebp+var_1C]
                cmp     [ebp+var_28], 6Fh ; 'o'
                mov     ebx, eax
                jz      short loc_404012
                mov     eax, [ebp+arg_0]
                test    byte ptr [eax+5], 8
                jnz     loc_4040D0

loc_404012:                             ; CODE XREF: sub_403EB0+153\u2191j
                                        ; sub_403EB0+231\u2193j
                test    esi, esi
                jle     short loc_40401F
                mov     eax, [ebp+arg_0]
                test    byte ptr [eax+5], 4
                jz      short loc_404090

loc_40401F:                             ; CODE XREF: sub_403EB0+164\u2191j
                                        ; sub_403EB0+20F\u2193j
                cmp     edi, [ebp+var_20]
                jbe     short loc_404049
                mov     [ebp+var_1C], esi
                mov     esi, [ebp+var_20]
                mov     [ebp+var_20], ebx
                mov     ebx, edi
                mov     edi, [ebp+arg_0]

loc_404032:                             ; CODE XREF: sub_403EB0+191\u2193j
                sub     ebx, 1
                movsx   eax, byte ptr [ebx]
                mov     edx, edi
                call    sub_4039D0
                cmp     ebx, esi
                jnz     short loc_404032
                mov     esi, [ebp+var_1C]
                mov     ebx, [ebp+var_20]

loc_404049:                             ; CODE XREF: sub_403EB0+172\u2191j
                test    esi, esi
                jle     short loc_404066
                mov     esi, [ebp+arg_0]

loc_404050:                             ; CODE XREF: sub_403EB0+1B4\u2193j
                mov     eax, 20h ; ' '
                sub     ebx, 1
                mov     edx, esi
                call    sub_4039D0
                lea     eax, [ebx+1]
                test    eax, eax
                jg      short loc_404050

loc_404066:                             ; CODE XREF: sub_403EB0+19B\u2191j
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_404070:                             ; CODE XREF: sub_403EB0+111\u2191j
                mov     eax, [ebp+arg_0]
                mov     esi, 0FFFFFFFFh
                mov     [ebp+var_1C], 0FFFFFFFEh
                mov     dword ptr [eax+8], 0FFFFFFFFh
                jmp     loc_403FFA
; ---------------------------------------------------------------------------
                align 10h

loc_404090:                             ; CODE XREF: sub_403EB0+16D\u2191j
                mov     ebx, [ebp+var_1C]
                mov     esi, eax

loc_404095:                             ; CODE XREF: sub_403EB0+1F9\u2193j
                mov     eax, 20h ; ' '
                sub     ebx, 1
                mov     edx, esi
                call    sub_4039D0
                lea     eax, [ebx+1]
                test    eax, eax
                jg      short loc_404095
                mov     ecx, [ebp+var_1C]
                mov     eax, ecx
                sar     eax, 1Fh
                not     eax
                lea     esi, [ecx-1]
                and     eax, ecx
                sub     esi, eax
                lea     ebx, [esi-1]
                jmp     loc_40401F
; ---------------------------------------------------------------------------

loc_4040C4:                             ; CODE XREF: sub_403EB0+23B\u2193j
                sub     esi, 3
                mov     [ebp+var_1C], esi
                mov     esi, eax
                lea     esi, [esi+0]

loc_4040D0:                             ; CODE XREF: sub_403EB0+15C\u2191j
                movzx   eax, byte ptr [ebp+var_28]
                add     edi, 2
                mov     byte ptr [edi-1], 30h ; '0'
                mov     ebx, [ebp+var_1C]
                mov     [edi-2], al
                jmp     loc_404012
; ---------------------------------------------------------------------------

loc_4040E6:                             ; CODE XREF: sub_403EB0+130\u2191j
                lea     eax, [esi-2]
                test    eax, eax
                jle     short loc_4040C4
                mov     esi, eax
                mov     eax, [ebp+arg_0]
                mov     ebx, [eax+0Ch]
                test    ebx, ebx
                jns     loc_403FF4

loc_4040FD:                             ; CODE XREF: sub_403EB0+13E\u2191j
                mov     eax, [ebp+arg_0]
                mov     eax, [eax+4]
                and     eax, 600h
                cmp     eax, 200h
                jnz     loc_403FF4
                add     esi, edi

loc_404115:                             ; CODE XREF: sub_403EB0+26E\u2193j
                add     edi, 1
                cmp     edi, esi
                mov     byte ptr [edi-1], 30h ; '0'
                jnz     short loc_404115
                mov     [ebp+var_1C], 0FFFFFFFEh
                mov     esi, 0FFFFFFFFh
                jmp     loc_403FFA
; ---------------------------------------------------------------------------

loc_404131:                             ; CODE XREF: sub_403EB0+D6\u2191j
                                        ; sub_403EB0+E5\u2191j
                cmp     [ebp+var_28], 6Fh ; 'o'
                mov     edi, eax
                jnz     loc_403FAB
                mov     esi, [ebp+arg_0]
                test    byte ptr [esi+5], 8
                jz      loc_403FAB
                add     edi, 1
                mov     byte ptr [eax], 30h ; '0'
                jmp     loc_403FAB
; ---------------------------------------------------------------------------

loc_404155:                             ; CODE XREF: sub_403EB0+FE\u2191j
                mov     eax, [ebp+arg_0]
                mov     esi, [eax+0Ch]
                test    esi, esi
                jz      loc_403FB4
                mov     byte ptr [edi], 30h ; '0'
                add     edi, 1
                jmp     loc_403FB4
; ---------------------------------------------------------------------------

loc_40416E:                             ; CODE XREF: sub_403EB0+C8\u2191j
                mov     eax, [ebp+arg_0]
                mov     ebx, [eax+0Ch]

loc_404174:                             ; CODE XREF: sub_403EB0+74\u2191j
                mov     eax, [ebp+arg_0]
                and     dword ptr [eax+4], 0FFFFF7FFh
                mov     eax, [ebp+var_20]
                jmp     loc_403F84
sub_403EB0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_404190      proc near               ; CODE XREF: sub_4044C0+7E\u2193p
                                        ; sub_404640+6F\u2193p ...

MultiByteStr    = byte ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
WideCharStr     = word ptr -1Eh
var_1C          = dword ptr -1Ch
arg_0           = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                mov     esi, edx
                push    ebx
                mov     ebx, ecx
                sub     esp, 3Ch
                mov     edi, [ebp+arg_0]
                test    ecx, ecx
                mov     [ebp+var_2C], eax
                mov     eax, [edi+8]
                jle     loc_404428
                cmp     ecx, eax
                jge     loc_4042F0
                sub     eax, ecx
                mov     [edi+8], eax

loc_4041BB:                             ; CODE XREF: sub_404190+29A\u2193j
                test    eax, eax
                js      loc_4042F0

loc_4041C3:                             ; CODE XREF: sub_404190+2A6\u2193j
                mov     edx, [edi+0Ch]
                cmp     edx, eax
                jge     loc_4042F0
                sub     eax, edx
                test    eax, eax
                mov     [edi+8], eax
                jle     loc_4042F7
                test    edx, edx
                jle     loc_404490

loc_4041E3:                             ; CODE XREF: sub_404190+310\u2193j
                sub     eax, 1
                test    eax, eax
                mov     [edi+8], eax
                jz      loc_4042F7

loc_4041F1:                             ; CODE XREF: sub_404190+304\u2193j
                mov     edx, [ebp+var_2C]
                test    edx, edx
                jnz     loc_4043B6
                mov     edx, [edi+4]
                test    edx, 1C0h
                jnz     loc_4043B6

loc_40420B:                             ; CODE XREF: sub_404190+237\u2193j
                and     dh, 6
                jnz     loc_4042F7
                jmp     short loc_404222
; ---------------------------------------------------------------------------

loc_404216:                             ; CODE XREF: sub_404190+9D\u2193j
                mov     edx, edi
                mov     eax, 20h ; ' '
                call    sub_4039D0

loc_404222:                             ; CODE XREF: sub_404190+84\u2191j
                mov     eax, [edi+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [edi+8], edx
                jg      short loc_404216
                mov     eax, [ebp+var_2C]
                test    eax, eax
                jz      loc_404302

loc_40423A:                             ; CODE XREF: sub_404190+16C\u2193j
                mov     edx, edi
                mov     eax, 2Dh ; '-'
                call    sub_4039D0

loc_404246:                             ; CODE XREF: sub_404190+180\u2193j
                                        ; sub_404190+192\u2193j ...
                mov     edx, [edi+8]
                test    edx, edx
                jle     short loc_404260
                mov     eax, [edi+4]
                and     eax, 600h
                cmp     eax, 200h
                jz      loc_404451

loc_404260:                             ; CODE XREF: sub_404190+BB\u2191j
                test    ebx, ebx
                jle     loc_404478

loc_404268:                             ; CODE XREF: sub_404190+F4\u2193j
                                        ; sub_404190+2E2\u2193j
                movzx   edx, byte ptr [esi]
                mov     eax, 30h ; '0'
                test    dl, dl
                jz      short loc_40427A
                add     esi, 1
                movsx   eax, dl

loc_40427A:                             ; CODE XREF: sub_404190+E2\u2191j
                mov     edx, edi
                call    sub_4039D0
                sub     ebx, 1
                jnz     short loc_404268

loc_404286:                             ; CODE XREF: sub_404190+2F4\u2193j
                mov     eax, [edi+0Ch]
                test    eax, eax
                jle     loc_4043D0
                cmp     dword ptr [edi+10h], 0FFFFFFFDh
                jz      loc_4043E4

loc_40429B:                             ; CODE XREF: sub_404190+24E\u2193j
                movzx   edx, word ptr [edi+14h]

loc_40429F:                             ; CODE XREF: sub_404190+293\u2193j
                test    dx, dx
                jnz     loc_404327
                mov     eax, 2Eh ; '.'
                mov     edx, edi
                call    sub_4039D0
                mov     eax, [edi+0Ch]

loc_4042B7:                             ; CODE XREF: sub_404190+244\u2193j
                test    ebx, ebx
                jz      short loc_4042DC
                jmp     loc_404398
; ---------------------------------------------------------------------------

loc_4042C0:                             ; CODE XREF: sub_404190+154\u2193j
                movzx   edx, byte ptr [esi]
                mov     eax, 30h ; '0'
                test    dl, dl
                jz      short loc_4042D2
                add     esi, 1
                movsx   eax, dl

loc_4042D2:                             ; CODE XREF: sub_404190+13A\u2191j
                mov     edx, edi
                call    sub_4039D0

loc_4042D9:                             ; CODE XREF: sub_404190+221\u2193j
                mov     eax, [edi+0Ch]

loc_4042DC:                             ; CODE XREF: sub_404190+129\u2191j
                                        ; sub_404190+202\u2193j
                lea     edx, [eax-1]
                test    eax, eax
                mov     [edi+0Ch], edx
                jg      short loc_4042C0
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4042F0:                             ; CODE XREF: sub_404190+20\u2191j
                                        ; sub_404190+2D\u2191j ...
                mov     dword ptr [edi+8], 0FFFFFFFFh

loc_4042F7:                             ; CODE XREF: sub_404190+45\u2191j
                                        ; sub_404190+5B\u2191j ...
                mov     eax, [ebp+var_2C]
                test    eax, eax
                jnz     loc_40423A

loc_404302:                             ; CODE XREF: sub_404190+A4\u2191j
                mov     eax, [edi+4]
                test    ah, 1
                jnz     loc_404440
                test    al, 40h
                jz      loc_404246
                mov     edx, edi
                mov     eax, 20h ; ' '
                call    sub_4039D0
                jmp     loc_404246
; ---------------------------------------------------------------------------

loc_404327:                             ; CODE XREF: sub_404190+112\u2191j
                mov     eax, [edi+10h]
                mov     [ebp+var_2C], esp
                add     eax, 0Fh
                and     eax, 0FFFFFFF0h
                call    sub_402240
                sub     esp, eax
                lea     ecx, [esp+48h+MultiByteStr]
                lea     eax, [ebp+var_1C]
                mov     [ebp+var_1C], 0
                mov     [esp+8], eax
                mov     [esp+4], edx    ; int
                mov     [esp], ecx      ; lpMultiByteStr
                mov     [ebp+var_30], ecx
                call    sub_405C90
                test    eax, eax
                jle     loc_4044A5
                mov     ecx, [ebp+var_30]
                mov     [ebp+var_34], ebx
                mov     [ebp+var_30], esi
                add     eax, ecx
                mov     ebx, ecx
                mov     esi, eax

loc_404372:                             ; CODE XREF: sub_404190+1F2\u2193j
                add     ebx, 1
                movsx   eax, byte ptr [ebx-1]
                mov     edx, edi
                call    sub_4039D0
                cmp     ebx, esi
                jnz     short loc_404372
                mov     esi, [ebp+var_30]
                mov     ebx, [ebp+var_34]

loc_40438A:                             ; CODE XREF: sub_404190+321\u2193j
                test    ebx, ebx
                mov     esp, [ebp+var_2C]
                mov     eax, [edi+0Ch]
                jz      loc_4042DC

loc_404398:                             ; CODE XREF: sub_404190+12B\u2191j
                add     eax, ebx
                mov     [edi+0Ch], eax
                lea     esi, [esi+0]

loc_4043A0:                             ; CODE XREF: sub_404190+21F\u2193j
                mov     edx, edi
                mov     eax, 30h ; '0'
                call    sub_4039D0
                add     ebx, 1
                js      short loc_4043A0
                jmp     loc_4042D9
; ---------------------------------------------------------------------------

loc_4043B6:                             ; CODE XREF: sub_404190+66\u2191j
                                        ; sub_404190+75\u2191j
                sub     eax, 1
                test    eax, eax
                mov     [edi+8], eax
                jz      loc_4042F7
                mov     edx, [edi+4]
                jmp     loc_40420B
; ---------------------------------------------------------------------------
                align 10h

loc_4043D0:                             ; CODE XREF: sub_404190+FB\u2191j
                test    byte ptr [edi+5], 8
                jz      loc_4042B7
                cmp     dword ptr [edi+10h], 0FFFFFFFDh
                jnz     loc_40429B

loc_4043E4:                             ; CODE XREF: sub_404190+105\u2191j
                mov     [ebp+var_1C], 0
                call    localeconv
                lea     edx, [ebp+var_1C]
                mov     [esp+0Ch], edx  ; int
                mov     dword ptr [esp+8], 10h ; int
                mov     eax, [eax]
                mov     [esp+4], eax    ; lpMultiByteStr
                lea     eax, [ebp+WideCharStr]
                mov     [esp], eax      ; lpWideCharStr
                call    sub_405960
                test    eax, eax
                jle     loc_4044B6
                movzx   edx, [ebp+WideCharStr]
                mov     [edi+14h], dx

loc_404420:                             ; CODE XREF: sub_404190+32A\u2193j
                mov     [edi+10h], eax
                jmp     loc_40429F
; ---------------------------------------------------------------------------

loc_404428:                             ; CODE XREF: sub_404190+18\u2191j
                test    eax, eax
                jle     loc_4041BB
                sub     eax, 1
                mov     [edi+8], eax
                jmp     loc_4041C3
; ---------------------------------------------------------------------------
                align 10h

loc_404440:                             ; CODE XREF: sub_404190+178\u2191j
                mov     edx, edi
                mov     eax, 2Bh ; '+'
                call    sub_4039D0
                jmp     loc_404246
; ---------------------------------------------------------------------------

loc_404451:                             ; CODE XREF: sub_404190+CA\u2191j
                sub     edx, 1
                mov     [edi+8], edx

loc_404457:                             ; CODE XREF: sub_404190+2DE\u2193j
                mov     edx, edi
                mov     eax, 30h ; '0'
                call    sub_4039D0
                mov     eax, [edi+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [edi+8], edx
                jg      short loc_404457
                test    ebx, ebx
                jg      loc_404268

loc_404478:                             ; CODE XREF: sub_404190+D2\u2191j
                mov     edx, edi
                mov     eax, 30h ; '0'
                call    sub_4039D0
                jmp     loc_404286
; ---------------------------------------------------------------------------
                align 10h

loc_404490:                             ; CODE XREF: sub_404190+4D\u2191j
                test    byte ptr [edi+5], 8
                jz      loc_4041F1
                lea     esi, [esi+0]
                jmp     loc_4041E3
; ---------------------------------------------------------------------------

loc_4044A5:                             ; CODE XREF: sub_404190+1CD\u2191j
                mov     edx, edi
                mov     eax, 2Eh ; '.'
                call    sub_4039D0
                jmp     loc_40438A
; ---------------------------------------------------------------------------

loc_4044B6:                             ; CODE XREF: sub_404190+282\u2191j
                movzx   edx, word ptr [edi+14h]
                jmp     loc_404420
sub_404190      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_4044C0      proc near               ; CODE XREF: sub_404590+6D\u2193p
                                        ; sub_404720+FF\u2193p

var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
arg_0           = dword ptr  4

                push    ebp
                sub     ecx, 1
                push    edi
                mov     ebp, edx
                push    esi
                mov     esi, 1
                push    ebx
                mov     ebx, 66666667h
                sub     esp, 1Ch
                mov     [esp+2Ch+var_28], eax
                mov     eax, ecx
                mov     edi, [esp+2Ch+arg_0]
                sar     eax, 1Fh
                mov     [esp+2Ch+var_20], eax
                mov     eax, ecx
                imul    ebx
                mov     [esp+2Ch+var_24], ecx
                sar     ecx, 1Fh
                sar     edx, 2
                mov     ebx, edx
                sub     ebx, ecx
                jz      short loc_404513
                mov     ecx, 66666667h

loc_404500:                             ; CODE XREF: sub_4044C0+51\u2193j
                mov     eax, ebx
                add     esi, 1
                imul    ecx
                sar     ebx, 1Fh
                sar     edx, 2
                sub     edx, ebx
                mov     ebx, edx
                jnz     short loc_404500

loc_404513:                             ; CODE XREF: sub_4044C0+39\u2191j
                mov     eax, [edi+20h]
                cmp     esi, eax
                jge     short loc_40451C
                mov     esi, eax

loc_40451C:                             ; CODE XREF: sub_4044C0+58\u2191j
                mov     edx, [edi+8]
                lea     eax, [esi+2]
                cmp     edx, eax
                jg      short loc_404580
                mov     dword ptr [edi+8], 0FFFFFFFFh

loc_40452D:                             ; CODE XREF: sub_4044C0+C5\u2193j
                mov     eax, [esp+2Ch+var_28]
                mov     ecx, 1
                mov     edx, ebp
                mov     [esp+2Ch+var_2C], edi
                add     esi, 1
                call    sub_404190
                mov     eax, [edi+20h]
                mov     [edi+0Ch], eax
                mov     eax, [edi+4]
                mov     edx, eax
                and     eax, 20h
                or      edx, 1C0h
                or      eax, 45h
                mov     [edi+4], edx
                mov     edx, edi
                call    sub_4039D0
                mov     eax, [esp+2Ch+var_24]
                mov     ecx, edi
                add     [edi+8], esi
                mov     edx, [esp+2Ch+var_20]
                call    sub_403C80
                add     esp, 1Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_404580:                             ; CODE XREF: sub_4044C0+64\u2191j
                sub     edx, eax
                mov     [edi+8], edx
                jmp     short loc_40452D
sub_4044C0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


; int __cdecl sub_404590(_TBYTE)
sub_404590      proc near               ; CODE XREF: sub_404E70+3F2\u2193p
                                        ; sub_404E70+4FB\u2193p

var_4C          = dword ptr -4Ch
var_48          = dword ptr -48h
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = tbyte ptr -1Ch
var_10          = dword ptr -10h
arg_0           = tbyte ptr  4

                push    esi
                push    ebx
                mov     ebx, eax
                sub     esp, 44h
                mov     eax, [eax+0Ch]
                test    eax, eax
                js      short loc_404610
                add     eax, 1

loc_4045A1:                             ; CODE XREF: sub_404590+8C\u2193j
                fld     [esp+4Ch+arg_0]
                mov     [esp+4Ch+var_3C], eax
                lea     edx, [esp+4Ch+var_24]
                fstp    [esp+4Ch+var_1C]
                mov     eax, dword ptr [esp+4Ch+var_1C]
                mov     [esp+4Ch+var_34], edx
                lea     edx, [esp+4Ch+var_20]
                mov     [esp+4Ch+var_38], edx
                mov     [esp+4Ch+var_4C], eax
                mov     eax, dword ptr [esp+4Ch+var_1C+4]
                mov     [esp+4Ch+var_48], eax
                mov     eax, dword ptr [esp+4Ch+var_1C+8]
                mov     [esp+4Ch+var_44], eax
                mov     eax, [esp+4Ch+var_10]
                mov     [esp+4Ch+var_40], eax
                mov     eax, 2
                call    sub_4038D0
                mov     ecx, [esp+4Ch+var_20]
                cmp     ecx, 0FFFF8000h
                mov     esi, eax
                jz      short loc_404620
                mov     edx, eax
                mov     eax, [esp+4Ch+var_24]
                mov     [esp+4Ch+var_4C], ebx
                call    sub_4044C0
                mov     [esp+4Ch+var_4C], esi
                call    sub_4074F0
                add     esp, 44h
                pop     ebx
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_404610:                             ; CODE XREF: sub_404590+C\u2191j
                mov     dword ptr [ebx+0Ch], 6
                mov     eax, 7
                jmp     short loc_4045A1
; ---------------------------------------------------------------------------
                align 10h

loc_404620:                             ; CODE XREF: sub_404590+62\u2191j
                mov     edx, eax
                mov     eax, [esp+4Ch+var_24]
                mov     ecx, ebx
                call    sub_403BF0
                mov     [esp+4Ch+var_4C], esi
                call    sub_4074F0
                add     esp, 44h
                pop     ebx
                pop     esi
                retn
sub_404590      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


; int __cdecl sub_404640(_TBYTE)
sub_404640      proc near               ; CODE XREF: sub_404E70+3C2\u2193p
                                        ; sub_404E70+4D0\u2193p

var_4C          = dword ptr -4Ch
var_48          = dword ptr -48h
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = tbyte ptr -1Ch
var_10          = dword ptr -10h
arg_0           = tbyte ptr  4

                push    edi
                push    esi
                push    ebx
                mov     ebx, eax
                sub     esp, 40h
                mov     eax, [eax+0Ch]
                test    eax, eax
                js      loc_4046F0

loc_404653:                             ; CODE XREF: sub_404640+BC\u2193j
                fld     [esp+4Ch+arg_0]
                mov     [esp+4Ch+var_3C], eax
                lea     edx, [esp+4Ch+var_24]
                fstp    [esp+4Ch+var_1C]
                mov     eax, dword ptr [esp+4Ch+var_1C]
                mov     [esp+4Ch+var_34], edx
                lea     edx, [esp+4Ch+var_20]
                mov     [esp+4Ch+var_38], edx
                mov     [esp+4Ch+var_4C], eax
                mov     eax, dword ptr [esp+4Ch+var_1C+4]
                mov     [esp+4Ch+var_48], eax
                mov     eax, dword ptr [esp+4Ch+var_1C+8]
                mov     [esp+4Ch+var_44], eax
                mov     eax, [esp+4Ch+var_10]
                mov     [esp+4Ch+var_40], eax
                mov     eax, 3
                call    sub_4038D0
                mov     ecx, [esp+4Ch+var_20]
                cmp     ecx, 0FFFF8000h
                mov     edi, eax
                jz      short loc_404701
                mov     edx, eax
                mov     eax, [esp+4Ch+var_24]
                mov     [esp+4Ch+var_4C], ebx
                call    sub_404190
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jle     short loc_4046DA

loc_4046C1:                             ; CODE XREF: sub_404640+98\u2193j
                mov     edx, ebx
                mov     eax, 20h ; ' '
                call    sub_4039D0
                mov     ecx, [ebx+8]
                lea     esi, [ecx-1]
                test    ecx, ecx
                mov     [ebx+8], esi
                jg      short loc_4046C1

loc_4046DA:                             ; CODE XREF: sub_404640+7F\u2191j
                mov     [esp+4Ch+var_4C], edi
                call    sub_4074F0
                add     esp, 40h
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4046F0:                             ; CODE XREF: sub_404640+D\u2191j
                mov     dword ptr [ebx+0Ch], 6
                mov     eax, 6
                jmp     loc_404653
; ---------------------------------------------------------------------------

loc_404701:                             ; CODE XREF: sub_404640+64\u2191j
                mov     edx, eax
                mov     eax, [esp+4Ch+var_24]
                mov     ecx, ebx
                call    sub_403BF0
                mov     [esp+4Ch+var_4C], edi
                call    sub_4074F0
                add     esp, 40h
                pop     ebx
                pop     esi
                pop     edi
                retn
sub_404640      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


; int __cdecl sub_404720(_TBYTE)
sub_404720      proc near               ; CODE XREF: sub_404E70+396\u2193p
                                        ; sub_404E70+4AB\u2193p

Str             = dword ptr -4Ch
var_48          = dword ptr -48h
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = tbyte ptr -1Ch
var_10          = dword ptr -10h
arg_0           = tbyte ptr  4

                push    edi
                push    esi
                push    ebx
                mov     ebx, eax
                sub     esp, 40h
                mov     eax, [eax+0Ch]
                test    eax, eax
                js      loc_404850
                jz      loc_404833

loc_404739:                             ; CODE XREF: sub_404720+11F\u2193j
                                        ; sub_404720+13C\u2193j
                fld     [esp+4Ch+arg_0]
                mov     [esp+4Ch+var_3C], eax
                lea     edx, [esp+4Ch+var_24]
                fstp    [esp+4Ch+var_1C]
                mov     eax, dword ptr [esp+4Ch+var_1C]
                mov     [esp+4Ch+var_34], edx
                lea     edx, [esp+4Ch+var_20]
                mov     [esp+4Ch+var_38], edx
                mov     [esp+4Ch+Str], eax
                mov     eax, dword ptr [esp+4Ch+var_1C+4]
                mov     [esp+4Ch+var_48], eax
                mov     eax, dword ptr [esp+4Ch+var_1C+8]
                mov     [esp+4Ch+var_44], eax
                mov     eax, [esp+4Ch+var_10]
                mov     [esp+4Ch+var_40], eax
                mov     eax, 2
                call    sub_4038D0
                mov     esi, [esp+4Ch+var_20]
                cmp     esi, 0FFFF8000h
                mov     edi, eax
                jz      loc_404870
                cmp     esi, 0FFFFFFFDh
                jl      short loc_404800
                mov     eax, [ebx+0Ch]
                cmp     esi, eax
                jg      short loc_404800
                test    byte ptr [ebx+5], 8
                jnz     loc_404861
                mov     [esp+4Ch+Str], edi ; Str
                call    strlen
                sub     eax, esi
                test    eax, eax
                mov     [ebx+0Ch], eax
                js      loc_404880

loc_4047BB:                             ; CODE XREF: sub_404720+146\u2193j
                                        ; sub_404720+165\u2193j ...
                mov     eax, [esp+4Ch+var_24]
                mov     edx, edi
                mov     ecx, esi
                mov     [esp+4Ch+Str], ebx
                call    sub_404190
                mov     eax, [ebx+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [ebx+8], edx
                jle     short loc_404824

loc_4047D8:                             ; CODE XREF: sub_404720+CF\u2193j
                mov     edx, ebx
                mov     eax, 20h ; ' '
                call    sub_4039D0
                mov     ecx, [ebx+8]
                lea     esi, [ecx-1]
                test    ecx, ecx
                mov     [ebx+8], esi
                jg      short loc_4047D8
                mov     [esp+4Ch+Str], edi
                call    sub_4074F0
                add     esp, 40h
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_404800:                             ; CODE XREF: sub_404720+73\u2191j
                                        ; sub_404720+7A\u2191j
                test    byte ptr [ebx+5], 8
                jnz     short loc_404844
                mov     [esp+4Ch+Str], edi ; Str
                call    strlen
                sub     eax, 1
                mov     [ebx+0Ch], eax

loc_404814:                             ; CODE XREF: sub_404720+128\u2193j
                mov     eax, [esp+4Ch+var_24]
                mov     ecx, esi
                mov     edx, edi
                mov     [esp+4Ch+Str], ebx
                call    sub_4044C0

loc_404824:                             ; CODE XREF: sub_404720+B6\u2191j
                                        ; sub_404720+15D\u2193j
                mov     [esp+4Ch+Str], edi
                call    sub_4074F0
                add     esp, 40h
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_404833:                             ; CODE XREF: sub_404720+13\u2191j
                mov     dword ptr [ebx+0Ch], 1
                mov     eax, 1
                jmp     loc_404739
; ---------------------------------------------------------------------------

loc_404844:                             ; CODE XREF: sub_404720+E4\u2191j
                sub     dword ptr [ebx+0Ch], 1
                jmp     short loc_404814
; ---------------------------------------------------------------------------
                align 10h

loc_404850:                             ; CODE XREF: sub_404720+D\u2191j
                mov     dword ptr [ebx+0Ch], 6
                mov     eax, 6
                jmp     loc_404739
; ---------------------------------------------------------------------------

loc_404861:                             ; CODE XREF: sub_404720+80\u2191j
                sub     eax, esi
                mov     [ebx+0Ch], eax
                jmp     loc_4047BB
; ---------------------------------------------------------------------------
                align 10h

loc_404870:                             ; CODE XREF: sub_404720+6A\u2191j
                mov     edx, eax
                mov     eax, [esp+4Ch+var_24]
                mov     ecx, ebx
                call    sub_403BF0
                jmp     short loc_404824
; ---------------------------------------------------------------------------
                align 10h

loc_404880:                             ; CODE XREF: sub_404720+95\u2191j
                mov     edx, [ebx+8]
                test    edx, edx
                jle     loc_4047BB
                add     eax, edx
                mov     [ebx+8], eax
                jmp     loc_4047BB
sub_404720      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4048A0(_TBYTE)
sub_4048A0      proc near               ; CODE XREF: sub_404E70+302\u2193p
                                        ; sub_404E70+54C\u2193p

MultiByteStr    = byte ptr -68h
var_64          = dword ptr -64h
var_60          = dword ptr -60h
var_5C          = dword ptr -5Ch
var_58          = dword ptr -58h
var_54          = dword ptr -54h
var_50          = dword ptr -50h
var_4C          = dword ptr -4Ch
WideCharStr     = word ptr -46h
var_44          = dword ptr -44h
var_40          = tbyte ptr -40h
var_2A          = byte ptr -2Ah
var_29          = byte ptr -29h
arg_0           = tbyte ptr  8

                push    ebp
                mov     ebp, esp
                push    edi
                mov     edi, eax
                push    esi
                push    ebx
                sub     esp, 6Ch
                fld     [ebp+arg_0]
                fld     st
                fstp    [ebp+var_40]
                fxam
                fstsw   ax
                and     ax, 4500h
                cmp     ax, 100h
                jz      loc_404DE5
                movzx   edx, word ptr [ebp+var_40+8]
                mov     ebx, edx
                and     ebx, 8000h
                jnz     loc_404A20

loc_4048D8:                             ; CODE XREF: sub_4048A0+187\u2193j
                fxam
                fstsw   ax
                fstp    st
                and     ax, 4500h
                cmp     ax, 500h
                jz      loc_404E03
                and     dx, 7FFFh
                jz      loc_404AB0
                lea     esi, [edx-3FFFh]
                mov     eax, dword ptr [ebp+var_40]
                mov     edx, dword ptr [ebp+var_40+4]

loc_404904:                             ; CODE XREF: sub_4048A0+241\u2193j
                                        ; sub_4048A0+4FD\u2193j ...
                mov     ebx, [edi+0Ch]
                cmp     ebx, 0Eh
                jbe     loc_404A36
                mov     ecx, edx
                or      ecx, eax
                jz      loc_404E16

loc_40491A:                             ; CODE XREF: sub_4048A0+1FD\u2193j
                                        ; sub_4048A0+207\u2193j
                lea     ecx, [ebp+var_2A]
                mov     [ebp+var_5C], ecx
                mov     [ebp+var_54], ecx
                mov     [ebp+var_58], edi
                jmp     short loc_404986
; ---------------------------------------------------------------------------

loc_404928:                             ; CODE XREF: sub_4048A0+F8\u2193j
                mov     ecx, [ebp+var_58]
                mov     ecx, [ecx+0Ch]
                test    ecx, ecx
                jle     short loc_40493B
                mov     ebx, [ebp+var_58]
                sub     ecx, 1
                mov     [ebx+0Ch], ecx

loc_40493B:                             ; CODE XREF: sub_4048A0+90\u2191j
                mov     ecx, [ebp+var_54]
                shrd    eax, edx, 4
                shr     edx, 4
                test    edi, edi
                mov     [ebp+var_50], ecx
                jz      loc_4049F8

loc_404950:                             ; CODE XREF: sub_4048A0+152\u2193j
                mov     ecx, [ebp+var_50]
                add     ecx, 1
                cmp     edi, 9
                mov     [ebp+var_54], ecx
                jle     loc_404A17
                lea     ecx, [edi+37h]
                mov     edi, [ebp+var_58]
                mov     edi, [edi+4]
                mov     [ebp+var_60], edi
                movzx   ebx, byte ptr [ebp+var_60]
                and     ebx, 20h
                or      ecx, ebx

loc_404977:                             ; CODE XREF: sub_4048A0+17A\u2193j
                mov     edi, [ebp+var_50]
                mov     [edi], cl

loc_40497C:                             ; CODE XREF: sub_4048A0+32B\u2193j
                mov     edi, edx
                or      edi, eax
                jz      loc_404AE6

loc_404986:                             ; CODE XREF: sub_4048A0+86\u2191j
                mov     edi, eax
                mov     ecx, eax
                and     edi, 0Fh
                mov     ebx, edi
                xor     ecx, edi
                sar     ebx, 1Fh
                xor     ebx, edx
                or      ebx, ecx
                jnz     short loc_404928
                mov     ecx, [ebp+var_5C]
                cmp     [ebp+var_54], ecx
                ja      short loc_4049C0
                mov     ecx, [ebp+var_58]
                test    byte ptr [ecx+5], 8
                jnz     short loc_4049C0
                mov     ecx, [ebp+var_54]
                mov     [ebp+var_50], ecx
                mov     ecx, [ebp+var_58]
                mov     ebx, [ecx+0Ch]
                test    ebx, ebx
                jle     short loc_4049CC
                nop
                lea     esi, [esi+0]

loc_4049C0:                             ; CODE XREF: sub_4048A0+100\u2191j
                                        ; sub_4048A0+109\u2191j
                mov     ecx, [ebp+var_54]
                lea     ebx, [ecx+1]
                mov     [ebp+var_50], ebx
                mov     byte ptr [ecx], 2Eh ; '.'

loc_4049CC:                             ; CODE XREF: sub_4048A0+119\u2191j
                mov     ecx, eax
                xor     ecx, 1
                or      ecx, edx
                jz      short loc_4049EC
                lea     ecx, [esi-1]

loc_4049D8:                             ; CODE XREF: sub_4048A0+14A\u2193j
                shrd    eax, edx, 1
                mov     esi, ecx
                mov     ebx, eax
                shr     edx, 1
                xor     ebx, 1
                or      ebx, edx
                lea     ecx, [esi-1]
                jnz     short loc_4049D8

loc_4049EC:                             ; CODE XREF: sub_4048A0+133\u2191j
                xor     eax, eax
                xor     edx, edx
                test    edi, edi
                jnz     loc_404950

loc_4049F8:                             ; CODE XREF: sub_4048A0+AA\u2191j
                mov     ecx, [ebp+var_5C]
                cmp     [ebp+var_50], ecx
                ja      short loc_404A0E
                mov     ecx, [ebp+var_58]
                mov     ecx, [ecx+0Ch]
                test    ecx, ecx
                js      loc_404BC5

loc_404A0E:                             ; CODE XREF: sub_4048A0+15E\u2191j
                mov     ecx, [ebp+var_50]
                add     ecx, 1
                mov     [ebp+var_54], ecx

loc_404A17:                             ; CODE XREF: sub_4048A0+BC\u2191j
                lea     ecx, [edi+30h]
                jmp     loc_404977
; ---------------------------------------------------------------------------
                align 10h

loc_404A20:                             ; CODE XREF: sub_4048A0+32\u2191j
                or      dword ptr [edi+4], 80h
                jmp     loc_4048D8
; ---------------------------------------------------------------------------
                align 10h

loc_404A30:                             ; CODE XREF: sub_4048A0+198\u2193j
                shld    edx, eax, 1
                add     eax, eax

loc_404A36:                             ; CODE XREF: sub_4048A0+6A\u2191j
                test    edx, edx
                jns     short loc_404A30
                mov     ecx, 0Eh
                shrd    eax, edx, 1
                sub     ecx, ebx
                shr     edx, 1
                shl     ecx, 2
                mov     [ebp+var_50], eax
                mov     eax, 4
                mov     [ebp+var_4C], edx
                xor     edx, edx
                shld    edx, eax, cl
                shl     eax, cl
                test    cl, 20h
                jz      short loc_404A65
                mov     edx, eax
                xor     eax, eax

loc_404A65:                             ; CODE XREF: sub_4048A0+1BF\u2191j
                add     [ebp+var_50], eax
                adc     [ebp+var_4C], edx
                mov     edx, [ebp+var_4C]
                mov     eax, [ebp+var_50]
                test    edx, edx
                js      loc_404DDD
                shld    edx, eax, 1
                add     eax, eax
                mov     [ebp+var_50], eax
                mov     [ebp+var_4C], edx

loc_404A85:                             ; CODE XREF: sub_4048A0+540\u2193j
                mov     edx, [ebp+var_4C]
                mov     ecx, 0Fh
                mov     eax, [ebp+var_50]
                sub     ecx, ebx
                shl     ecx, 2
                shrd    eax, edx, cl
                shr     edx, cl
                test    cl, 20h
                jz      loc_40491A
                mov     eax, edx
                xor     edx, edx
                jmp     loc_40491A
; ---------------------------------------------------------------------------
                align 10h

loc_404AB0:                             ; CODE XREF: sub_4048A0+52\u2191j
                mov     edx, dword ptr [ebp+var_40+4]
                mov     eax, dword ptr [ebp+var_40]
                mov     esi, edx
                or      esi, eax
                jz      loc_404D97
                test    edx, edx
                js      loc_404E4C
                mov     ecx, 0FFFFC001h
                lea     esi, [esi+0]

loc_404AD0:                             ; CODE XREF: sub_4048A0+23D\u2193j
                shld    edx, eax, 1
                mov     ebx, ecx
                add     eax, eax
                sub     ecx, 1
                test    edx, edx
                jns     short loc_404AD0
                mov     esi, ebx
                jmp     loc_404904
; ---------------------------------------------------------------------------

loc_404AE6:                             ; CODE XREF: sub_4048A0+E0\u2191j
                mov     eax, [ebp+var_5C]
                cmp     [ebp+var_54], eax
                mov     edi, [ebp+var_58]
                jz      loc_404E47
                mov     eax, [edi+4]
                mov     [ebp+var_50], eax

loc_404AFB:                             ; CODE XREF: sub_4048A0+596\u2193j
                mov     eax, [edi+8]
                test    eax, eax
                mov     [ebp+var_60], eax
                jle     loc_404D85
                mov     edx, [edi+0Ch]
                movsx   esi, si
                mov     eax, [ebp+var_54]
                sub     eax, [ebp+var_5C]
                mov     [ebp+var_58], esi
                test    edx, edx
                jle     short loc_404B1E
                add     eax, edx

loc_404B1E:                             ; CODE XREF: sub_4048A0+27A\u2191j
                mov     edx, [ebp+var_50]
                and     edx, 1C0h
                cmp     edx, 1
                sbb     edx, edx
                lea     esi, [eax+edx+6]
                mov     eax, [ebp+var_58]
                mov     edx, 66666667h
                imul    edx
                mov     eax, [ebp+var_58]
                sar     edx, 2
                sar     eax, 1Fh
                sub     edx, eax
                mov     ecx, edx
                jz      loc_404E3B
                mov     ebx, 2

loc_404B52:                             ; CODE XREF: sub_4048A0+2C9\u2193j
                mov     eax, 66666667h
                add     esi, 1
                imul    ecx
                add     ebx, 1
                sar     ecx, 1Fh
                sar     edx, 2
                sub     edx, ecx
                mov     ecx, edx
                jnz     short loc_404B52
                movsx   eax, bx
                mov     [ebp+var_64], eax

loc_404B71:                             ; CODE XREF: sub_4048A0+5A2\u2193j
                cmp     [ebp+var_60], esi
                jle     short loc_404BD0
                mov     eax, [ebp+var_60]
                sub     eax, esi
                test    [ebp+var_50], 600h
                jnz     loc_404DA2
                lea     edx, [eax-1]
                test    eax, eax
                mov     [edi+8], edx
                jle     short loc_404BD7

loc_404B92:                             ; CODE XREF: sub_4048A0+309\u2193j
                mov     edx, edi
                mov     eax, 20h ; ' '
                call    sub_4039D0
                mov     eax, [edi+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [edi+8], edx
                jg      short loc_404B92
                mov     eax, [edi+4]
                mov     [ebp+var_50], eax
                test    byte ptr [ebp+var_50], 80h
                jz      short loc_404BDD

loc_404BB7:                             ; CODE XREF: sub_4048A0+33B\u2193j
                mov     edx, edi
                mov     eax, 2Dh ; '-'
                call    sub_4039D0
                jmp     short loc_404BF4
; ---------------------------------------------------------------------------

loc_404BC5:                             ; CODE XREF: sub_4048A0+168\u2191j
                mov     edi, [ebp+var_50]
                mov     [ebp+var_54], edi
                jmp     loc_40497C
; ---------------------------------------------------------------------------

loc_404BD0:                             ; CODE XREF: sub_4048A0+2D4\u2191j
                mov     dword ptr [edi+8], 0FFFFFFFFh

loc_404BD7:                             ; CODE XREF: sub_4048A0+2F0\u2191j
                                        ; sub_4048A0+4F2\u2193j ...
                test    byte ptr [ebp+var_50], 80h
                jnz     short loc_404BB7

loc_404BDD:                             ; CODE XREF: sub_4048A0+315\u2191j
                test    [ebp+var_50], 100h
                jnz     loc_404DAA
                test    byte ptr [ebp+var_50], 40h
                jnz     loc_404DCC

loc_404BF4:                             ; CODE XREF: sub_4048A0+323\u2191j
                                        ; sub_4048A0+516\u2193j ...
                mov     edx, edi
                mov     eax, 30h ; '0'
                call    sub_4039D0
                mov     eax, [edi+4]
                mov     edx, edi
                and     eax, 20h
                or      eax, 58h
                call    sub_4039D0
                mov     eax, [edi+8]
                test    eax, eax
                jle     short loc_404C3C
                test    byte ptr [edi+5], 2
                jz      short loc_404C3C
                sub     eax, 1
                mov     [edi+8], eax

loc_404C23:                             ; CODE XREF: sub_4048A0+39A\u2193j
                mov     edx, edi
                mov     eax, 30h ; '0'
                call    sub_4039D0
                mov     eax, [edi+8]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [edi+8], edx
                jg      short loc_404C23

loc_404C3C:                             ; CODE XREF: sub_4048A0+375\u2191j
                                        ; sub_4048A0+37B\u2191j
                mov     eax, [ebp+var_5C]
                cmp     [ebp+var_54], eax
                mov     ebx, [ebp+var_54]
                ja      short loc_404C60
                jmp     loc_404CED
; ---------------------------------------------------------------------------
                align 10h

loc_404C50:                             ; CODE XREF: sub_4048A0+3C9\u2193j
                mov     edx, edi
                call    sub_4039D0

loc_404C57:                             ; CODE XREF: sub_4048A0+43C\u2193j
                                        ; sub_4048A0+49C\u2193j
                cmp     ebx, [ebp+var_5C]
                jz      loc_404CED

loc_404C60:                             ; CODE XREF: sub_4048A0+3A5\u2191j
                sub     ebx, 1
                movsx   eax, byte ptr [ebx]
                cmp     eax, 2Eh ; '.'
                jnz     short loc_404C50
                cmp     dword ptr [edi+10h], 0FFFFFFFDh
                jz      loc_404D41
                movzx   edx, word ptr [edi+14h]

loc_404C79:                             ; CODE XREF: sub_4048A0+4E0\u2193j
                test    dx, dx
                jz      loc_404D30
                mov     eax, [edi+10h]
                mov     [ebp+var_50], esp
                add     eax, 0Fh
                and     eax, 0FFFFFFF0h
                call    sub_402240
                sub     esp, eax
                lea     esi, [esp+78h+MultiByteStr]
                lea     eax, [ebp+var_44]
                mov     [ebp+var_44], 0
                mov     [esp+8], eax
                mov     [esp+4], edx    ; int
                mov     [esp], esi      ; lpMultiByteStr
                call    sub_405C90
                test    eax, eax
                jle     loc_404DBB
                add     eax, esi
                mov     [ebp+var_54], ebx
                mov     ebx, esi
                mov     esi, eax

loc_404CC4:                             ; CODE XREF: sub_4048A0+434\u2193j
                add     ebx, 1
                movsx   eax, byte ptr [ebx-1]
                mov     edx, edi
                call    sub_4039D0
                cmp     ebx, esi
                jnz     short loc_404CC4
                mov     ebx, [ebp+var_54]

loc_404CD9:                             ; CODE XREF: sub_4048A0+527\u2193j
                mov     esp, [ebp+var_50]
                jmp     loc_404C57
; ---------------------------------------------------------------------------

loc_404CE1:                             ; CODE XREF: sub_4048A0+458\u2193j
                mov     edx, edi
                mov     eax, 30h ; '0'
                call    sub_4039D0

loc_404CED:                             ; CODE XREF: sub_4048A0+3A7\u2191j
                                        ; sub_4048A0+3BA\u2191j
                mov     eax, [edi+0Ch]
                lea     edx, [eax-1]
                test    eax, eax
                mov     [edi+0Ch], edx
                jg      short loc_404CE1
                mov     eax, [edi+4]
                mov     edx, edi
                and     eax, 20h
                or      eax, 50h
                call    sub_4039D0
                mov     eax, [ebp+var_64]
                mov     ecx, edi
                add     [edi+8], eax
                mov     eax, [ebp+var_58]
                or      dword ptr [edi+4], 1C0h
                cdq
                call    sub_403C80

loc_404D22:                             ; CODE XREF: sub_4048A0+555\u2193j
                                        ; sub_4048A0+571\u2193j
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_404D30:                             ; CODE XREF: sub_4048A0+3DC\u2191j
                mov     edx, edi
                mov     eax, 2Eh ; '.'
                call    sub_4039D0
                jmp     loc_404C57
; ---------------------------------------------------------------------------

loc_404D41:                             ; CODE XREF: sub_4048A0+3CF\u2191j
                mov     [ebp+var_44], 0
                lea     esi, [ebp+var_44]
                call    localeconv
                mov     [esp+0Ch], esi  ; int
                mov     dword ptr [esp+8], 10h ; int
                mov     eax, [eax]
                mov     [esp+4], eax    ; lpMultiByteStr
                lea     eax, [ebp+WideCharStr]
                mov     [esp], eax      ; lpWideCharStr
                call    sub_405960
                test    eax, eax
                jle     loc_404DFA
                movzx   edx, [ebp+WideCharStr]
                mov     [edi+14h], dx

loc_404D7D:                             ; CODE XREF: sub_4048A0+55E\u2193j
                mov     [edi+10h], eax
                jmp     loc_404C79
; ---------------------------------------------------------------------------

loc_404D85:                             ; CODE XREF: sub_4048A0+263\u2191j
                movsx   eax, si
                mov     [ebp+var_64], 2
                mov     [ebp+var_58], eax
                jmp     loc_404BD7
; ---------------------------------------------------------------------------

loc_404D97:                             ; CODE XREF: sub_4048A0+21A\u2191j
                xor     esi, esi
                xor     eax, eax
                xor     edx, edx
                jmp     loc_404904
; ---------------------------------------------------------------------------

loc_404DA2:                             ; CODE XREF: sub_4048A0+2E2\u2191j
                mov     [edi+8], eax
                jmp     loc_404BD7
; ---------------------------------------------------------------------------

loc_404DAA:                             ; CODE XREF: sub_4048A0+344\u2191j
                mov     edx, edi
                mov     eax, 2Bh ; '+'
                call    sub_4039D0
                jmp     loc_404BF4
; ---------------------------------------------------------------------------

loc_404DBB:                             ; CODE XREF: sub_4048A0+415\u2191j
                mov     edx, edi
                mov     eax, 2Eh ; '.'
                call    sub_4039D0
                jmp     loc_404CD9
; ---------------------------------------------------------------------------

loc_404DCC:                             ; CODE XREF: sub_4048A0+34E\u2191j
                mov     edx, edi
                mov     eax, 20h ; ' '
                call    sub_4039D0
                jmp     loc_404BF4
; ---------------------------------------------------------------------------

loc_404DDD:                             ; CODE XREF: sub_4048A0+1D3\u2191j
                add     esi, 1
                jmp     loc_404A85
; ---------------------------------------------------------------------------

loc_404DE5:                             ; CODE XREF: sub_4048A0+20\u2191j
                fstp    st
                mov     ecx, edi
                mov     edx, offset aNan ; "NaN"
                xor     eax, eax
                call    sub_403BF0
                jmp     loc_404D22
; ---------------------------------------------------------------------------

loc_404DFA:                             ; CODE XREF: sub_4048A0+4CF\u2191j
                movzx   edx, word ptr [edi+14h]
                jmp     loc_404D7D
; ---------------------------------------------------------------------------

loc_404E03:                             ; CODE XREF: sub_4048A0+47\u2191j
                mov     ecx, edi
                mov     edx, offset aInf ; "Inf"
                mov     eax, ebx
                call    sub_403BF0
                jmp     loc_404D22
; ---------------------------------------------------------------------------

loc_404E16:                             ; CODE XREF: sub_4048A0+74\u2191j
                lea     eax, [ebp+var_2A]
                mov     [ebp+var_5C], eax

loc_404E1C:                             ; CODE XREF: sub_4048A0+5AA\u2193j
                test    ebx, ebx
                mov     eax, [edi+4]
                jle     short loc_404E56
                mov     [ebp+var_50], eax

loc_404E26:                             ; CODE XREF: sub_4048A0+5C3\u2193j
                mov     [ebp+var_2A], 2Eh ; '.'
                lea     eax, [ebp+var_29]

loc_404E2D:                             ; CODE XREF: sub_4048A0+5C1\u2193j
                lea     edx, [eax+1]
                mov     [ebp+var_54], edx
                mov     byte ptr [eax], 30h ; '0'
                jmp     loc_404AFB
; ---------------------------------------------------------------------------

loc_404E3B:                             ; CODE XREF: sub_4048A0+2A7\u2191j
                mov     [ebp+var_64], 2
                jmp     loc_404B71
; ---------------------------------------------------------------------------

loc_404E47:                             ; CODE XREF: sub_4048A0+24F\u2191j
                mov     ebx, [edi+0Ch]
                jmp     short loc_404E1C
; ---------------------------------------------------------------------------

loc_404E4C:                             ; CODE XREF: sub_4048A0+222\u2191j
                mov     esi, 0FFFFC002h
                jmp     loc_404904
; ---------------------------------------------------------------------------

loc_404E56:                             ; CODE XREF: sub_4048A0+581\u2191j
                mov     edx, eax
                and     dh, 8
                mov     [ebp+var_50], eax
                mov     eax, [ebp+var_5C]
                jz      short loc_404E2D
                jmp     short loc_404E26
sub_4048A0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_404E70      proc near               ; CODE XREF: sub_4022A0+33\u2191p
                                        ; sub_4022A0+6B\u2191p

var_6C          = tbyte ptr -6Ch
var_5C          = dword ptr -5Ch
var_58          = dword ptr -58h
var_54          = dword ptr -54h
var_50          = dword ptr -50h
var_4C          = dword ptr -4Ch
var_48          = dword ptr -48h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = word ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 5Ch
                mov     eax, [esp+6Ch+arg_4]
                and     [esp+6Ch+arg_0], 3000h
                mov     esi, [esp+6Ch+arg_C]
                mov     dword ptr [esp+6Ch+var_6C], offset VarName ; "PRINTF_EXPONENT_DIGITS"
                mov     ebp, [esp+6Ch+arg_10]
                mov     [esp+6Ch+var_40], eax
                mov     eax, [esp+6Ch+arg_0]
                mov     [esp+6Ch+var_38], 0FFFFFFFFh
                mov     [esp+6Ch+var_34], 0FFFFFFFFh
                mov     [esp+6Ch+var_30], 0FFFFFFFDh
                mov     [esp+6Ch+var_3C], eax
                xor     eax, eax
                mov     [esp+6Ch+var_2C], ax
                mov     eax, [esp+6Ch+arg_8]
                mov     [esp+6Ch+var_28], 0
                mov     [esp+6Ch+var_24], eax
                call    getenv
                test    eax, eax
                jz      loc_404FB0
                movsx   eax, byte ptr [eax]
                sub     eax, 30h ; '0'
                cmp     eax, 2
                ja      loc_404FB0

loc_404EEC:                             ; CODE XREF: sub_404E70+147\u2193j
                mov     eax, 2

loc_404EF1:                             ; CODE XREF: sub_404E70+152\u2193j
                mov     [esp+6Ch+var_20], eax
                mov     eax, [esp+6Ch+arg_0]
                or      ah, 2
                mov     [esp+6Ch+var_50], eax

loc_404F00:                             ; CODE XREF: sub_404E70+192\u2193j
                                        ; sub_404E70+1CB\u2193j ...
                movsx   eax, byte ptr [esi]
                lea     ebx, [esi+1]
                mov     ecx, ebx
                test    eax, eax
                jz      loc_404FA2

loc_404F10:                             ; CODE XREF: sub_404E70+12C\u2193j
                cmp     eax, 25h ; '%'
                jnz     loc_404FF7
                mov     eax, [esp+6Ch+arg_0]
                mov     [esp+6Ch+var_34], 0FFFFFFFFh
                mov     [esp+6Ch+var_38], 0FFFFFFFFh
                mov     [esp+6Ch+var_58], 0
                mov     [esp+6Ch+var_3C], eax
                movzx   edx, byte ptr [esi+1]
                lea     eax, [esp+6Ch+var_38]
                mov     [esp+6Ch+var_54], eax
                mov     [esp+6Ch+var_5C], 0

loc_404F4D:                             ; CODE XREF: sub_404E70+182\u2193j
                                        ; sub_404E70+266\u2193j ...
                test    dl, dl
                jz      short loc_404F90

loc_404F51:                             ; CODE XREF: sub_404E70+118\u2193j
                                        ; sub_404E70+73F\u2193j ...
                lea     eax, [edx-20h]  ; switch 91 cases
                movsx   edi, dl
                cmp     al, 5Ah
                lea     esi, [ecx+1]
                ja      def_404F65      ; jumptable 00404F65 default case, cases 33,34,36,38-41,44,47,49-64,66,68,72,74,75,77-82,84-87,89-96,98,107,109,113,114,118,119,121
                movzx   eax, al
                jmp     ds:jpt_404F65[eax*4] ; switch jump
; ---------------------------------------------------------------------------
                align 10h

loc_404F70:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                movzx   edx, byte ptr [ecx+1] ; jumptable 00404F65 cases 116,122
                mov     ecx, esi
                mov     [esp+6Ch+var_58], 2
                mov     [esp+6Ch+var_5C], 4
                test    dl, dl
                jnz     short loc_404F51
                lea     esi, [esi+0]

loc_404F90:                             ; CODE XREF: sub_404E70+DF\u2191j
                mov     esi, ecx
                movsx   eax, byte ptr [esi]
                lea     ebx, [esi+1]
                mov     ecx, ebx
                test    eax, eax
                jnz     loc_404F10

loc_404FA2:                             ; CODE XREF: sub_404E70+9A\u2191j
                mov     eax, [esp+6Ch+var_28]
                add     esp, 5Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_404FB0:                             ; CODE XREF: sub_404E70+67\u2191j
                                        ; sub_404E70+76\u2191j
                test    ds:byte_40D06C, 1
                jnz     loc_404EEC
                mov     eax, 3
                jmp     loc_404EF1
; ---------------------------------------------------------------------------

loc_404FC7:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                cmp     byte ptr [ecx+1], 6Ch ; 'l' ; jumptable 00404F65 case 108
                mov     [esp+6Ch+var_58], 2
                jnz     short loc_404FE0 ; jumptable 00404F65 case 76
                lea     esi, [ecx+2]
                mov     [esp+6Ch+var_58], 3

loc_404FE0:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; sub_404E70+163\u2191j
                                        ; DATA XREF: ...
                or      [esp+6Ch+var_3C], 4 ; jumptable 00404F65 case 76
                mov     ecx, esi
                movzx   edx, byte ptr [esi]
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F4D
; ---------------------------------------------------------------------------

loc_404FF7:                             ; CODE XREF: sub_404E70+A3\u2191j
                lea     edx, [esp+6Ch+var_40]
                mov     esi, ebx
                call    sub_4039D0
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_405007:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     edx, [esp+6Ch+var_58] ; jumptable 00404F65 case 115
                mov     eax, ebp
                sub     edx, 2
                cmp     edx, 1
                jbe     loc_405520      ; jumptable 00404F65 case 83
                mov     ebx, [eax]
                add     ebp, 4
                test    ebx, ebx
                jz      loc_4056AF
                mov     dword ptr [esp+6Ch+var_6C], ebx ; Str
                call    strlen
                mov     edx, eax

loc_405030:                             ; CODE XREF: sub_404E70+849\u2193j
                lea     ecx, [esp+6Ch+var_40]
                mov     eax, ebx
                call    sub_403B40
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_405040:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     edx, [esp+6Ch+var_58] ; jumptable 00404F65 case 99
                mov     eax, ebp
                mov     [esp+6Ch+var_34], 0FFFFFFFFh
                sub     edx, 2
                cmp     edx, 1
                jbe     loc_40537D
                mov     eax, [eax]
                lea     ecx, [esp+6Ch+var_40]
                mov     edx, 1
                add     ebp, 4
                mov     byte ptr [esp+6Ch+var_4C], al
                lea     eax, [esp+6Ch+var_4C]
                call    sub_403B40
                jmp     loc_404F00
; ---------------------------------------------------------------------------
                align 10h

loc_405080:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                cmp     [esp+6Ch+var_58], 4 ; jumptable 00404F65 case 110
                jz      loc_40567B
                cmp     [esp+6Ch+var_58], 1
                mov     eax, [ebp+0]
                mov     edx, [esp+6Ch+var_28]
                jz      loc_4055B4
                cmp     [esp+6Ch+var_58], 2
                jz      loc_4056EB
                cmp     [esp+6Ch+var_58], 3
                mov     [eax], edx
                jz      loc_40575E
                add     ebp, 4
                jmp     loc_404F00
; ---------------------------------------------------------------------------
                align 10h

loc_4050C0:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                movzx   edx, byte ptr [ecx+1] ; jumptable 00404F65 case 106
                mov     ecx, esi
                mov     [esp+6Ch+var_58], 3
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F4D
; ---------------------------------------------------------------------------
                align 10h

loc_4050E0:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                movzx   edx, byte ptr [ecx+1] ; jumptable 00404F65 case 104
                cmp     dl, 68h ; 'h'
                jz      loc_405639
                mov     ecx, esi
                mov     [esp+6Ch+var_58], 1
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F4D
; ---------------------------------------------------------------------------

loc_405104:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_5C] ; jumptable 00404F65 case 112
                test    eax, eax
                jnz     short loc_40511A
                mov     eax, [esp+6Ch+arg_0]
                cmp     [esp+6Ch+var_3C], eax
                jz      loc_4056BE

loc_40511A:                             ; CODE XREF: sub_404E70+29A\u2191j
                                        ; sub_404E70+85E\u2193j
                mov     eax, [ebp+0]
                lea     ebx, [ebp+4]
                mov     [esp+6Ch+var_48], 0
                mov     ecx, [esp+6Ch+var_48]
                mov     ebp, ebx
                mov     [esp+6Ch+var_4C], eax
                mov     edx, [esp+6Ch+var_4C]
                lea     eax, [esp+6Ch+var_40]
                mov     dword ptr [esp+6Ch+var_6C], eax
                mov     eax, 78h ; 'x'
                call    sub_403EB0
                jmp     loc_404F00
; ---------------------------------------------------------------------------
                align 10h

loc_405150:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_3C] ; jumptable 00404F65 case 97
                or      eax, 20h
                test    al, 4
                mov     [esp+6Ch+var_3C], eax
                jz      loc_4053AD

loc_405163:                             ; CODE XREF: sub_404E70+537\u2193j
                fld     tbyte ptr [ebp+0]
                lea     ebx, [ebp+0Ch]
                fstp    [esp+6Ch+var_6C] ; _TBYTE
                mov     ebp, ebx
                lea     eax, [esp+6Ch+var_40]
                call    sub_4048A0
                jmp     loc_404F00
; ---------------------------------------------------------------------------
                align 10h

loc_405180:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                cmp     [esp+6Ch+var_58], 3 ; jumptable 00404F65 cases 88,111,117,120
                mov     eax, edi
                jz      loc_40560D
                cmp     [esp+6Ch+var_58], 2
                jz      loc_4055BF
                mov     edi, [ebp+0]
                lea     edx, [ebp+4]
                cmp     [esp+6Ch+var_58], 1
                mov     [esp+6Ch+var_48], 0
                mov     [esp+6Ch+var_4C], edi
                jz      loc_4056D3
                cmp     [esp+6Ch+var_58], 4
                mov     ebp, edx
                jz      loc_405748

loc_4051C2:                             ; CODE XREF: sub_404E70+761\u2193j
                                        ; sub_404E70+7AE\u2193j ...
                cmp     eax, 75h ; 'u'
                jz      loc_4052B7
                mov     edx, [esp+6Ch+var_4C]
                lea     edi, [esp+6Ch+var_40]
                mov     ecx, [esp+6Ch+var_48]
                mov     dword ptr [esp+6Ch+var_6C], edi
                call    sub_403EB0
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_4051E4:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_3C] ; jumptable 00404F65 case 103
                or      eax, 20h
                test    al, 4
                mov     [esp+6Ch+var_3C], eax
                jz      loc_40530C

loc_4051F7:                             ; CODE XREF: sub_404E70+496\u2193j
                fld     tbyte ptr [ebp+0]
                lea     ebx, [ebp+0Ch]
                fstp    [esp+6Ch+var_6C] ; _TBYTE
                mov     ebp, ebx
                lea     eax, [esp+6Ch+var_40]
                call    sub_404720
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_405210:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_3C] ; jumptable 00404F65 case 102
                or      eax, 20h
                test    al, 4
                mov     [esp+6Ch+var_3C], eax
                jz      loc_405331

loc_405223:                             ; CODE XREF: sub_404E70+4BB\u2193j
                fld     tbyte ptr [ebp+0]
                lea     ebx, [ebp+0Ch]
                fstp    [esp+6Ch+var_6C] ; _TBYTE
                mov     ebp, ebx
                lea     eax, [esp+6Ch+var_40]
                call    sub_404640
                jmp     loc_404F00
; ---------------------------------------------------------------------------
                align 10h

loc_405240:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_3C] ; jumptable 00404F65 case 101
                or      eax, 20h
                test    al, 4
                mov     [esp+6Ch+var_3C], eax
                jz      loc_40535C

loc_405253:                             ; CODE XREF: sub_404E70+4E6\u2193j
                fld     tbyte ptr [ebp+0]
                lea     ebx, [ebp+0Ch]
                fstp    [esp+6Ch+var_6C] ; _TBYTE
                mov     ebp, ebx
                lea     eax, [esp+6Ch+var_40]
                call    sub_404590
                jmp     loc_404F00
; ---------------------------------------------------------------------------
                align 10h

loc_405270:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                or      [esp+6Ch+var_3C], 80h ; jumptable 00404F65 cases 100,105
                cmp     [esp+6Ch+var_58], 3
                jz      loc_405623
                cmp     [esp+6Ch+var_58], 2
                jz      loc_4055D6
                mov     eax, [ebp+0]
                lea     edx, [ebp+4]
                mov     [esp+6Ch+var_4C], eax
                sar     eax, 1Fh
                cmp     [esp+6Ch+var_58], 1
                mov     [esp+6Ch+var_48], eax
                jz      loc_4056F5
                cmp     [esp+6Ch+var_58], 4
                mov     ebp, edx
                jz      loc_405733

loc_4052B7:                             ; CODE XREF: sub_404E70+355\u2191j
                                        ; sub_404E70+777\u2193j ...
                mov     eax, [esp+6Ch+var_4C]
                lea     ecx, [esp+6Ch+var_40]
                mov     edx, [esp+6Ch+var_48]
                call    sub_403C80
                jmp     loc_404F00
; ---------------------------------------------------------------------------
                align 10h

loc_4052D0:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                movzx   edx, byte ptr [ecx+1] ; jumptable 00404F65 case 73
                cmp     dl, 36h ; '6'
                jz      loc_405655
                cmp     dl, 33h ; '3'
                jz      loc_40558E
                mov     ecx, esi
                mov     [esp+6Ch+var_58], 2
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F4D
; ---------------------------------------------------------------------------
                align 10h

loc_405300:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_3C] ; jumptable 00404F65 case 71
                test    al, 4
                jnz     loc_4051F7

loc_40530C:                             ; CODE XREF: sub_404E70+381\u2191j
                fld     qword ptr [ebp+0]
                lea     ebx, [ebp+8]
                fstp    [esp+6Ch+var_6C] ; _TBYTE
                mov     ebp, ebx
                lea     eax, [esp+6Ch+var_40]
                call    sub_404720
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_405325:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_3C] ; jumptable 00404F65 case 70
                test    al, 4
                jnz     loc_405223

loc_405331:                             ; CODE XREF: sub_404E70+3AD\u2191j
                fld     qword ptr [ebp+0]
                lea     ebx, [ebp+8]
                fstp    [esp+6Ch+var_6C] ; _TBYTE
                mov     ebp, ebx
                lea     eax, [esp+6Ch+var_40]
                call    sub_404640
                jmp     loc_404F00
; ---------------------------------------------------------------------------
                align 10h

loc_405350:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_3C] ; jumptable 00404F65 case 69
                test    al, 4
                jnz     loc_405253

loc_40535C:                             ; CODE XREF: sub_404E70+3DD\u2191j
                fld     qword ptr [ebp+0]
                lea     ebx, [ebp+8]
                fstp    [esp+6Ch+var_6C] ; _TBYTE
                mov     ebp, ebx
                lea     eax, [esp+6Ch+var_40]
                call    sub_404590
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_405375:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     [esp+6Ch+var_34], 0FFFFFFFFh ; jumptable 00404F65 case 67

loc_40537D:                             ; CODE XREF: sub_404E70+1E4\u2191j
                mov     eax, [ebp+0]
                lea     ebx, [ebp+4]
                mov     edx, 1
                lea     ecx, [esp+6Ch+var_40]
                mov     ebp, ebx
                mov     word ptr [esp+6Ch+var_4C], ax
                lea     eax, [esp+6Ch+var_4C]
                call    sub_403A30
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_4053A1:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_3C] ; jumptable 00404F65 case 65
                test    al, 4
                jnz     loc_405163

loc_4053AD:                             ; CODE XREF: sub_404E70+2ED\u2191j
                fld     qword ptr [ebp+0]
                lea     ebx, [ebp+8]
                fstp    [esp+6Ch+var_6C] ; _TBYTE
                mov     ebp, ebx
                lea     eax, [esp+6Ch+var_40]
                call    sub_4048A0
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_4053C6:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_5C] ; jumptable 00404F65 case 48
                test    eax, eax
                jz      loc_405560

def_404F65:                             ; CODE XREF: sub_404E70+EC\u2191j
                                        ; sub_404E70+F5\u2191j
                                        ; DATA XREF: ...
                mov     eax, [esp+6Ch+var_5C] ; jumptable 00404F65 default case, cases 33,34,36,38-41,44,47,49-64,66,68,72,74,75,77-82,84-87,89-96,98,107,109,113,114,118,119,121
                cmp     eax, 4
                jz      loc_4057A6
                sub     edx, 30h ; '0'
                cmp     dl, 9
                ja      loc_4057A6
                test    eax, eax
                jz      loc_405550
                cmp     eax, 2
                jz      loc_4055EC

loc_4053FC:                             ; CODE XREF: sub_404E70+6E8\u2193j
                                        ; sub_404E70+784\u2193j
                mov     eax, [esp+6Ch+var_54]
                test    eax, eax
                jz      short loc_40541F
                mov     eax, [esp+6Ch+var_54]
                mov     eax, [eax]
                test    eax, eax
                js      loc_4055F9
                lea     eax, [eax+eax*4]
                lea     eax, [edi+eax*2-30h]
                mov     edi, [esp+6Ch+var_54]
                mov     [edi], eax

loc_40541F:                             ; CODE XREF: sub_404E70+592\u2191j
                                        ; sub_404E70+5E6\u2193j ...
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                jmp     loc_404F4D
; ---------------------------------------------------------------------------
                align 10h

loc_405430:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                cmp     [esp+6Ch+var_5C], 1 ; jumptable 00404F65 case 46
                jbe     loc_40568C

loc_40543B:                             ; CODE XREF: sub_404E70+626\u2193j
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F4D
; ---------------------------------------------------------------------------
                align 10h

loc_405450:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_5C] ; jumptable 00404F65 case 45
                test    eax, eax
                jnz     short loc_40541F
                or      [esp+6Ch+var_3C], 400h
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                jmp     loc_404F4D
; ---------------------------------------------------------------------------
                align 10h

loc_405470:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_5C] ; jumptable 00404F65 case 43
                test    eax, eax
                jnz     short loc_40541F
                or      [esp+6Ch+var_3C], 100h
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                jmp     loc_404F4D
; ---------------------------------------------------------------------------
                align 10h

loc_405490:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     edi, [esp+6Ch+var_54] ; jumptable 00404F65 case 42
                test    edi, edi
                jz      short loc_40543B
                test    byte ptr [esp+6Ch+var_5C], 5
                jnz     loc_405573
                mov     eax, [ebp+0]
                lea     edi, [ebp+4]
                mov     edx, [esp+6Ch+var_54]
                test    eax, eax
                mov     [edx], eax
                js      loc_405716

loc_4054B7:                             ; CODE XREF: sub_404E70+8BE\u2193j
                movzx   edx, byte ptr [ecx+1]
                mov     ebp, edi
                mov     ecx, esi
                mov     [esp+6Ch+var_54], 0
                jmp     loc_404F4D
; ---------------------------------------------------------------------------
                align 10h

loc_4054D0:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, edi        ; jumptable 00404F65 case 37
                lea     edx, [esp+6Ch+var_40]
                call    sub_4039D0
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_4054E0:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_5C] ; jumptable 00404F65 case 35
                test    eax, eax
                jnz     loc_40541F
                or      [esp+6Ch+var_3C], 800h
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                jmp     loc_404F4D
; ---------------------------------------------------------------------------
                align 10h

loc_405500:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; DATA XREF: .rdata:jpt_404F65\u2193o
                mov     eax, [esp+6Ch+var_5C] ; jumptable 00404F65 case 32
                test    eax, eax
                jnz     loc_40541F
                or      [esp+6Ch+var_3C], 40h
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                jmp     loc_404F4D
; ---------------------------------------------------------------------------
                align 10h

loc_405520:                             ; CODE XREF: sub_404E70+F5\u2191j
                                        ; sub_404E70+1A3\u2191j
                                        ; DATA XREF: ...
                mov     ebx, [ebp+0]    ; jumptable 00404F65 case 83
                lea     edi, [ebp+4]
                test    ebx, ebx
                jz      loc_40570C

loc_40552E:                             ; CODE XREF: sub_404E70+8A1\u2193j
                mov     dword ptr [esp+6Ch+var_6C], ebx ; String
                mov     ebp, edi
                call    wcslen
                lea     ecx, [esp+6Ch+var_40]
                mov     edx, eax
                mov     eax, ebx
                call    sub_403A30
                jmp     loc_404F00
; ---------------------------------------------------------------------------
                align 10h

loc_405550:                             ; CODE XREF: sub_404E70+57D\u2191j
                mov     [esp+6Ch+var_5C], 1
                jmp     loc_4053FC
; ---------------------------------------------------------------------------
                align 10h

loc_405560:                             ; CODE XREF: sub_404E70+55C\u2191j
                or      [esp+6Ch+var_3C], 200h
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                jmp     loc_404F4D
; ---------------------------------------------------------------------------

loc_405573:                             ; CODE XREF: sub_404E70+62D\u2191j
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                mov     [esp+6Ch+var_54], 0
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F4D
; ---------------------------------------------------------------------------

loc_40558E:                             ; CODE XREF: sub_404E70+470\u2191j
                cmp     byte ptr [ecx+2], 32h ; '2'
                jz      loc_40578A
                mov     ecx, esi
                mov     edx, 33h ; '3'
                mov     [esp+6Ch+var_58], 2
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F51
; ---------------------------------------------------------------------------

loc_4055B4:                             ; CODE XREF: sub_404E70+227\u2191j
                mov     [eax], dx
                add     ebp, 4
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_4055BF:                             ; CODE XREF: sub_404E70+322\u2191j
                mov     edi, [ebp+0]
                add     ebp, 4
                mov     [esp+6Ch+var_48], 0
                mov     [esp+6Ch+var_4C], edi
                jmp     loc_4051C2
; ---------------------------------------------------------------------------

loc_4055D6:                             ; CODE XREF: sub_404E70+418\u2191j
                mov     eax, [ebp+0]
                add     ebp, 4
                mov     [esp+6Ch+var_4C], eax
                sar     eax, 1Fh
                mov     [esp+6Ch+var_48], eax
                jmp     loc_4052B7
; ---------------------------------------------------------------------------

loc_4055EC:                             ; CODE XREF: sub_404E70+586\u2191j
                mov     [esp+6Ch+var_5C], 3
                jmp     loc_4053FC
; ---------------------------------------------------------------------------

loc_4055F9:                             ; CODE XREF: sub_404E70+59C\u2191j
                mov     eax, [esp+6Ch+var_54]
                sub     edi, 30h ; '0'
                mov     [eax], edi
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                jmp     loc_404F4D
; ---------------------------------------------------------------------------

loc_40560D:                             ; CODE XREF: sub_404E70+317\u2191j
                mov     ecx, [ebp+0]
                add     ebp, 8
                mov     ebx, [ebp-4]
                mov     [esp+6Ch+var_4C], ecx
                mov     [esp+6Ch+var_48], ebx
                jmp     loc_4051C2
; ---------------------------------------------------------------------------

loc_405623:                             ; CODE XREF: sub_404E70+40D\u2191j
                mov     eax, [ebp+0]
                add     ebp, 8
                mov     edx, [ebp-4]
                mov     [esp+6Ch+var_4C], eax
                mov     [esp+6Ch+var_48], edx
                jmp     loc_4052B7
; ---------------------------------------------------------------------------

loc_405639:                             ; CODE XREF: sub_404E70+277\u2191j
                movzx   edx, byte ptr [ecx+2]
                add     ecx, 2
                mov     [esp+6Ch+var_58], 4
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F4D
; ---------------------------------------------------------------------------

loc_405655:                             ; CODE XREF: sub_404E70+467\u2191j
                cmp     byte ptr [ecx+2], 34h ; '4'
                jz      loc_40576E
                mov     ecx, esi
                mov     edx, 36h ; '6'
                mov     [esp+6Ch+var_58], 2
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F51
; ---------------------------------------------------------------------------

loc_40567B:                             ; CODE XREF: sub_404E70+215\u2191j
                mov     edx, [ebp+0]
                add     ebp, 4
                mov     eax, [esp+6Ch+var_28]
                mov     [edx], al
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_40568C:                             ; CODE XREF: sub_404E70+5C5\u2191j
                lea     eax, [esp+6Ch+var_34]
                mov     [esp+6Ch+var_34], 0
                movzx   edx, byte ptr [ecx+1]
                mov     ecx, esi
                mov     [esp+6Ch+var_54], eax
                mov     [esp+6Ch+var_5C], 2
                jmp     loc_404F4D
; ---------------------------------------------------------------------------

loc_4056AF:                             ; CODE XREF: sub_404E70+1B0\u2191j
                mov     edx, 6
                mov     ebx, offset aNull ; "(null)"
                jmp     loc_405030
; ---------------------------------------------------------------------------

loc_4056BE:                             ; CODE XREF: sub_404E70+2A4\u2191j
                mov     eax, [esp+6Ch+var_50]
                mov     [esp+6Ch+var_34], 8
                mov     [esp+6Ch+var_3C], eax
                jmp     loc_40511A
; ---------------------------------------------------------------------------

loc_4056D3:                             ; CODE XREF: sub_404E70+33F\u2191j
                movzx   ecx, word ptr [esp+6Ch+var_4C]
                mov     ebp, edx
                mov     [esp+6Ch+var_48], 0
                mov     [esp+6Ch+var_4C], ecx
                jmp     loc_4051C2
; ---------------------------------------------------------------------------

loc_4056EB:                             ; CODE XREF: sub_404E70+232\u2191j
                mov     [eax], edx
                add     ebp, 4
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_4056F5:                             ; CODE XREF: sub_404E70+434\u2191j
                movsx   eax, word ptr [esp+6Ch+var_4C]
                mov     ebp, edx
                mov     [esp+6Ch+var_4C], eax
                sar     eax, 1Fh
                mov     [esp+6Ch+var_48], eax
                jmp     loc_4052B7
; ---------------------------------------------------------------------------

loc_40570C:                             ; CODE XREF: sub_404E70+6B8\u2191j
                mov     ebx, offset aNull_0 ; "(null)"
                jmp     loc_40552E
; ---------------------------------------------------------------------------

loc_405716:                             ; CODE XREF: sub_404E70+641\u2191j
                mov     edx, [esp+6Ch+var_5C]
                test    edx, edx
                jnz     loc_4057BB
                or      [esp+6Ch+var_3C], 400h
                neg     [esp+6Ch+var_38]
                jmp     loc_4054B7
; ---------------------------------------------------------------------------

loc_405733:                             ; CODE XREF: sub_404E70+441\u2191j
                movsx   eax, byte ptr [esp+6Ch+var_4C]
                mov     [esp+6Ch+var_4C], eax
                sar     eax, 1Fh
                mov     [esp+6Ch+var_48], eax
                jmp     loc_4052B7
; ---------------------------------------------------------------------------

loc_405748:                             ; CODE XREF: sub_404E70+34C\u2191j
                movzx   edx, byte ptr [esp+6Ch+var_4C]
                mov     [esp+6Ch+var_48], 0
                mov     [esp+6Ch+var_4C], edx
                jmp     loc_4051C2
; ---------------------------------------------------------------------------

loc_40575E:                             ; CODE XREF: sub_404E70+23F\u2191j
                mov     edi, edx
                add     ebp, 4
                sar     edi, 1Fh
                mov     [eax+4], edi
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_40576E:                             ; CODE XREF: sub_404E70+7E9\u2191j
                movzx   edx, byte ptr [ecx+3]
                add     ecx, 3
                mov     [esp+6Ch+var_58], 3
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F4D
; ---------------------------------------------------------------------------

loc_40578A:                             ; CODE XREF: sub_404E70+722\u2191j
                movzx   edx, byte ptr [ecx+3]
                add     ecx, 3
                mov     [esp+6Ch+var_58], 2
                mov     [esp+6Ch+var_5C], 4
                jmp     loc_404F4D
; ---------------------------------------------------------------------------

loc_4057A6:                             ; CODE XREF: sub_404E70+569\u2191j
                                        ; sub_404E70+575\u2191j
                lea     edx, [esp+6Ch+var_40]
                mov     eax, 25h ; '%'
                mov     esi, ebx
                call    sub_4039D0
                jmp     loc_404F00
; ---------------------------------------------------------------------------

loc_4057BB:                             ; CODE XREF: sub_404E70+8AC\u2191j
                mov     [esp+6Ch+var_34], 0FFFFFFFFh
                mov     ebp, edi
                movzx   edx, byte ptr [ecx+1]
                mov     [esp+6Ch+var_54], 0
                mov     ecx, esi
                jmp     loc_404F4D
sub_404E70      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4057E0(LPWSTR lpWideCharStr, LPCCH lpMultiByteStr, int, int, UINT CodePage, int)
sub_4057E0      proc near               ; CODE XREF: sub_405960+79\u2193p
                                        ; .text:00405ACB\u2193p ...

var_C           = dword ptr -0Ch
lpWideCharStr   = dword ptr  8
lpMultiByteStr  = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h
CodePage        = dword ptr  18h
arg_14          = dword ptr  1Ch

                push    ebp
                mov     ebp, esp
                push    esi
                push    ebx
                sub     esp, 30h
                mov     ebx, [ebp+lpMultiByteStr]
                mov     esi, [ebp+arg_C]
                test    ebx, ebx
                jz      loc_405923
                mov     ecx, [ebp+arg_8]
                test    ecx, ecx
                jz      loc_405930
                mov     eax, [esi]
                mov     dword ptr [esi], 0
                mov     [ebp+var_C], eax
                movzx   eax, byte ptr [ebx]
                test    al, al
                jz      loc_4058B0
                cmp     [ebp+arg_14], 1
                jbe     short loc_405890
                cmp     byte ptr [ebp+var_C], 0
                jnz     loc_4058C1
                mov     [esp+4], eax    ; TestChar
                mov     eax, [ebp+CodePage]
                mov     [esp], eax      ; CodePage
                call    IsDBCSLeadByteEx
                sub     esp, 8
                test    eax, eax
                jz      short loc_405890
                cmp     [ebp+arg_8], 1
                jbe     loc_40594C
                mov     eax, [ebp+lpWideCharStr]
                mov     dword ptr [esp+14h], 1 ; cchWideChar
                mov     dword ptr [esp+0Ch], 2 ; cbMultiByte
                mov     [esp+8], ebx    ; lpMultiByteStr
                mov     [esp+10h], eax  ; lpWideCharStr

loc_405862:                             ; CODE XREF: sub_4057E0+102\u2193j
                mov     eax, [ebp+CodePage]
                mov     dword ptr [esp+4], 8 ; dwFlags
                mov     [esp], eax      ; CodePage
                call    MultiByteToWideChar
                sub     esp, 18h
                test    eax, eax
                jz      loc_405937
                lea     esp, [ebp-8]
                mov     eax, 2
                pop     ebx
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_405890:                             ; CODE XREF: sub_4057E0+3B\u2191j
                                        ; sub_4057E0+5B\u2191j
                mov     eax, [ebp+CodePage]
                test    eax, eax
                jnz     short loc_4058E7
                movzx   eax, byte ptr [ebx]
                mov     edx, [ebp+lpWideCharStr]
                mov     [edx], ax
                lea     esp, [ebp-8]
                mov     eax, 1
                pop     ebx
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4058B0:                             ; CODE XREF: sub_4057E0+31\u2191j
                mov     eax, [ebp+lpWideCharStr]
                xor     edx, edx
                mov     [eax], dx
                xor     eax, eax

loc_4058BA:                             ; CODE XREF: sub_4057E0+141\u2193j
                                        ; sub_4057E0+155\u2193j ...
                lea     esp, [ebp-8]
                pop     ebx
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4058C1:                             ; CODE XREF: sub_4057E0+41\u2191j
                mov     byte ptr [ebp+var_C+1], al
                mov     eax, [ebp+lpWideCharStr]
                mov     dword ptr [esp+14h], 1
                mov     dword ptr [esp+0Ch], 2
                mov     [esp+10h], eax
                lea     eax, [ebp+var_C]
                mov     [esp+8], eax
                jmp     loc_405862
; ---------------------------------------------------------------------------

loc_4058E7:                             ; CODE XREF: sub_4057E0+B5\u2191j
                mov     eax, [ebp+lpWideCharStr]
                mov     dword ptr [esp+14h], 1 ; cchWideChar
                mov     dword ptr [esp+0Ch], 1 ; cbMultiByte
                mov     [esp+8], ebx    ; lpMultiByteStr
                mov     [esp+10h], eax  ; lpWideCharStr
                mov     eax, [ebp+CodePage]
                mov     dword ptr [esp+4], 8 ; dwFlags
                mov     [esp], eax      ; CodePage
                call    MultiByteToWideChar
                sub     esp, 18h
                test    eax, eax
                jz      short loc_405937
                mov     eax, 1
                jmp     short loc_4058BA
; ---------------------------------------------------------------------------

loc_405923:                             ; CODE XREF: sub_4057E0+10\u2191j
                lea     esp, [ebp-8]
                xor     eax, eax
                pop     ebx
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_405930:                             ; CODE XREF: sub_4057E0+1B\u2191j
                mov     eax, 0FFFFFFFEh
                jmp     short loc_4058BA
; ---------------------------------------------------------------------------

loc_405937:                             ; CODE XREF: sub_4057E0+9A\u2191j
                                        ; sub_4057E0+13A\u2191j
                call    _errno
                mov     dword ptr [eax], 2Ah ; '*'
                mov     eax, 0FFFFFFFFh
                jmp     loc_4058BA
; ---------------------------------------------------------------------------

loc_40594C:                             ; CODE XREF: sub_4057E0+61\u2191j
                movzx   eax, byte ptr [ebx]
                mov     [esi], al
                mov     eax, 0FFFFFFFEh
                jmp     loc_4058BA
sub_4057E0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


; int __cdecl sub_405960(LPWSTR lpWideCharStr, LPCCH lpMultiByteStr, int, int)
sub_405960      proc near               ; CODE XREF: sub_404190+27B\u2191p
                                        ; sub_4048A0+4C8\u2191p

Category        = dword ptr -3Ch
Locale          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
CodePage        = dword ptr -2Ch
var_28          = dword ptr -28h
var_E           = word ptr -0Eh
lpWideCharStr   = dword ptr  4
lpMultiByteStr  = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    esi
                xor     esi, esi
                push    ebx
                sub     esp, 34h
                mov     ebx, [esp+3Ch+lpWideCharStr]
                mov     [esp+3Ch+var_E], si
                test    ebx, ebx
                jz      short loc_4059E4

loc_405974:                             ; CODE XREF: sub_405960+88\u2193j
                mov     eax, ds:__mb_cur_max
                mov     esi, [eax]
                mov     [esp+3Ch+Locale], 0 ; Locale
                mov     [esp+3Ch+Category], 2 ; Category
                call    setlocale
                mov     [esp+3Ch+Locale], 2Eh ; '.' ; Val
                mov     [esp+3Ch+Category], eax ; Str
                call    strchr
                xor     ecx, ecx
                test    eax, eax
                jz      short loc_4059B2
                add     eax, 1
                mov     [esp+3Ch+Category], eax ; String
                call    atoi
                mov     ecx, eax

loc_4059B2:                             ; CODE XREF: sub_405960+43\u2191j
                mov     edx, [esp+3Ch+arg_C]
                test    edx, edx
                jz      short loc_4059F0

loc_4059BA:                             ; CODE XREF: sub_405960+95\u2193j
                mov     eax, [esp+3Ch+arg_8]
                mov     [esp+3Ch+var_28], esi ; int
                mov     [esp+3Ch+Category], ebx ; lpWideCharStr
                mov     [esp+3Ch+CodePage], ecx ; CodePage
                mov     [esp+3Ch+var_34], eax ; int
                mov     eax, [esp+3Ch+lpMultiByteStr]
                mov     [esp+3Ch+var_30], edx ; int
                mov     [esp+3Ch+Locale], eax ; lpMultiByteStr
                call    sub_4057E0
                add     esp, 34h
                pop     ebx
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_4059E4:                             ; CODE XREF: sub_405960+12\u2191j
                lea     ebx, [esp+3Ch+var_E]
                jmp     short loc_405974
; ---------------------------------------------------------------------------
                align 10h

loc_4059F0:                             ; CODE XREF: sub_405960+58\u2191j
                mov     edx, offset dword_40D078
                jmp     short loc_4059BA
sub_405960      endp

; ---------------------------------------------------------------------------
                align 10h
                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 3Ch
                mov     eax, [esp+5Ch]
                mov     ebx, [esp+50h]
                mov     esi, [esp+54h]
                mov     edi, [esp+58h]
                test    eax, eax
                jz      loc_405B60

loc_405A1F:                             ; CODE XREF: .text:00405B68\u2193j
                mov     dword ptr [esp+4], 0
                mov     dword ptr [esp], 2
                call    setlocale
                mov     dword ptr [esp+4], 2Eh ; '.'
                mov     [esp], eax
                call    strchr
                mov     dword ptr [esp+18h], 0
                test    eax, eax
                jz      short loc_405A5E
                add     eax, 1
                mov     [esp], eax
                call    atoi
                mov     [esp+18h], eax

loc_405A5E:                             ; CODE XREF: .text:00405A4D\u2191j
                mov     eax, ds:__mb_cur_max
                test    esi, esi
                mov     eax, [eax]
                mov     [esp+1Ch], eax
                jz      loc_405B50
                mov     ecx, [esi]
                test    ecx, ecx
                jz      loc_405B50
                test    ebx, ebx
                jz      short loc_405AF0
                test    edi, edi
                jz      loc_405B50
                mov     [esp+54h], esi
                xor     ebp, ebp
                mov     esi, ebx
                mov     ebx, [esp+54h]
                jmp     short loc_405AA4
; ---------------------------------------------------------------------------

loc_405A95:                             ; CODE XREF: .text:00405AD2\u2193j
                mov     ecx, [ebx]
                add     ebp, eax
                add     esi, 2
                add     ecx, eax
                cmp     edi, ebp
                mov     [ebx], ecx
                jbe     short loc_405AD4

loc_405AA4:                             ; CODE XREF: .text:00405A93\u2191j
                mov     eax, [esp+1Ch]
                mov     [esp+4], ecx
                mov     [esp], esi
                mov     [esp+14h], eax
                mov     eax, [esp+18h]
                mov     [esp+10h], eax
                mov     eax, [esp+5Ch]
                mov     [esp+0Ch], eax
                mov     eax, edi
                sub     eax, ebp
                mov     [esp+8], eax
                call    sub_4057E0
                test    eax, eax
                jg      short loc_405A95

loc_405AD4:                             ; CODE XREF: .text:00405AA2\u2191j
                test    eax, eax
                jnz     short loc_405B46
                cmp     ebp, edi
                jnb     short loc_405B46
                mov     dword ptr [ebx], 0
                add     esp, 3Ch
                mov     eax, ebp
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_405AF0:                             ; CODE XREF: .text:00405A7D\u2191j
                xor     ebp, ebp
                mov     [esp+2Eh], bp
                xor     ebp, ebp
                test    edi, edi
                jz      short loc_405B46
                mov     [esp+58h], edi
                lea     ebx, [esp+2Eh]
                mov     edi, esi
                mov     esi, [esp+1Ch]
                jmp     short loc_405B1E
; ---------------------------------------------------------------------------
                align 10h

loc_405B10:                             ; CODE XREF: .text:00405B44\u2193j
                mov     ecx, [edi]
                add     ebp, eax
                add     ecx, eax
                cmp     [esp+58h], ebp
                mov     [edi], ecx
                jbe     short loc_405B46

loc_405B1E:                             ; CODE XREF: .text:00405B0B\u2191j
                mov     eax, [esp+18h]
                mov     [esp+14h], esi
                mov     [esp+8], esi
                mov     [esp+4], ecx
                mov     [esp+10h], eax
                mov     eax, [esp+5Ch]
                mov     [esp], ebx
                mov     [esp+0Ch], eax
                call    sub_4057E0
                test    eax, eax
                jg      short loc_405B10

loc_405B46:                             ; CODE XREF: .text:00405AD6\u2191j
                                        ; .text:00405ADA\u2191j ...
                add     esp, 3Ch
                mov     eax, ebp
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_405B50:                             ; CODE XREF: .text:00405A6B\u2191j
                                        ; .text:00405A75\u2191j ...
                add     esp, 3Ch
                xor     eax, eax
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_405B60:                             ; CODE XREF: .text:00405A19\u2191j
                mov     dword ptr [esp+5Ch], offset dword_40D074
                jmp     loc_405A1F
; ---------------------------------------------------------------------------
                align 10h
                push    ebx
                xor     eax, eax
                sub     esp, 38h
                mov     [esp+2Eh], ax
                mov     eax, ds:__mb_cur_max
                mov     ebx, [eax]
                mov     dword ptr [esp+4], 0
                mov     dword ptr [esp], 2
                call    setlocale
                mov     dword ptr [esp+4], 2Eh ; '.'
                mov     [esp], eax
                call    strchr
                xor     ecx, ecx
                test    eax, eax
                jz      short loc_405BB9
                add     eax, 1
                mov     [esp], eax
                call    atoi
                mov     ecx, eax

loc_405BB9:                             ; CODE XREF: .text:00405BAA\u2191j
                mov     edx, [esp+48h]
                test    edx, edx
                jz      short loc_405BF0

loc_405BC1:                             ; CODE XREF: .text:00405BF5\u2193j
                mov     eax, [esp+44h]
                mov     [esp+14h], ebx
                mov     [esp+10h], ecx
                mov     [esp+0Ch], edx
                mov     [esp+8], eax
                mov     eax, [esp+40h]
                mov     [esp+4], eax
                lea     eax, [esp+2Eh]
                mov     [esp], eax
                call    sub_4057E0
                add     esp, 38h
                pop     ebx
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_405BF0:                             ; CODE XREF: .text:00405BBF\u2191j
                mov     edx, offset dword_40D070
                jmp     short loc_405BC1
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405C00(LPSTR lpMultiByteStr, int, UINT CodePage, int cbMultiByte)
sub_405C00      proc near               ; CODE XREF: sub_405C90+62\u2193p
                                        ; .text:00405DAA\u2193p ...

WideCharStr     = word ptr -1Ch
UsedDefaultChar = dword ptr -0Ch
lpMultiByteStr  = dword ptr  8
arg_4           = dword ptr  0Ch
CodePage        = dword ptr  10h
cbMultiByte     = dword ptr  14h

                push    ebp
                mov     ebp, esp
                sub     esp, 48h
                mov     edx, [ebp+CodePage]
                mov     eax, [ebp+arg_4]
                test    edx, edx
                mov     [ebp+WideCharStr], ax
                jnz     short loc_405C26
                cmp     ax, 0FFh
                ja      short loc_405C77
                mov     ecx, [ebp+lpMultiByteStr]
                mov     [ecx], al
                mov     eax, 1

locret_405C24:                          ; CODE XREF: sub_405C00+75\u2193j
                leave
                retn
; ---------------------------------------------------------------------------

loc_405C26:                             ; CODE XREF: sub_405C00+12\u2191j
                lea     eax, [ebp+UsedDefaultChar]
                mov     [esp+1Ch], eax  ; lpUsedDefaultChar
                mov     eax, [ebp+cbMultiByte]
                mov     dword ptr [esp+18h], 0 ; lpDefaultChar
                mov     dword ptr [esp+0Ch], 1 ; cchWideChar
                mov     dword ptr [esp+4], 0 ; dwFlags
                mov     [esp+14h], eax  ; cbMultiByte
                mov     eax, [ebp+lpMultiByteStr]
                mov     [esp], edx      ; CodePage
                mov     [ebp+UsedDefaultChar], 0
                mov     [esp+10h], eax  ; lpMultiByteStr
                lea     eax, [ebp+WideCharStr]
                mov     [esp+8], eax    ; lpWideCharStr
                call    WideCharToMultiByte
                sub     esp, 20h
                test    eax, eax
                jz      short loc_405C77
                mov     edx, [ebp+UsedDefaultChar]
                test    edx, edx
                jz      short locret_405C24

loc_405C77:                             ; CODE XREF: sub_405C00+18\u2191j
                                        ; sub_405C00+6E\u2191j
                call    _errno
                mov     dword ptr [eax], 2Ah ; '*'
                mov     eax, 0FFFFFFFFh
                leave
                retn
sub_405C00      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


; int __cdecl sub_405C90(LPSTR lpMultiByteStr, int)
sub_405C90      proc near               ; CODE XREF: sub_403A30+26\u2191p
                                        ; sub_403A30+84\u2191p ...

Category        = dword ptr -2Ch
Locale          = dword ptr -28h
CodePage        = dword ptr -24h
cbMultiByte     = dword ptr -20h
var_E           = byte ptr -0Eh
lpMultiByteStr  = dword ptr  4
arg_4           = dword ptr  8

                push    edi
                push    esi
                push    ebx
                sub     esp, 20h
                mov     ebx, [esp+2Ch+lpMultiByteStr]
                mov     esi, [esp+2Ch+arg_4]
                test    ebx, ebx
                jz      short loc_405D00

loc_405CA2:                             ; CODE XREF: sub_405C90+74\u2193j
                mov     eax, ds:__mb_cur_max
                mov     edi, [eax]
                mov     [esp+2Ch+Locale], 0 ; Locale
                mov     [esp+2Ch+Category], 2 ; Category
                call    setlocale
                mov     [esp+2Ch+Locale], 2Eh ; '.' ; Val
                mov     [esp+2Ch+Category], eax ; Str
                call    strchr
                xor     edx, edx
                test    eax, eax
                jz      short loc_405CE0
                add     eax, 1
                mov     [esp+2Ch+Category], eax ; String
                call    atoi
                mov     edx, eax

loc_405CE0:                             ; CODE XREF: sub_405C90+41\u2191j
                movzx   esi, si
                mov     [esp+2Ch+cbMultiByte], edi ; cbMultiByte
                mov     [esp+2Ch+Locale], esi ; int
                mov     [esp+2Ch+Category], ebx ; lpMultiByteStr
                mov     [esp+2Ch+CodePage], edx ; CodePage
                call    sub_405C00
                add     esp, 20h
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_405D00:                             ; CODE XREF: sub_405C90+10\u2191j
                lea     ebx, [esp+2Ch+var_E]
                jmp     short loc_405CA2
sub_405C90      endp

; ---------------------------------------------------------------------------
                align 10h
                push    ebp
                push    edi
                push    esi
                xor     esi, esi
                push    ebx
                sub     esp, 3Ch
                mov     dword ptr [esp+4], 0
                mov     ebx, [esp+50h]
                mov     dword ptr [esp], 2
                call    setlocale
                mov     dword ptr [esp+4], 2Eh ; '.'
                mov     [esp], eax
                call    strchr
                test    eax, eax
                jz      short loc_405D52
                add     eax, 1
                mov     [esp], eax
                call    atoi
                mov     esi, eax

loc_405D52:                             ; CODE XREF: .text:00405D43\u2191j
                mov     eax, ds:__mb_cur_max
                mov     eax, [eax]
                mov     [esp+1Ch], eax
                mov     eax, [esp+54h]
                mov     edi, [eax]
                test    edi, edi
                jz      loc_405E37
                xor     ebp, ebp
                test    ebx, ebx
                jz      short loc_405DE7
                mov     ecx, [esp+58h]
                test    ecx, ecx
                jz      short loc_405DC2
                mov     eax, esi
                mov     esi, edi
                mov     edi, eax
                jmp     short loc_405D94
; ---------------------------------------------------------------------------

loc_405D81:                             ; CODE XREF: .text:00405DB1\u2193j
                add     ebx, eax
                add     ebp, eax
                cmp     byte ptr [ebx-1], 0
                jz      short loc_405DD2
                add     esi, 2
                cmp     [esp+58h], ebp
                jbe     short loc_405DC0

loc_405D94:                             ; CODE XREF: .text:00405D7F\u2191j
                mov     eax, [esp+1Ch]
                mov     [esp+8], edi
                mov     [esp+0Ch], eax
                movzx   eax, word ptr [esi]
                mov     [esp], ebx
                mov     [esp+4], eax
                call    sub_405C00
                test    eax, eax
                jg      short loc_405D81

loc_405DB3:                             ; CODE XREF: .text:00405E32\u2193j
                mov     eax, 0FFFFFFFFh

loc_405DB8:                             ; CODE XREF: .text:00405E44\u2193j
                                        ; .text:00405E4D\u2193j ...
                add     esp, 3Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_405DC0:                             ; CODE XREF: .text:00405D92\u2191j
                mov     edi, esi

loc_405DC2:                             ; CODE XREF: .text:00405D77\u2191j
                mov     eax, [esp+54h]
                mov     [eax], edi
                add     esp, 3Ch
                mov     eax, ebp
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_405DD2:                             ; CODE XREF: .text:00405D89\u2191j
                mov     eax, [esp+54h]
                mov     dword ptr [eax], 0
                add     esp, 3Ch
                pop     ebx
                lea     eax, [ebp-1]
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_405DE7:                             ; CODE XREF: .text:00405D6F\u2191j
                mov     eax, [esp+58h]
                test    eax, eax
                jz      short loc_405E52
                mov     eax, ebp
                mov     ebx, [esp+1Ch]
                mov     ebp, edi
                mov     edi, eax
                jmp     short loc_405E12
; ---------------------------------------------------------------------------
                align 10h

loc_405E00:                             ; CODE XREF: .text:00405E30\u2193j
                add     edi, eax
                cmp     byte ptr [esp+eax+2Dh], 0
                jz      short loc_405E41
                add     ebp, 2
                cmp     [esp+58h], edi
                jbe     short loc_405E49

loc_405E12:                             ; CODE XREF: .text:00405DF9\u2191j
                mov     [esp+0Ch], ebx
                mov     [esp+8], esi
                movzx   eax, word ptr [ebp+0]
                mov     [esp+4], eax
                lea     eax, [esp+2Eh]
                mov     [esp], eax
                call    sub_405C00
                test    eax, eax
                jg      short loc_405E00
                jmp     loc_405DB3
; ---------------------------------------------------------------------------

loc_405E37:                             ; CODE XREF: .text:00405D65\u2191j
                add     esp, 3Ch
                xor     eax, eax
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_405E41:                             ; CODE XREF: .text:00405E07\u2191j
                lea     eax, [edi-1]
                jmp     loc_405DB8
; ---------------------------------------------------------------------------

loc_405E49:                             ; CODE XREF: .text:00405E10\u2191j
                mov     ebp, edi
                mov     eax, ebp
                jmp     loc_405DB8
; ---------------------------------------------------------------------------

loc_405E52:                             ; CODE XREF: .text:00405DED\u2191j
                mov     ebp, ebx
                mov     eax, ebp
                jmp     loc_405DB8
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_405E60      proc near               ; CODE XREF: sub_4038D0+A7\u2191p

var_7C          = dword ptr -7Ch
Src             = dword ptr -78h
Size            = dword ptr -74h
var_70          = dword ptr -70h
var_6C          = qword ptr -6Ch
var_64          = dword ptr -64h
var_60          = dword ptr -60h
var_5C          = dword ptr -5Ch
var_58          = dword ptr -58h
var_54          = dword ptr -54h
var_50          = dword ptr -50h
var_4C          = dword ptr -4Ch
var_48          = dword ptr -48h
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = word ptr -30h
var_2E          = word ptr -2Eh
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
arg_18          = dword ptr  1Ch
arg_1C          = dword ptr  20h

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 6Ch
                mov     eax, [esp+7Ch+arg_C]
                mov     ebx, [esp+7Ch+arg_C]
                mov     esi, [eax]
                mov     eax, esi
                and     eax, 0FFFFFFCFh
                mov     [ebx], eax
                mov     eax, esi
                and     eax, 7
                cmp     eax, 4          ; switch 5 cases
                ja      def_405E8C      ; jumptable 00405E8C default case
                jmp     ds:jpt_405E8C[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_405E93:                             ; CODE XREF: sub_405E60+2C\u2191j
                                        ; DATA XREF: .rdata:jpt_405E8C\u2193o
                mov     eax, [esp+7Ch+arg_0] ; jumptable 00405E8C cases 1,2
                xor     edx, edx
                mov     edi, [eax]
                cmp     edi, 20h ; ' '
                jle     short loc_405EB1
                mov     eax, 20h ; ' '

loc_405EA8:                             ; CODE XREF: sub_405E60+4F\u2193j
                add     eax, eax
                add     edx, 1
                cmp     edi, eax
                jg      short loc_405EA8

loc_405EB1:                             ; CODE XREF: sub_405E60+41\u2191j
                mov     [esp+7Ch+var_7C], edx
                call    sub_407830
                mov     ecx, [esp+7Ch+arg_8]
                mov     ebx, eax
                lea     eax, [edi-1]
                sar     eax, 5
                lea     ebp, [ecx+eax*4]
                mov     eax, [esp+7Ch+arg_8]
                lea     ecx, [ebx+14h]
                mov     edx, ecx
                mov     [esp+7Ch+var_70], ecx
                nop
                lea     esi, [esi+0]

loc_405EE0:                             ; CODE XREF: sub_405E60+8D\u2193j
                mov     ecx, [eax]
                add     eax, 4
                add     edx, 4
                cmp     ebp, eax
                mov     [edx-4], ecx
                jnb     short loc_405EE0
                mov     ecx, [esp+7Ch+var_70]
                sub     edx, ecx
                sar     edx, 2
                jmp     short loc_405F0A
; ---------------------------------------------------------------------------
                align 10h

loc_405F00:                             ; CODE XREF: sub_405E60+B2\u2193j
                test    eax, eax
                jz      loc_406376
                mov     edx, eax

loc_405F0A:                             ; CODE XREF: sub_405E60+98\u2191j
                lea     eax, [edx-1]
                mov     ebp, [ecx+eax*4]
                test    ebp, ebp
                jz      short loc_405F00
                bsr     eax, [ebx+edx*4+10h]
                mov     [ebx+10h], edx
                shl     edx, 5
                mov     ebp, edx
                xor     eax, 1Fh
                sub     ebp, eax

loc_405F26:                             ; CODE XREF: sub_405E60+51F\u2193j
                mov     [esp+7Ch+var_7C], ebx
                call    sub_407420
                mov     ecx, [esp+7Ch+arg_4]
                mov     [esp+7Ch+var_5C], ecx
                test    eax, eax
                mov     [esp+7Ch+var_20], eax
                jnz     loc_406384

loc_405F45:                             ; CODE XREF: sub_405E60+543\u2193j
                mov     ecx, [ebx+10h]
                test    ecx, ecx
                jnz     loc_405FF8
                mov     [esp+7Ch+var_7C], ebx
                call    sub_407900

loc_405F58:                             ; CODE XREF: sub_405E60+2C\u2191j
                                        ; DATA XREF: .rdata:jpt_405E8C\u2193o
                mov     eax, [esp+7Ch+arg_18] ; jumptable 00405E8C case 0
                mov     dword ptr [eax], 1
                mov     eax, [esp+7Ch+arg_1C]
                mov     [esp+7Ch+Size], 1
                mov     [esp+7Ch+var_7C], offset a0 ; "0"
                mov     [esp+7Ch+Src], eax
                call    sub_4074A0

loc_405F84:                             ; CODE XREF: sub_405E60+1490\u2193j
                add     esp, 6Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_405F90:                             ; CODE XREF: sub_405E60+2C\u2191j
                                        ; DATA XREF: .rdata:jpt_405E8C\u2193o
                mov     eax, [esp+7Ch+arg_18] ; jumptable 00405E8C case 4
                mov     dword ptr [eax], 0FFFF8000h
                mov     eax, [esp+7Ch+arg_1C]
                mov     [esp+7Ch+Size], 3
                mov     [esp+7Ch+var_7C], offset aNan_0 ; "NaN"
                mov     [esp+7Ch+Src], eax
                call    sub_4074A0
                add     esp, 6Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_405FC4:                             ; CODE XREF: sub_405E60+2C\u2191j
                                        ; DATA XREF: .rdata:jpt_405E8C\u2193o
                mov     eax, [esp+7Ch+arg_18] ; jumptable 00405E8C case 3
                mov     dword ptr [eax], 0FFFF8000h
                mov     eax, [esp+7Ch+arg_1C]
                mov     [esp+7Ch+Size], 8
                mov     [esp+7Ch+var_7C], offset aInfinity ; "Infinity"
                mov     [esp+7Ch+Src], eax
                call    sub_4074A0
                add     esp, 6Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_405FF8:                             ; CODE XREF: sub_405E60+EA\u2191j
                lea     eax, [esp+7Ch+var_20]
                mov     [esp+7Ch+Src], eax
                mov     [esp+7Ch+var_7C], ebx
                call    sub_408050
                mov     eax, [esp+7Ch+var_5C]
                lea     edx, [eax+ebp-1]
                mov     [esp+7Ch+var_34], edx
                mov     eax, edx
                fstp    [esp+7Ch+var_6C]
                mov     ecx, dword ptr [esp+7Ch+var_6C+4]
                sar     eax, 1Fh
                mov     [esp+7Ch+var_70], eax
                xor     eax, edx
                sub     eax, [esp+7Ch+var_70]
                and     ecx, 0FFFFFh
                or      ecx, 3FF00000h
                mov     dword ptr [esp+7Ch+var_6C+4], ecx
                sub     eax, 435h
                fld     [esp+7Ch+var_6C]
                test    eax, eax
                fsub    ds:flt_40A45C
                fmul    ds:dbl_40A460
                fadd    ds:dbl_40A468
                fild    [esp+7Ch+var_34]
                fmul    ds:dbl_40A470
                faddp   st(1), st
                jle     short loc_406076
                mov     [esp+7Ch+var_34], eax
                fild    [esp+7Ch+var_34]
                fmul    ds:dbl_40A478
                faddp   st(1), st

loc_406076:                             ; CODE XREF: sub_405E60+204\u2191j
                fnstcw  [esp+7Ch+var_2E]
                movzx   eax, [esp+7Ch+var_2E]
                mov     ah, 0Ch
                mov     [esp+7Ch+var_30], ax
                fldcw   [esp+7Ch+var_30]
                fist    [esp+7Ch+var_70]
                fldcw   [esp+7Ch+var_2E]
                fldz
                fucomp  st(1)
                fnstsw  ax
                sahf
                ja      loc_406815
                fstp    st

loc_4060A1:                             ; CODE XREF: sub_405E60+9C0\u2193j
                                        ; sub_405E60+9CB\u2193j
                mov     eax, edx
                shl     eax, 14h
                add     eax, ecx
                cmp     [esp+7Ch+var_70], 16h
                mov     dword ptr [esp+7Ch+var_6C+4], eax
                mov     [esp+7Ch+var_48], 1
                ja      short loc_4060E4
                mov     eax, [esp+7Ch+var_70]
                fld     ds:dbl_40A4C0[eax*8]
                fld     [esp+7Ch+var_6C]
                fxch    st(1)
                fucompp
                fnstsw  ax
                sahf
                jbe     loc_406744
                sub     [esp+7Ch+var_70], 1
                mov     [esp+7Ch+var_48], 0

loc_4060E4:                             ; CODE XREF: sub_405E60+259\u2191j
                                        ; sub_405E60+8EC\u2193j
                mov     eax, ebp
                sub     eax, edx
                sub     eax, 1
                mov     [esp+7Ch+var_54], 0
                mov     [esp+7Ch+var_60], eax
                js      loc_406802

loc_4060FD:                             ; CODE XREF: sub_405E60+9B0\u2193j
                mov     eax, [esp+7Ch+var_70]
                test    eax, eax
                js      loc_4067E7
                add     [esp+7Ch+var_60], eax
                mov     [esp+7Ch+var_40], eax
                mov     [esp+7Ch+var_4C], 0

loc_406119:                             ; CODE XREF: sub_405E60+99D\u2193j
                cmp     [esp+7Ch+arg_10], 9
                ja      loc_4063A8
                cmp     [esp+7Ch+arg_10], 5
                jle     loc_4072F5
                sub     [esp+7Ch+arg_10], 4
                xor     eax, eax

loc_40613F:                             ; CODE XREF: sub_405E60+149A\u2193j
                cmp     [esp+7Ch+arg_10], 3
                jz      loc_40675E
                jle     loc_40676B
                cmp     [esp+7Ch+arg_10], 4
                mov     [esp+7Ch+var_3C], 1
                jz      loc_406781
                cmp     [esp+7Ch+arg_10], 5
                jnz     loc_4063B3

loc_406177:                             ; CODE XREF: sub_405E60+906\u2193j
                mov     ecx, [esp+7Ch+var_70]
                add     ecx, [esp+7Ch+arg_14]
                mov     [esp+7Ch+var_38], ecx
                add     ecx, 1
                test    ecx, ecx
                mov     [esp+7Ch+var_64], ecx
                jle     loc_406C78
                cmp     ecx, 0Eh
                setbe   dl
                and     edx, eax
                mov     eax, ecx
                mov     [esp+7Ch+var_20], ecx

loc_4061A3:                             ; CODE XREF: sub_405E60+59D\u2193j
                                        ; sub_405E60+952\u2193j ...
                mov     [esp+7Ch+var_7C], eax
                mov     [esp+7Ch+var_44], edx
                call    sub_407460
                mov     edx, [esp+7Ch+var_44]
                mov     [esp+7Ch+var_58], eax
                mov     eax, [esp+7Ch+arg_0]
                mov     eax, [eax+0Ch]
                sub     eax, 1
                mov     [esp+7Ch+var_50], eax
                jz      short loc_4061D9
                js      loc_406751

loc_4061D0:                             ; CODE XREF: sub_405E60+8F9\u2193j
                and     esi, 8
                jnz     loc_406732

loc_4061D9:                             ; CODE XREF: sub_405E60+368\u2191j
                                        ; sub_405E60+8DF\u2193j
                test    dl, dl
                nop
                lea     esi, [esi+0]
                jz      loc_406456
                mov     eax, [esp+7Ch+var_50]
                or      eax, [esp+7Ch+var_70]
                jnz     loc_406456
                mov     eax, [esp+7Ch+var_48]
                mov     [esp+7Ch+var_20], 0
                fld     [esp+7Ch+var_6C]
                test    eax, eax
                jz      short loc_406215
                fld1
                fucomp  st(1)
                fnstsw  ax
                sahf
                ja      loc_406FFC

loc_406215:                             ; CODE XREF: sub_405E60+3A6\u2191j
                fld     st
                mov     esi, [esp+7Ch+var_64]
                fadd    st, st(1)
                fadd    ds:flt_40A494
                fstp    [esp+7Ch+var_6C]
                sub     dword ptr [esp+7Ch+var_6C+4], 3400000h
                test    esi, esi
                jz      loc_406418
                mov     edx, [esp+7Ch+var_64]
                fld     st
                mov     [esp+7Ch+var_44], 0

loc_406245:                             ; CODE XREF: sub_405E60+11DE\u2193j
                mov     ecx, [esp+7Ch+var_3C]
                test    ecx, ecx
                jz      loc_406CA9
                fld     ds:flt_40A49C
                fdiv    ds:dbl_40A4B8[edx*8]
                fnstcw  [esp+7Ch+var_2E]
                mov     [esp+7Ch+var_20], 0
                movzx   eax, [esp+7Ch+var_2E]
                mov     ah, 0Ch
                mov     [esp+7Ch+var_30], ax
                mov     eax, [esp+7Ch+var_58]
                lea     esi, [eax+1]
                fsub    [esp+7Ch+var_6C]
                fxch    st(1)
                fldcw   [esp+7Ch+var_30]
                fist    [esp+7Ch+var_34]
                fldcw   [esp+7Ch+var_2E]
                mov     ecx, [esp+7Ch+var_34]
                mov     [esp+7Ch+var_34], ecx
                add     ecx, 30h ; '0'
                fild    [esp+7Ch+var_34]
                fsubp   st(1), st
                fxch    st(1)
                mov     [eax], cl
                fucom   st(1)
                fnstsw  ax
                sahf
                ja      loc_406349
                fld     st(1)
                fsubr   ds:flt_40A488
                fxch    st(1)
                fucom   st(1)
                fnstsw  ax
                fstp    st(1)
                sahf
                ja      loc_406DB7
                mov     eax, [esp+7Ch+var_20]
                add     eax, 1
                cmp     edx, eax
                mov     [esp+7Ch+var_20], eax
                jle     loc_406442
                fld     ds:flt_40A48C
                jmp     short loc_40630F
; ---------------------------------------------------------------------------

loc_4062E1:                             ; CODE XREF: sub_405E60+4DF\u2193j
                fld     st(1)
                fsubr   ds:flt_40A488
                fxch    st(1)
                fucom   st(1)
                fnstsw  ax
                fstp    st(1)
                sahf
                ja      loc_406DBF
                mov     eax, [esp+7Ch+var_20]
                add     eax, 1
                cmp     edx, eax
                mov     [esp+7Ch+var_20], eax
                jle     loc_406448
                fxch    st(1)
                fxch    st(2)

loc_40630F:                             ; CODE XREF: sub_405E60+47F\u2191j
                fmul    st(1), st
                add     esi, 1
                fmul    st(2), st
                fxch    st(2)
                fldcw   [esp+7Ch+var_30]
                fist    [esp+7Ch+var_34]
                fldcw   [esp+7Ch+var_2E]
                mov     eax, [esp+7Ch+var_34]
                mov     [esp+7Ch+var_34], eax
                lea     ecx, [eax+30h]
                fild    [esp+7Ch+var_34]
                fsubp   st(1), st
                fxch    st(1)
                mov     [esi-1], cl
                fucom   st(1)
                fnstsw  ax
                sahf
                jbe     short loc_4062E1
                fstp    st
                fstp    st(1)
                fstp    st(1)
                jmp     short loc_40634D
; ---------------------------------------------------------------------------

loc_406349:                             ; CODE XREF: sub_405E60+449\u2191j
                fstp    st
                fstp    st(1)

loc_40634D:                             ; CODE XREF: sub_405E60+4E7\u2191j
                fldz
                fxch    st(1)
                fucompp
                fnstsw  ax
                sahf
                mov     eax, [esp+7Ch+var_44]
                jp      short loc_406362
                jz      loc_40690F

loc_406362:                             ; CODE XREF: sub_405E60+4FA\u2191j
                                        ; sub_405E60+DFE\u2193j
                add     eax, 1
                mov     [esp+7Ch+var_70], eax
                mov     [esp+7Ch+var_64], 10h
                jmp     loc_4066ED
; ---------------------------------------------------------------------------

loc_406376:                             ; CODE XREF: sub_405E60+A2\u2191j
                mov     dword ptr [ebx+10h], 0
                xor     ebp, ebp
                jmp     loc_405F26
; ---------------------------------------------------------------------------

loc_406384:                             ; CODE XREF: sub_405E60+DF\u2191j
                mov     [esp+7Ch+Src], eax
                mov     [esp+7Ch+var_7C], ebx
                call    sub_407300
                mov     eax, [esp+7Ch+var_20]
                mov     ecx, [esp+7Ch+arg_4]
                sub     ebp, eax
                add     ecx, eax
                mov     [esp+7Ch+var_5C], ecx
                jmp     loc_405F45
; ---------------------------------------------------------------------------

loc_4063A8:                             ; CODE XREF: sub_405E60+2C1\u2191j
                mov     [esp+7Ch+arg_10], 0

loc_4063B3:                             ; CODE XREF: sub_405E60+311\u2191j
                                        ; sub_405E60+91B\u2193j
                mov     [esp+7Ch+var_34], edi
                xor     edx, edx
                fild    [esp+7Ch+var_34]
                fmul    ds:dbl_40A480
                mov     [esp+7Ch+var_3C], 1
                mov     [esp+7Ch+var_38], 0FFFFFFFFh
                mov     [esp+7Ch+var_64], 0FFFFFFFFh
                mov     [esp+7Ch+arg_14], 0
                fldcw   [esp+7Ch+var_30]
                fistp   [esp+7Ch+var_34]
                fldcw   [esp+7Ch+var_2E]
                mov     eax, [esp+7Ch+var_34]
                add     eax, 3
                mov     [esp+7Ch+var_20], eax
                jmp     loc_4061A3
; ---------------------------------------------------------------------------

loc_406402:                             ; CODE XREF: sub_405E60+11A2\u2193j
                fld     st
                fadd    st, st(1)
                fadd    ds:flt_40A494
                fstp    [esp+7Ch+var_6C]
                sub     dword ptr [esp+7Ch+var_6C+4], 3400000h

loc_406418:                             ; CODE XREF: sub_405E60+3D1\u2191j
                fld     st
                fsub    ds:flt_40A498
                fld     [esp+7Ch+var_6C]
                fxch    st(1)
                fucom   st(1)
                fnstsw  ax
                sahf
                ja      loc_406D83
                fxch    st(1)
                fchs
                fucompp
                fnstsw  ax
                sahf
                ja      loc_4067B7
                jmp     short loc_406452
; ---------------------------------------------------------------------------

loc_406442:                             ; CODE XREF: sub_405E60+473\u2191j
                fstp    st
                fstp    st
                jmp     short loc_406452
; ---------------------------------------------------------------------------

loc_406448:                             ; CODE XREF: sub_405E60+4A5\u2191j
                fstp    st
                fstp    st
                fstp    st
                jmp     short loc_406452
; ---------------------------------------------------------------------------

loc_406450:                             ; CODE XREF: sub_405E60+EDE\u2193j
                fstp    st

loc_406452:                             ; CODE XREF: sub_405E60+5E0\u2191j
                                        ; sub_405E60+5E6\u2191j ...
                fstp    [esp+7Ch+var_6C]

loc_406456:                             ; CODE XREF: sub_405E60+380\u2191j
                                        ; sub_405E60+38E\u2191j
                cmp     [esp+7Ch+var_70], 0Eh
                jle     loc_406640

loc_406461:                             ; CODE XREF: sub_405E60+7E6\u2193j
                mov     eax, [esp+7Ch+var_3C]
                test    eax, eax
                jz      loc_406830
                cmp     [esp+7Ch+arg_10], 1
                jle     loc_406E0E
                mov     eax, [esp+7Ch+var_64]
                sub     eax, 1
                cmp     [esp+7Ch+var_4C], eax
                jl      loc_406C94
                mov     edi, [esp+7Ch+var_4C]
                sub     edi, eax

loc_406492:                             ; CODE XREF: sub_405E60+E44\u2193j
                mov     eax, [esp+7Ch+var_64]
                test    eax, eax
                js      loc_406EB3
                mov     esi, [esp+7Ch+var_54]
                mov     [esp+7Ch+var_20], eax

loc_4064A6:                             ; CODE XREF: sub_405E60+FE4\u2193j
                                        ; sub_405E60+1065\u2193j ...
                mov     [esp+7Ch+var_7C], 1
                add     [esp+7Ch+var_54], eax
                add     [esp+7Ch+var_60], eax
                call    sub_407A50
                mov     [esp+7Ch+var_5C], eax

loc_4064BE:                             ; CODE XREF: sub_405E60+9E0\u2193j
                mov     eax, [esp+7Ch+var_60]
                test    eax, eax
                jle     short loc_4064E4
                test    esi, esi
                jle     short loc_4064E4
                mov     ecx, [esp+7Ch+var_60]
                cmp     ecx, esi
                mov     eax, ecx
                jle     short loc_4064D6
                mov     eax, esi

loc_4064D6:                             ; CODE XREF: sub_405E60+672\u2191j
                sub     [esp+7Ch+var_54], eax
                sub     esi, eax
                sub     [esp+7Ch+var_60], eax
                mov     [esp+7Ch+var_20], eax

loc_4064E4:                             ; CODE XREF: sub_405E60+664\u2191j
                                        ; sub_405E60+668\u2191j
                mov     ecx, [esp+7Ch+var_4C]
                test    ecx, ecx
                jle     short loc_40653A
                mov     edx, [esp+7Ch+var_3C]
                test    edx, edx
                jz      loc_406AD5
                test    edi, edi
                jle     short loc_40652E
                mov     eax, [esp+7Ch+var_5C]
                mov     [esp+7Ch+Src], edi
                mov     [esp+7Ch+var_7C], eax
                call    sub_407BE0
                mov     [esp+7Ch+Src], ebx
                mov     [esp+7Ch+var_7C], eax
                mov     [esp+7Ch+var_5C], eax
                call    sub_407A80
                mov     [esp+7Ch+var_7C], ebx
                mov     dword ptr [esp+7Ch+var_6C], eax
                call    sub_407900
                mov     eax, dword ptr [esp+7Ch+var_6C]
                mov     ebx, eax

loc_40652E:                             ; CODE XREF: sub_405E60+69A\u2191j
                mov     eax, [esp+7Ch+var_4C]
                sub     eax, edi
                jnz     loc_406AD9

loc_40653A:                             ; CODE XREF: sub_405E60+68A\u2191j
                                        ; sub_405E60+C87\u2193j
                mov     [esp+7Ch+var_7C], 1
                call    sub_407A50
                mov     edi, eax
                mov     eax, [esp+7Ch+var_40]
                test    eax, eax
                jle     short loc_40655E
                mov     [esp+7Ch+var_7C], edi
                mov     [esp+7Ch+Src], eax
                call    sub_407BE0
                mov     edi, eax

loc_40655E:                             ; CODE XREF: sub_405E60+6EE\u2191j
                cmp     [esp+7Ch+arg_10], 1
                mov     dword ptr [esp+7Ch+var_6C], 0
                jle     loc_406C03

loc_406574:                             ; CODE XREF: sub_405E60+DA6\u2193j
                                        ; sub_405E60+DC0\u2193j ...
                mov     eax, [esp+7Ch+var_40]
                mov     ebp, 1Fh
                test    eax, eax
                jz      short loc_40658C
                mov     eax, [edi+10h]
                bsr     ebp, [edi+eax*4+10h]
                xor     ebp, 1Fh

loc_40658C:                             ; CODE XREF: sub_405E60+71F\u2191j
                sub     ebp, [esp+7Ch+var_60]
                mov     edx, [esp+7Ch+var_54]
                sub     ebp, 4
                and     ebp, 1Fh
                add     edx, ebp
                mov     eax, ebp
                test    edx, edx
                mov     [esp+7Ch+var_20], ebp
                jle     short loc_4065B8
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Src], edx
                call    sub_407D70
                mov     ebx, eax
                mov     eax, [esp+7Ch+var_20]

loc_4065B8:                             ; CODE XREF: sub_405E60+744\u2191j
                add     eax, [esp+7Ch+var_60]
                test    eax, eax
                jle     short loc_4065CE
                mov     [esp+7Ch+var_7C], edi
                mov     [esp+7Ch+Src], eax
                call    sub_407D70
                mov     edi, eax

loc_4065CE:                             ; CODE XREF: sub_405E60+75E\u2191j
                mov     eax, [esp+7Ch+var_48]
                test    eax, eax
                jnz     loc_406AEC

loc_4065DA:                             ; CODE XREF: sub_405E60+C9A\u2193j
                cmp     [esp+7Ch+arg_10], 2
                jle     loc_406923
                mov     eax, [esp+7Ch+var_64]
                test    eax, eax
                jg      loc_406923

loc_4065F4:                             ; CODE XREF: sub_405E60+146E\u2193j
                mov     eax, [esp+7Ch+var_64]
                test    eax, eax
                jnz     loc_4067C7
                mov     [esp+7Ch+var_7C], edi
                mov     [esp+7Ch+Size], 0
                mov     [esp+7Ch+Src], 5
                call    sub_407970
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Src], eax
                mov     edi, eax
                call    sub_407E80
                test    eax, eax
                jle     loc_4067C7
                mov     eax, [esp+7Ch+var_70]
                add     eax, 2
                mov     [esp+7Ch+var_70], eax
                jmp     short loc_4066AD
; ---------------------------------------------------------------------------
                align 10h

loc_406640:                             ; CODE XREF: sub_405E60+5FB\u2191j
                mov     eax, [esp+7Ch+var_5C]
                test    eax, eax
                js      loc_406461
                mov     eax, [esp+7Ch+var_70]
                fld     ds:dbl_40A4C0[eax*8]
                mov     eax, [esp+7Ch+var_64]
                test    eax, eax
                jg      loc_406845
                mov     eax, [esp+7Ch+arg_14]
                shr     eax, 1Fh
                test    al, al
                jz      loc_406845
                mov     eax, [esp+7Ch+var_64]
                test    eax, eax
                jnz     loc_4067BB
                fmul    ds:flt_40A498
                fld     [esp+7Ch+var_6C]
                fxch    st(1)
                fucompp
                fnstsw  ax
                sahf
                jnb     loc_4067BD
                mov     eax, [esp+7Ch+var_70]
                xor     edi, edi
                mov     [esp+7Ch+var_5C], 0
                add     eax, 2
                mov     [esp+7Ch+var_70], eax

loc_4066AD:                             ; CODE XREF: sub_405E60+7D9\u2191j
                                        ; sub_405E60+F3B\u2193j
                mov     eax, [esp+7Ch+var_58]
                xor     edx, edx
                mov     [esp+7Ch+var_64], 20h ; ' '
                lea     esi, [eax+1]
                mov     byte ptr [eax], 31h ; '1'

loc_4066C1:                             ; CODE XREF: sub_405E60+982\u2193j
                                        ; sub_405E60+D9E\u2193j ...
                mov     [esp+7Ch+var_7C], edi
                mov     dword ptr [esp+7Ch+var_6C], edx
                call    sub_407900
                mov     eax, [esp+7Ch+var_5C]
                test    eax, eax
                jz      short loc_4066ED
                mov     edx, dword ptr [esp+7Ch+var_6C]
                cmp     edx, eax
                jnz     loc_406ABE

loc_4066E1:                             ; CODE XREF: sub_405E60+C60\u2193j
                                        ; sub_405E60+C70\u2193j
                mov     eax, [esp+7Ch+var_5C]
                mov     [esp+7Ch+var_7C], eax
                call    sub_407900

loc_4066ED:                             ; CODE XREF: sub_405E60+511\u2191j
                                        ; sub_405E60+873\u2191j ...
                mov     [esp+7Ch+var_7C], ebx
                call    sub_407900
                mov     eax, [esp+7Ch+arg_18]
                mov     edi, [esp+7Ch+var_70]
                mov     byte ptr [esi], 0
                mov     [eax], edi
                mov     eax, [esp+7Ch+arg_1C]
                test    eax, eax
                jz      short loc_406719
                mov     eax, [esp+7Ch+arg_1C]
                mov     [eax], esi

loc_406719:                             ; CODE XREF: sub_405E60+8AE\u2191j
                mov     eax, [esp+7Ch+arg_C]
                mov     edi, [esp+7Ch+var_64]
                or      [eax], edi
                mov     eax, [esp+7Ch+var_58]
                add     esp, 6Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_406732:                             ; CODE XREF: sub_405E60+373\u2191j
                mov     eax, 3
                sub     eax, [esp+7Ch+var_50]
                mov     [esp+7Ch+var_50], eax
                jmp     loc_4061D9
; ---------------------------------------------------------------------------

loc_406744:                             ; CODE XREF: sub_405E60+271\u2191j
                mov     [esp+7Ch+var_48], 0
                jmp     loc_4060E4
; ---------------------------------------------------------------------------

loc_406751:                             ; CODE XREF: sub_405E60+36A\u2191j
                mov     [esp+7Ch+var_50], 2
                jmp     loc_4061D0
; ---------------------------------------------------------------------------

loc_40675E:                             ; CODE XREF: sub_405E60+2E7\u2191j
                mov     [esp+7Ch+var_3C], 0
                jmp     loc_406177
; ---------------------------------------------------------------------------

loc_40676B:                             ; CODE XREF: sub_405E60+2ED\u2191j
                cmp     [esp+7Ch+arg_10], 2
                mov     [esp+7Ch+var_3C], 0
                jnz     loc_4063B3

loc_406781:                             ; CODE XREF: sub_405E60+303\u2191j
                mov     edx, [esp+7Ch+arg_14]
                test    edx, edx
                jle     loc_406C63
                cmp     [esp+7Ch+arg_14], 0Eh
                setbe   dl

loc_40679B:                             ; CODE XREF: sub_405E60+E13\u2193j
                mov     ecx, [esp+7Ch+arg_14]
                and     edx, eax
                mov     [esp+7Ch+var_20], ecx
                mov     eax, ecx
                mov     [esp+7Ch+var_38], ecx
                mov     [esp+7Ch+var_64], ecx
                jmp     loc_4061A3
; ---------------------------------------------------------------------------

loc_4067B7:                             ; CODE XREF: sub_405E60+5DA\u2191j
                fstp    st
                jmp     short loc_4067BD
; ---------------------------------------------------------------------------

loc_4067BB:                             ; CODE XREF: sub_405E60+81B\u2191j
                fstp    st

loc_4067BD:                             ; CODE XREF: sub_405E60+832\u2191j
                                        ; sub_405E60+959\u2191j
                xor     edi, edi
                mov     [esp+7Ch+var_5C], 0

loc_4067C7:                             ; CODE XREF: sub_405E60+79A\u2191j
                                        ; sub_405E60+7C8\u2191j
                mov     eax, [esp+7Ch+arg_14]
                xor     edx, edx
                mov     esi, [esp+7Ch+var_58]
                mov     [esp+7Ch+var_64], 10h
                neg     eax
                mov     [esp+7Ch+var_70], eax
                jmp     loc_4066C1
; ---------------------------------------------------------------------------

loc_4067E7:                             ; CODE XREF: sub_405E60+2A3\u2191j
                mov     eax, [esp+7Ch+var_70]
                sub     [esp+7Ch+var_54], eax
                mov     [esp+7Ch+var_40], 0
                neg     eax
                mov     [esp+7Ch+var_4C], eax
                jmp     loc_406119
; ---------------------------------------------------------------------------

loc_406802:                             ; CODE XREF: sub_405E60+297\u2191j
                neg     eax
                mov     [esp+7Ch+var_54], eax
                mov     [esp+7Ch+var_60], 0
                jmp     loc_4060FD
; ---------------------------------------------------------------------------

loc_406815:                             ; CODE XREF: sub_405E60+239\u2191j
                fild    [esp+7Ch+var_70]
                fucompp
                fnstsw  ax
                sahf
                jp      short loc_406826
                jz      loc_4060A1

loc_406826:                             ; CODE XREF: sub_405E60+9BE\u2191j
                sub     [esp+7Ch+var_70], 1
                jmp     loc_4060A1
; ---------------------------------------------------------------------------

loc_406830:                             ; CODE XREF: sub_405E60+607\u2191j
                mov     edi, [esp+7Ch+var_4C]
                mov     esi, [esp+7Ch+var_54]
                mov     [esp+7Ch+var_5C], 0
                jmp     loc_4064BE
; ---------------------------------------------------------------------------

loc_406845:                             ; CODE XREF: sub_405E60+7FD\u2191j
                                        ; sub_405E60+80F\u2191j
                fld     [esp+7Ch+var_6C]
                fld     st
                mov     edi, [esp+7Ch+var_58]
                fdiv    st, st(2)
                fnstcw  [esp+7Ch+var_2E]
                mov     [esp+7Ch+var_20], 1
                lea     esi, [edi+1]
                movzx   eax, [esp+7Ch+var_2E]
                mov     ah, 0Ch
                mov     [esp+7Ch+var_30], ax
                fldcw   [esp+7Ch+var_30]
                fistp   [esp+7Ch+var_34]
                fldcw   [esp+7Ch+var_2E]
                mov     ecx, [esp+7Ch+var_34]
                mov     [esp+7Ch+var_34], ecx
                lea     eax, [ecx+30h]
                fild    [esp+7Ch+var_34]
                fmul    st, st(2)
                mov     [edi], al
                fsubp   st(1), st
                fldz
                fxch    st(1)
                fucom   st(1)
                fnstsw  ax
                fstp    st(1)
                sahf
                jnp     loc_4071F0

loc_40689E:                             ; CODE XREF: sub_405E60:loc_4071F0\u2193j
                mov     eax, [esp+7Ch+var_20]
                cmp     [esp+7Ch+var_64], eax
                jz      loc_406C3F
                fld     ds:flt_40A48C
                mov     edx, [esp+7Ch+var_64]
                jmp     short loc_4068C4
; ---------------------------------------------------------------------------

loc_4068B8:                             ; CODE XREF: sub_405E60+AA1\u2193j
                                        ; sub_405E60+AA3\u2193j
                mov     eax, [esp+7Ch+var_20]
                cmp     edx, eax
                jz      loc_406C3D

loc_4068C4:                             ; CODE XREF: sub_405E60+A56\u2191j
                add     eax, 1
                fmul    st(1), st
                add     esi, 1
                mov     [esp+7Ch+var_20], eax
                fld     st(1)
                fdiv    st, st(3)
                fldcw   [esp+7Ch+var_30]
                fistp   [esp+7Ch+var_34]
                fldcw   [esp+7Ch+var_2E]
                mov     ecx, [esp+7Ch+var_34]
                mov     [esp+7Ch+var_34], ecx
                lea     eax, [ecx+30h]
                fild    [esp+7Ch+var_34]
                fmul    st, st(3)
                mov     [esi-1], al
                fsubp   st(2), st
                fldz
                fxch    st(2)
                fucom   st(2)
                fnstsw  ax
                fstp    st(2)
                sahf
                jp      short loc_4068B8
                jnz     short loc_4068B8
                fstp    st
                fstp    st
                fstp    st

loc_40690B:                             ; CODE XREF: sub_405E60+139A\u2193j
                mov     eax, [esp+7Ch+var_70]

loc_40690F:                             ; CODE XREF: sub_405E60+4FC\u2191j
                add     eax, 1
                mov     [esp+7Ch+var_70], eax
                mov     [esp+7Ch+var_64], 0
                jmp     loc_4066ED
; ---------------------------------------------------------------------------

loc_406923:                             ; CODE XREF: sub_405E60+782\u2191j
                                        ; sub_405E60+78E\u2191j
                mov     eax, [esp+7Ch+var_3C]
                test    eax, eax
                jz      loc_406B48

loc_40692F:                             ; CODE XREF: sub_405E60+1428\u2193j
                lea     eax, [esi+ebp]
                test    eax, eax
                jle     short loc_40694A
                mov     [esp+7Ch+Src], eax
                mov     eax, [esp+7Ch+var_5C]
                mov     [esp+7Ch+var_7C], eax
                call    sub_407D70
                mov     [esp+7Ch+var_5C], eax

loc_40694A:                             ; CODE XREF: sub_405E60+AD4\u2191j
                mov     esi, dword ptr [esp+7Ch+var_6C]
                mov     ebp, [esp+7Ch+var_5C]
                test    esi, esi
                jnz     loc_407043

loc_40695A:                             ; CODE XREF: sub_405E60+1224\u2193j
                mov     esi, [esp+7Ch+var_58]
                mov     [esp+7Ch+var_60], edi
                mov     edi, [esp+7Ch+var_5C]
                mov     [esp+7Ch+var_20], 1
                mov     [esp+7Ch+var_54], esi
                jmp     loc_406A4D
; ---------------------------------------------------------------------------

loc_406977:                             ; CODE XREF: sub_405E60+C34\u2193j
                                        ; sub_405E60+C4E\u2193j
                mov     [esp+7Ch+var_7C], edx
                mov     [esp+7Ch+var_5C], eax
                call    sub_407900
                mov     eax, [esp+7Ch+var_5C]
                mov     ecx, eax
                or      ecx, [esp+7Ch+arg_10]
                jnz     short loc_4069AA
                mov     ecx, [esp+7Ch+arg_8]
                test    byte ptr [ecx], 1
                jnz     short loc_4069AA
                mov     edx, [esp+7Ch+var_50]
                test    edx, edx
                jz      loc_4071FF

loc_4069AA:                             ; CODE XREF: sub_405E60+B30\u2191j
                                        ; sub_405E60+B3C\u2191j
                test    esi, esi
                js      loc_406ECA
                or      esi, [esp+7Ch+arg_10]
                jnz     short loc_4069CB
                mov     esi, [esp+7Ch+arg_8]
                test    byte ptr [esi], 1
                jz      loc_406ECA

loc_4069CB:                             ; CODE XREF: sub_405E60+B59\u2191j
                test    eax, eax
                jg      loc_40709C

loc_4069D3:                             ; CODE XREF: sub_405E60+1241\u2193j
                add     [esp+7Ch+var_54], 1
                movzx   eax, byte ptr [esp+7Ch+var_6C]
                mov     esi, [esp+7Ch+var_54]
                mov     [esi-1], al
                mov     eax, [esp+7Ch+var_64]
                cmp     [esp+7Ch+var_20], eax
                jz      loc_407089
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Size], 0
                mov     [esp+7Ch+Src], 0Ah
                call    sub_407970
                cmp     edi, ebp
                mov     [esp+7Ch+Size], 0
                mov     [esp+7Ch+Src], 0Ah
                mov     [esp+7Ch+var_7C], edi
                mov     ebx, eax
                jz      loc_406AB3
                call    sub_407970
                mov     [esp+7Ch+var_7C], ebp
                mov     [esp+7Ch+Size], 0
                mov     [esp+7Ch+Src], 0Ah
                mov     edi, eax
                call    sub_407970
                mov     ebp, eax

loc_406A48:                             ; CODE XREF: sub_405E60+C5C\u2193j
                add     [esp+7Ch+var_20], 1

loc_406A4D:                             ; CODE XREF: sub_405E60+B12\u2191j
                mov     eax, [esp+7Ch+var_60]
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Src], eax
                call    sub_407510
                mov     [esp+7Ch+Src], edi
                mov     [esp+7Ch+var_7C], ebx
                mov     esi, eax
                add     esi, 30h ; '0'
                mov     dword ptr [esp+7Ch+var_6C], esi
                mov     [esp+7Ch+var_4C], eax
                call    sub_407E80
                mov     [esp+7Ch+Src], ebp
                mov     esi, eax
                mov     eax, [esp+7Ch+var_60]
                mov     [esp+7Ch+var_7C], eax
                call    sub_407ED0
                mov     edx, eax
                mov     eax, 1
                mov     ecx, [edx+0Ch]
                test    ecx, ecx
                jnz     loc_406977
                mov     [esp+7Ch+Src], edx
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+var_5C], edx
                call    sub_407E80
                mov     edx, [esp+7Ch+var_5C]
                jmp     loc_406977
; ---------------------------------------------------------------------------

loc_406AB3:                             ; CODE XREF: sub_405E60+BC1\u2191j
                call    sub_407970
                mov     edi, eax
                mov     ebp, eax
                jmp     short loc_406A48
; ---------------------------------------------------------------------------

loc_406ABE:                             ; CODE XREF: sub_405E60+87B\u2191j
                test    edx, edx
                jz      loc_4066E1
                mov     [esp+7Ch+var_7C], edx
                call    sub_407900
                xchg    ax, ax
                jmp     loc_4066E1
; ---------------------------------------------------------------------------

loc_406AD5:                             ; CODE XREF: sub_405E60+692\u2191j
                mov     eax, [esp+7Ch+var_4C]

loc_406AD9:                             ; CODE XREF: sub_405E60+6D4\u2191j
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Src], eax
                call    sub_407BE0
                mov     ebx, eax
                jmp     loc_40653A
; ---------------------------------------------------------------------------

loc_406AEC:                             ; CODE XREF: sub_405E60+774\u2191j
                mov     [esp+7Ch+Src], edi
                mov     [esp+7Ch+var_7C], ebx
                call    sub_407E80
                test    eax, eax
                jns     loc_4065DA
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Size], 0
                mov     [esp+7Ch+Src], 0Ah
                sub     [esp+7Ch+var_70], 1
                call    sub_407970
                mov     ebx, eax
                mov     eax, [esp+7Ch+var_3C]
                test    eax, eax
                jnz     loc_40724F
                cmp     [esp+7Ch+arg_10], 2
                mov     eax, [esp+7Ch+var_38]
                jle     short loc_406B44
                cmp     [esp+7Ch+var_38], 0
                jle     loc_4072CA

loc_406B44:                             ; CODE XREF: sub_405E60+CD7\u2191j
                mov     [esp+7Ch+var_64], eax

loc_406B48:                             ; CODE XREF: sub_405E60+AC9\u2191j
                mov     [esp+7Ch+var_20], 1
                mov     esi, [esp+7Ch+var_58]
                mov     ebp, [esp+7Ch+var_64]
                jmp     short loc_406B7F
; ---------------------------------------------------------------------------
                align 10h

loc_406B60:                             ; CODE XREF: sub_405E60+D38\u2193j
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Size], 0
                mov     [esp+7Ch+Src], 0Ah
                call    sub_407970
                add     [esp+7Ch+var_20], 1
                mov     ebx, eax

loc_406B7F:                             ; CODE XREF: sub_405E60+CF8\u2191j
                mov     [esp+7Ch+Src], edi
                add     esi, 1
                mov     [esp+7Ch+var_7C], ebx
                call    sub_407510
                add     eax, 30h ; '0'
                mov     [esi-1], al
                cmp     ebp, [esp+7Ch+var_20]
                jg      short loc_406B60
                mov     dword ptr [esp+7Ch+var_6C], eax
                xor     edx, edx

loc_406BA0:                             ; CODE XREF: sub_405E60+1237\u2193j
                mov     eax, [esp+7Ch+var_50]
                test    eax, eax
                jz      loc_406F91
                cmp     eax, 2
                jz      loc_406FCD
                cmp     dword ptr [ebx+10h], 1
                jle     loc_40718A

loc_406BBF:                             ; CODE XREF: sub_405E60+115A\u2193j
                                        ; sub_405E60+1167\u2193j ...
                movzx   ecx, byte ptr [esi-1]
                mov     ebp, [esp+7Ch+var_58]
                jmp     short loc_406BDE
; ---------------------------------------------------------------------------
                align 10h

loc_406BD0:                             ; CODE XREF: sub_405E60+D84\u2193j
                cmp     eax, ebp
                jz      loc_406E7E
                movzx   ecx, byte ptr [eax-1]
                mov     esi, eax

loc_406BDE:                             ; CODE XREF: sub_405E60+D67\u2191j
                                        ; sub_405E60+1368\u2193j
                cmp     cl, 39h ; '9'
                lea     eax, [esi-1]
                jz      short loc_406BD0
                add     ecx, 1
                mov     [eax], cl
                mov     eax, [esp+7Ch+var_70]
                mov     [esp+7Ch+var_64], 20h ; ' '
                add     eax, 1
                mov     [esp+7Ch+var_70], eax
                jmp     loc_4066C1
; ---------------------------------------------------------------------------

loc_406C03:                             ; CODE XREF: sub_405E60+70E\u2191j
                cmp     ebp, 1
                jnz     loc_406574
                mov     eax, [esp+7Ch+arg_0]
                mov     eax, [eax+4]
                add     eax, 1
                cmp     [esp+7Ch+arg_4], eax
                jle     loc_406574
                add     [esp+7Ch+var_54], 1
                add     [esp+7Ch+var_60], 1
                mov     dword ptr [esp+7Ch+var_6C], 1
                jmp     loc_406574
; ---------------------------------------------------------------------------

loc_406C3D:                             ; CODE XREF: sub_405E60+A5E\u2191j
                fstp    st

loc_406C3F:                             ; CODE XREF: sub_405E60+A46\u2191j
                mov     eax, [esp+7Ch+var_50]
                test    eax, eax
                jz      loc_406E49
                fstp    st
                fstp    st
                cmp     [esp+7Ch+var_50], 1
                jz      loc_406F7C
                mov     eax, [esp+7Ch+var_70]
                jmp     loc_406362
; ---------------------------------------------------------------------------

loc_406C63:                             ; CODE XREF: sub_405E60+92A\u2191j
                mov     edx, 1
                mov     [esp+7Ch+arg_14], 1
                jmp     loc_40679B
; ---------------------------------------------------------------------------

loc_406C78:                             ; CODE XREF: sub_405E60+32F\u2191j
                cmp     [esp+7Ch+var_64], 0Eh
                mov     [esp+7Ch+var_20], 1
                setbe   dl
                and     edx, eax
                mov     eax, 1
                jmp     loc_4061A3
; ---------------------------------------------------------------------------

loc_406C94:                             ; CODE XREF: sub_405E60+626\u2191j
                mov     edx, eax
                xor     edi, edi
                sub     edx, [esp+7Ch+var_4C]
                mov     [esp+7Ch+var_4C], eax
                add     [esp+7Ch+var_40], edx
                jmp     loc_406492
; ---------------------------------------------------------------------------

loc_406CA9:                             ; CODE XREF: sub_405E60+3EB\u2191j
                fnstcw  [esp+7Ch+var_2E]
                fld     [esp+7Ch+var_6C]
                fmul    ds:dbl_40A4B8[edx*8]
                mov     [esp+7Ch+var_20], 1
                mov     esi, [esp+7Ch+var_58]
                movzx   eax, [esp+7Ch+var_2E]
                mov     ah, 0Ch
                fld     ds:flt_40A48C
                fxch    st(2)
                mov     [esp+7Ch+var_30], ax
                jmp     short loc_406CE9
; ---------------------------------------------------------------------------
                align 10h

loc_406CE0:                             ; CODE XREF: sub_405E60+EB6\u2193j
                fmul    st, st(2)
                add     eax, 1
                mov     [esp+7Ch+var_20], eax

loc_406CE9:                             ; CODE XREF: sub_405E60+E78\u2191j
                fldcw   [esp+7Ch+var_30]
                fist    [esp+7Ch+var_34]
                fldcw   [esp+7Ch+var_2E]
                mov     eax, [esp+7Ch+var_34]
                test    eax, eax
                jz      short loc_406D07
                mov     [esp+7Ch+var_34], eax
                fild    [esp+7Ch+var_34]
                fsubp   st(1), st

loc_406D07:                             ; CODE XREF: sub_405E60+E9B\u2191j
                add     esi, 1
                lea     ecx, [eax+30h]
                mov     [esi-1], cl
                mov     eax, [esp+7Ch+var_20]
                cmp     eax, edx
                jnz     short loc_406CE0
                fstp    st(2)
                fxch    st(1)
                fld     ds:flt_40A49C
                fld     st(2)
                fadd    st, st(1)
                fxch    st(2)
                fucom   st(2)
                fnstsw  ax
                fstp    st(2)
                sahf
                ja      loc_406DC9
                fsubrp  st(2), st
                fxch    st(1)
                fucomp  st(1)
                fnstsw  ax
                sahf
                jbe     loc_406450
                fstp    st(1)
                fldz
                fxch    st(1)
                fucompp
                fnstsw  ax
                sahf
                jp      loc_4071A2
                jnz     loc_4071A2
                mov     [esp+7Ch+var_64], 0
                jmp     short loc_406D6B
; ---------------------------------------------------------------------------

loc_406D65:                             ; CODE XREF: sub_405E60+F11\u2193j
                movzx   ecx, byte ptr [eax-1]
                mov     esi, eax

loc_406D6B:                             ; CODE XREF: sub_405E60+F03\u2191j
                                        ; sub_405E60+1019\u2193j ...
                cmp     cl, 30h ; '0'
                lea     eax, [esi-1]
                jz      short loc_406D65
                mov     eax, [esp+7Ch+var_44]
                add     eax, 1
                mov     [esp+7Ch+var_70], eax
                jmp     loc_4066ED
; ---------------------------------------------------------------------------

loc_406D83:                             ; CODE XREF: sub_405E60+5CB\u2191j
                fstp    st
                fstp    st
                fstp    st
                mov     [esp+7Ch+var_70], 2
                xor     edi, edi
                mov     [esp+7Ch+var_5C], 0
                jmp     loc_4066AD
; ---------------------------------------------------------------------------

loc_406DA0:                             ; CODE XREF: sub_405E60+FFF\u2193j
                mov     eax, [esp+7Ch+var_70]
                and     ecx, 1
                movzx   ecx, byte ptr [esi-1]
                mov     [esp+7Ch+var_44], eax
                jz      loc_4071A2
                jmp     short loc_406DD1
; ---------------------------------------------------------------------------

loc_406DB7:                             ; CODE XREF: sub_405E60+460\u2191j
                fstp    st
                fstp    st
                fstp    st
                jmp     short loc_406DD1
; ---------------------------------------------------------------------------

loc_406DBF:                             ; CODE XREF: sub_405E60+492\u2191j
                fstp    st
                fstp    st
                fstp    st
                fstp    st
                jmp     short loc_406DD1
; ---------------------------------------------------------------------------

loc_406DC9:                             ; CODE XREF: sub_405E60+ECF\u2191j
                fstp    st
                fstp    st
                fstp    st
                fstp    st

loc_406DD1:                             ; CODE XREF: sub_405E60+F55\u2191j
                                        ; sub_405E60+F5D\u2191j ...
                mov     edx, [esp+7Ch+var_58]
                jmp     short loc_406DE5
; ---------------------------------------------------------------------------

loc_406DD7:                             ; CODE XREF: sub_405E60+F8B\u2193j
                cmp     eax, edx
                jz      loc_406E9D
                movzx   ecx, byte ptr [eax-1]
                mov     esi, eax

loc_406DE5:                             ; CODE XREF: sub_405E60+F75\u2191j
                                        ; sub_405E60+112C\u2193j
                cmp     cl, 39h ; '9'
                lea     eax, [esi-1]
                jz      short loc_406DD7
                mov     [esp+7Ch+var_58], edx
                add     ecx, 1

loc_406DF4:                             ; CODE XREF: sub_405E60+104E\u2193j
                mov     [eax], cl
                mov     eax, [esp+7Ch+var_44]
                mov     [esp+7Ch+var_64], 20h ; ' '
                add     eax, 1
                mov     [esp+7Ch+var_70], eax
                jmp     loc_4066ED
; ---------------------------------------------------------------------------

loc_406E0E:                             ; CODE XREF: sub_405E60+615\u2191j
                mov     esi, [esp+7Ch+arg_0]
                sub     edi, ebp
                mov     edx, [esp+7Ch+var_5C]
                lea     eax, [edi+1]
                mov     [esp+7Ch+var_20], eax
                mov     ecx, [esi+4]
                sub     edx, edi
                cmp     edx, ecx
                jge     loc_4070ED
                mov     eax, [esp+7Ch+var_5C]
                mov     edi, [esp+7Ch+var_4C]
                mov     esi, [esp+7Ch+var_54]
                sub     eax, ecx
                add     eax, 1
                mov     [esp+7Ch+var_20], eax
                jmp     loc_4064A6
; ---------------------------------------------------------------------------

loc_406E49:                             ; CODE XREF: sub_405E60+DE5\u2191j
                fadd    st, st
                fucom   st(1)
                fnstsw  ax
                sahf
                ja      loc_406F78
                fxch    st(1)
                fucompp
                fnstsw  ax
                sahf
                jp      short loc_406E65
                jz      loc_406DA0

loc_406E65:                             ; CODE XREF: sub_405E60+FFD\u2191j
                mov     eax, [esp+7Ch+var_70]
                movzx   ecx, byte ptr [esi-1]
                mov     [esp+7Ch+var_64], 10h
                mov     [esp+7Ch+var_44], eax
                jmp     loc_406D6B
; ---------------------------------------------------------------------------

loc_406E7E:                             ; CODE XREF: sub_405E60+D72\u2191j
                mov     eax, [esp+7Ch+var_58]
                mov     [esp+7Ch+var_64], 20h ; ' '
                mov     byte ptr [eax], 31h ; '1'
                mov     eax, [esp+7Ch+var_70]
                add     eax, 2
                mov     [esp+7Ch+var_70], eax
                jmp     loc_4066C1
; ---------------------------------------------------------------------------

loc_406E9D:                             ; CODE XREF: sub_405E60+F79\u2191j
                mov     [esp+7Ch+var_58], edx
                mov     ecx, 31h ; '1'
                add     [esp+7Ch+var_44], 1
                mov     byte ptr [edx], 30h ; '0'
                jmp     loc_406DF4
; ---------------------------------------------------------------------------

loc_406EB3:                             ; CODE XREF: sub_405E60+638\u2191j
                mov     esi, [esp+7Ch+var_54]
                xor     eax, eax
                sub     esi, [esp+7Ch+var_64]
                mov     [esp+7Ch+var_20], 0
                jmp     loc_4064A6
; ---------------------------------------------------------------------------

loc_406ECA:                             ; CODE XREF: sub_405E60+B4C\u2191j
                                        ; sub_405E60+B65\u2191j
                mov     ecx, [esp+7Ch+var_50]
                mov     [esp+7Ch+var_5C], edi
                mov     esi, [esp+7Ch+var_54]
                mov     edi, [esp+7Ch+var_60]
                mov     edx, dword ptr [esp+7Ch+var_6C]
                test    ecx, ecx
                jz      loc_407104
                cmp     dword ptr [ebx+10h], 1
                jle     loc_4070FA

loc_406EF0:                             ; CODE XREF: sub_405E60+129E\u2193j
                cmp     [esp+7Ch+var_50], 2
                jnz     short loc_406F31
                jmp     loc_40715F
; ---------------------------------------------------------------------------
                align 10h

loc_406F00:                             ; CODE XREF: sub_405E60+1110\u2193j
                                        ; sub_405E60+1116\u2193j
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Size], 0
                mov     [esp+7Ch+Src], 0Ah
                call    sub_407970
                mov     [esp+7Ch+Src], edi
                mov     [esp+7Ch+var_7C], eax
                mov     ebx, eax
                call    sub_407510
                mov     ebp, [esp+7Ch+var_64]
                add     eax, 30h ; '0'
                mov     dword ptr [esp+7Ch+var_6C], eax

loc_406F31:                             ; CODE XREF: sub_405E60+1095\u2191j
                mov     [esp+7Ch+Src], ebp
                mov     [esp+7Ch+var_7C], edi
                call    sub_407E80
                test    eax, eax
                jle     loc_4071CD
                movzx   eax, byte ptr [esp+7Ch+var_6C]
                add     esi, 1
                mov     [esi-1], al
                mov     [esp+7Ch+Size], 0
                mov     [esp+7Ch+Src], 0Ah
                mov     [esp+7Ch+var_7C], ebp
                call    sub_407970
                cmp     [esp+7Ch+var_5C], ebp
                mov     [esp+7Ch+var_64], eax
                jnz     short loc_406F00
                mov     [esp+7Ch+var_5C], eax
                jmp     short loc_406F00
; ---------------------------------------------------------------------------

loc_406F78:                             ; CODE XREF: sub_405E60+FF0\u2191j
                fstp    st
                fstp    st

loc_406F7C:                             ; CODE XREF: sub_405E60+DF4\u2191j
                mov     eax, [esp+7Ch+var_70]
                movzx   ecx, byte ptr [esi-1]
                mov     edx, [esp+7Ch+var_58]
                mov     [esp+7Ch+var_44], eax
                jmp     loc_406DE5
; ---------------------------------------------------------------------------

loc_406F91:                             ; CODE XREF: sub_405E60+D46\u2191j
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Src], 1
                mov     [esp+7Ch+var_64], edx
                call    sub_407D70
                mov     [esp+7Ch+Src], edi
                mov     [esp+7Ch+var_7C], eax
                mov     ebx, eax
                call    sub_407E80
                mov     edx, [esp+7Ch+var_64]
                cmp     eax, 0
                jg      loc_406BBF
                jnz     short loc_406FCD
                test    byte ptr [esp+7Ch+var_6C], 1
                jnz     loc_406BBF

loc_406FCD:                             ; CODE XREF: sub_405E60+D4F\u2191j
                                        ; sub_405E60+1160\u2191j
                cmp     dword ptr [ebx+10h], 1
                jle     loc_4072B3

loc_406FD7:                             ; CODE XREF: sub_405E60+145F\u2193j
                mov     [esp+7Ch+var_64], 10h
                jmp     short loc_406FE3
; ---------------------------------------------------------------------------

loc_406FE1:                             ; CODE XREF: sub_405E60+118A\u2193j
                mov     esi, eax

loc_406FE3:                             ; CODE XREF: sub_405E60+117F\u2191j
                                        ; sub_405E60+133D\u2193j ...
                cmp     byte ptr [esi-1], 30h ; '0'
                lea     eax, [esi-1]
                jz      short loc_406FE1
                mov     eax, [esp+7Ch+var_70]
                add     eax, 1
                mov     [esp+7Ch+var_70], eax
                jmp     loc_4066C1
; ---------------------------------------------------------------------------

loc_406FFC:                             ; CODE XREF: sub_405E60+3AF\u2191j
                mov     eax, [esp+7Ch+var_64]
                test    eax, eax
                jz      loc_406402
                mov     edx, [esp+7Ch+var_38]
                test    edx, edx
                jle     loc_406452
                fld     st
                fmul    ds:flt_40A48C
                mov     [esp+7Ch+var_44], 0FFFFFFFFh
                fld     st
                fmul    ds:flt_40A490
                fadd    ds:flt_40A494
                fstp    [esp+7Ch+var_6C]
                sub     dword ptr [esp+7Ch+var_6C+4], 3400000h
                jmp     loc_406245
; ---------------------------------------------------------------------------

loc_407043:                             ; CODE XREF: sub_405E60+AF4\u2191j
                mov     eax, [ebp+4]
                mov     [esp+7Ch+var_7C], eax
                call    sub_407830
                lea     ecx, [eax+0Ch]
                mov     esi, eax
                mov     eax, [ebp+10h]
                mov     [esp+7Ch+var_7C], ecx ; void *
                lea     edx, ds:8[eax*4]
                mov     eax, ebp
                add     eax, 0Ch
                mov     [esp+7Ch+Size], edx ; Size
                mov     [esp+7Ch+Src], eax ; Src
                call    memcpy
                mov     [esp+7Ch+Src], 1
                mov     [esp+7Ch+var_7C], esi
                call    sub_407D70
                mov     ebp, eax
                jmp     loc_40695A
; ---------------------------------------------------------------------------

loc_407089:                             ; CODE XREF: sub_405E60+B8C\u2191j
                mov     edx, edi
                mov     esi, [esp+7Ch+var_54]
                mov     edi, [esp+7Ch+var_60]
                mov     [esp+7Ch+var_5C], ebp
                jmp     loc_406BA0
; ---------------------------------------------------------------------------

loc_40709C:                             ; CODE XREF: sub_405E60+B6D\u2191j
                cmp     [esp+7Ch+var_50], 2
                jz      loc_4069D3
                mov     esi, [esp+7Ch+var_54]
                cmp     dword ptr [esp+7Ch+var_6C], 39h ; '9'
                mov     [esp+7Ch+var_5C], edi
                mov     edi, [esp+7Ch+var_60]
                mov     eax, esi
                jz      loc_4071B1
                movzx   ecx, byte ptr [esp+7Ch+var_6C]
                add     esi, 1
                mov     edx, [esp+7Ch+var_5C]
                mov     [esp+7Ch+var_64], 20h ; ' '
                mov     [esp+7Ch+var_5C], ebp
                add     ecx, 1
                mov     [eax], cl
                mov     eax, [esp+7Ch+var_70]
                add     eax, 1
                mov     [esp+7Ch+var_70], eax
                jmp     loc_4066C1
; ---------------------------------------------------------------------------

loc_4070ED:                             ; CODE XREF: sub_405E60+FC9\u2191j
                mov     edi, [esp+7Ch+var_4C]
                mov     esi, [esp+7Ch+var_54]
                jmp     loc_4064A6
; ---------------------------------------------------------------------------

loc_4070FA:                             ; CODE XREF: sub_405E60+108A\u2191j
                cmp     dword ptr [ebx+14h], 0
                jnz     loc_406EF0

loc_407104:                             ; CODE XREF: sub_405E60+1080\u2191j
                test    eax, eax
                mov     [esp+7Ch+var_64], edx
                jle     loc_4071E3
                mov     [esp+7Ch+var_7C], ebx
                mov     [esp+7Ch+Src], 1
                call    sub_407D70
                mov     [esp+7Ch+Src], edi
                mov     [esp+7Ch+var_7C], eax
                mov     ebx, eax
                call    sub_407E80
                mov     edx, [esp+7Ch+var_64]
                cmp     eax, 0
                jle     loc_4072D3

loc_40713B:                             ; CODE XREF: sub_405E60+1486\u2193j
                mov     eax, [esp+7Ch+var_4C]
                add     eax, 31h ; '1'
                cmp     edx, 39h ; '9'
                mov     dword ptr [esp+7Ch+var_6C], eax
                jz      short loc_4071AF

loc_40714B:                             ; CODE XREF: sub_405E60:loc_4072D3\u2193j
                                        ; sub_405E60+1480\u2193j
                mov     [esp+7Ch+var_64], 20h ; ' '

loc_407153:                             ; CODE XREF: sub_405E60+138B\u2193j
                cmp     dword ptr [ebx+10h], 1
                jg      short loc_40715F
                cmp     dword ptr [ebx+14h], 0
                jz      short loc_407167

loc_40715F:                             ; CODE XREF: sub_405E60+1097\u2191j
                                        ; sub_405E60+12F7\u2191j
                mov     [esp+7Ch+var_64], 10h

loc_407167:                             ; CODE XREF: sub_405E60+12FD\u2191j
                                        ; sub_405E60+1381\u2193j
                movzx   eax, byte ptr [esp+7Ch+var_6C]
                add     esi, 1
                mov     edx, [esp+7Ch+var_5C]
                mov     [esp+7Ch+var_5C], ebp
                mov     [esi-1], al
                mov     eax, [esp+7Ch+var_70]
                add     eax, 1
                mov     [esp+7Ch+var_70], eax
                jmp     loc_4066C1
; ---------------------------------------------------------------------------

loc_40718A:                             ; CODE XREF: sub_405E60+D59\u2191j
                mov     ecx, [ebx+14h]
                test    ecx, ecx
                jnz     loc_406BBF
                mov     [esp+7Ch+var_64], 0
                jmp     loc_406FE3
; ---------------------------------------------------------------------------

loc_4071A2:                             ; CODE XREF: sub_405E60+EEF\u2191j
                                        ; sub_405E60+EF5\u2191j ...
                mov     [esp+7Ch+var_64], 10h
                jmp     loc_406D6B
; ---------------------------------------------------------------------------

loc_4071AF:                             ; CODE XREF: sub_405E60+12E9\u2191j
                                        ; sub_405E60+1372\u2193j ...
                mov     eax, esi

loc_4071B1:                             ; CODE XREF: sub_405E60+125A\u2191j
                mov     edx, [esp+7Ch+var_5C]
                add     esi, 1
                mov     ecx, 39h ; '9'
                mov     [esp+7Ch+var_5C], ebp
                mov     ebp, [esp+7Ch+var_58]
                mov     byte ptr [eax], 39h ; '9'
                jmp     loc_406BDE
; ---------------------------------------------------------------------------

loc_4071CD:                             ; CODE XREF: sub_405E60+10DF\u2191j
                cmp     dword ptr [esp+7Ch+var_6C], 39h ; '9'
                jz      short loc_4071AF
                add     dword ptr [esp+7Ch+var_6C], 1
                mov     [esp+7Ch+var_64], 20h ; ' '
                jmp     short loc_407167
; ---------------------------------------------------------------------------

loc_4071E3:                             ; CODE XREF: sub_405E60+12AA\u2191j
                mov     [esp+7Ch+var_64], 0
                jmp     loc_407153
; ---------------------------------------------------------------------------

loc_4071F0:                             ; CODE XREF: sub_405E60+A38\u2191j
                jnz     loc_40689E
                fstp    st
                fstp    st
                jmp     loc_40690B
; ---------------------------------------------------------------------------

loc_4071FF:                             ; CODE XREF: sub_405E60+B44\u2191j
                mov     ecx, esi
                mov     esi, [esp+7Ch+var_54]
                cmp     dword ptr [esp+7Ch+var_6C], 39h ; '9'
                mov     [esp+7Ch+var_5C], edi
                mov     edi, [esp+7Ch+var_60]
                mov     eax, esi
                jz      short loc_4071AF
                test    ecx, ecx
                jle     short loc_40728D
                mov     ecx, [esp+7Ch+var_4C]
                mov     [esp+7Ch+var_64], 20h ; ' '
                add     ecx, 31h ; '1'
                mov     dword ptr [esp+7Ch+var_6C], ecx

loc_40722D:                             ; CODE XREF: sub_405E60+1439\u2193j
                                        ; sub_405E60+144E\u2193j
                movzx   ecx, byte ptr [esp+7Ch+var_6C]
                add     esi, 1
                mov     edx, [esp+7Ch+var_5C]
                mov     [esp+7Ch+var_5C], ebp
                mov     [eax], cl
                mov     eax, [esp+7Ch+var_70]
                add     eax, 1
                mov     [esp+7Ch+var_70], eax
                jmp     loc_4066C1
; ---------------------------------------------------------------------------

loc_40724F:                             ; CODE XREF: sub_405E60+CC5\u2191j
                mov     eax, [esp+7Ch+var_5C]
                mov     [esp+7Ch+Size], 0
                mov     [esp+7Ch+Src], 0Ah
                mov     [esp+7Ch+var_7C], eax
                call    sub_407970
                cmp     [esp+7Ch+var_38], 0
                mov     [esp+7Ch+var_5C], eax
                mov     eax, [esp+7Ch+var_38]
                jg      short loc_407284
                cmp     [esp+7Ch+arg_10], 2
                jg      short loc_4072CA

loc_407284:                             ; CODE XREF: sub_405E60+1418\u2191j
                mov     [esp+7Ch+var_64], eax
                jmp     loc_40692F
; ---------------------------------------------------------------------------

loc_40728D:                             ; CODE XREF: sub_405E60+13B8\u2191j
                cmp     dword ptr [ebx+10h], 1
                mov     [esp+7Ch+var_64], 10h
                jg      short loc_40722D
                cmp     dword ptr [ebx+14h], 1
                sbb     ecx, ecx
                mov     [esp+7Ch+var_64], ecx
                not     [esp+7Ch+var_64]
                and     [esp+7Ch+var_64], 10h
                jmp     loc_40722D
; ---------------------------------------------------------------------------

loc_4072B3:                             ; CODE XREF: sub_405E60+1171\u2191j
                cmp     dword ptr [ebx+14h], 0
                mov     [esp+7Ch+var_64], 0
                jnz     loc_406FD7
                jmp     loc_406FE3
; ---------------------------------------------------------------------------

loc_4072CA:                             ; CODE XREF: sub_405E60+CDE\u2191j
                                        ; sub_405E60+1422\u2191j
                mov     [esp+7Ch+var_64], eax
                jmp     loc_4065F4
; ---------------------------------------------------------------------------

loc_4072D3:                             ; CODE XREF: sub_405E60+12D5\u2191j
                jnz     loc_40714B
                test    byte ptr [esp+7Ch+var_6C], 1
                xchg    ax, ax
                jz      loc_40714B
                jmp     loc_40713B
; ---------------------------------------------------------------------------

def_405E8C:                             ; CODE XREF: sub_405E60+26\u2191j
                xor     eax, eax        ; jumptable 00405E8C default case
                lea     esi, [esi+0]
                jmp     loc_405F84
; ---------------------------------------------------------------------------

loc_4072F5:                             ; CODE XREF: sub_405E60+2CF\u2191j
                mov     eax, 1
                jmp     loc_40613F
sub_405E60      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_407300      proc near               ; CODE XREF: sub_405E60+52B\u2191p

var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 10h
                mov     esi, [esp+20h+arg_0]
                mov     eax, [esp+20h+arg_0]
                mov     ecx, [esp+20h+arg_4]
                mov     edx, [esi+10h]
                lea     ebp, [eax+14h]
                mov     eax, ecx
                sar     eax, 5
                cmp     eax, edx
                jge     loc_4073B0
                lea     eax, [ebp+eax*4+0]
                and     ecx, 1Fh
                lea     edi, [ebp+edx*4+0]
                mov     [esp+20h+var_1C], eax
                mov     [esp+20h+var_20], ecx
                jz      loc_4073D0
                mov     esi, [esp+20h+var_1C]
                mov     eax, [esp+20h+var_20]
                mov     [esp+20h+var_18], 20h ; ' '
                sub     [esp+20h+var_18], eax
                mov     ebx, [esi]
                lea     edx, [esi+4]
                mov     ecx, eax
                shr     ebx, cl
                cmp     edi, edx
                jbe     loc_40740E
                mov     esi, ebp
                mov     [esp+20h+var_14], ebp
                mov     ebp, [esp+20h+var_18]
                lea     esi, [esi+0]

loc_407370:                             ; CODE XREF: sub_407300+8C\u2193j
                mov     eax, [edx]
                mov     ecx, ebp
                add     esi, 4
                add     edx, 4
                shl     eax, cl
                movzx   ecx, byte ptr [esp+20h+var_20]
                or      eax, ebx
                mov     [esi-4], eax
                mov     ebx, [edx-4]
                shr     ebx, cl
                cmp     edi, edx
                ja      short loc_407370
                sub     edi, [esp+20h+var_1C]
                mov     ebp, [esp+20h+var_14]
                lea     eax, [edi-5]
                shr     eax, 2
                lea     eax, [ebp+eax*4+4]

loc_4073A0:                             ; CODE XREF: sub_407300+110\u2193j
                test    ebx, ebx
                mov     [eax], ebx
                jz      short loc_4073A9
                add     eax, 4

loc_4073A9:                             ; CODE XREF: sub_407300+A4\u2191j
                sub     eax, ebp
                sar     eax, 2
                jmp     short loc_4073FB
; ---------------------------------------------------------------------------

loc_4073B0:                             ; CODE XREF: sub_407300+20\u2191j
                                        ; sub_407300+D4\u2193j
                mov     eax, [esp+20h+arg_0]
                mov     dword ptr [eax+10h], 0

loc_4073BB:                             ; CODE XREF: sub_407300+104\u2193j
                mov     eax, [esp+20h+arg_0]
                mov     dword ptr [eax+14h], 0
                add     esp, 10h
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4073D0:                             ; CODE XREF: sub_407300+38\u2191j
                cmp     edi, eax
                mov     edx, ebp
                jbe     short loc_4073B0

loc_4073D6:                             ; CODE XREF: sub_407300+E4\u2193j
                add     eax, 4
                mov     ecx, [eax-4]
                add     edx, 4
                cmp     edi, eax
                mov     [edx-4], ecx
                ja      short loc_4073D6
                mov     eax, [esp+20h+var_1C]
                not     eax
                add     eax, edi
                shr     eax, 2
                lea     eax, ds:4[eax*4]
                sar     eax, 2

loc_4073FB:                             ; CODE XREF: sub_407300+AE\u2191j
                mov     esi, [esp+20h+arg_0]
                test    eax, eax
                mov     [esi+10h], eax
                jz      short loc_4073BB
                add     esp, 10h
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_40740E:                             ; CODE XREF: sub_407300+5C\u2191j
                mov     eax, ebp
                jmp     short loc_4073A0
sub_407300      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_407420      proc near               ; CODE XREF: sub_405E60+C9\u2191p

arg_0           = dword ptr  4

                push    ebx
                mov     eax, [esp+4+arg_0]
                mov     ecx, [eax+10h]
                lea     edx, [eax+14h]
                lea     ebx, [edx+ecx*4]
                cmp     edx, ebx
                jnb     short loc_40745A
                mov     ecx, [eax+14h]
                xor     eax, eax
                test    ecx, ecx
                jz      short loc_407446
                jmp     short loc_407452
; ---------------------------------------------------------------------------
                align 10h

loc_407440:                             ; CODE XREF: sub_407420+2E\u2193j
                mov     ecx, [edx]
                test    ecx, ecx
                jnz     short loc_407452

loc_407446:                             ; CODE XREF: sub_407420+19\u2191j
                add     edx, 4
                add     eax, 20h ; ' '
                cmp     ebx, edx
                ja      short loc_407440
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_407452:                             ; CODE XREF: sub_407420+1B\u2191j
                                        ; sub_407420+24\u2191j
                tzcnt   ecx, ecx
                add     eax, ecx
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_40745A:                             ; CODE XREF: sub_407420+10\u2191j
                xor     eax, eax
                pop     ebx
                retn
sub_407420      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_407460      proc near               ; CODE XREF: sub_405E60+34A\u2191p
                                        ; sub_4074A0+14\u2193p

var_1C          = dword ptr -1Ch
arg_0           = dword ptr  4

                push    ebx
                xor     ebx, ebx
                sub     esp, 18h
                mov     ecx, [esp+1Ch+arg_0]
                cmp     ecx, 13h
                jbe     short loc_407480
                mov     eax, 4

loc_407474:                             ; CODE XREF: sub_407460+1E\u2193j
                add     eax, eax
                add     ebx, 1
                lea     edx, [eax+10h]
                cmp     edx, ecx
                jbe     short loc_407474

loc_407480:                             ; CODE XREF: sub_407460+D\u2191j
                mov     [esp+1Ch+var_1C], ebx
                call    sub_407830
                mov     [eax], ebx
                add     esp, 18h
                add     eax, 4
                pop     ebx
                retn
sub_407460      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_4074A0      proc near               ; CODE XREF: sub_405E60+11F\u2191p
                                        ; sub_405E60+157\u2191p ...

var_1C          = dword ptr -1Ch
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                push    esi
                push    ebx
                sub     esp, 14h
                mov     eax, [esp+1Ch+arg_8]
                mov     ebx, [esp+1Ch+arg_0]
                mov     esi, [esp+1Ch+arg_4]
                mov     [esp+1Ch+var_1C], eax
                call    sub_407460
                movzx   edx, byte ptr [ebx]
                lea     ecx, [ebx+1]
                test    dl, dl
                mov     [eax], dl
                mov     edx, eax
                jz      short loc_4074D7

loc_4074C7:                             ; CODE XREF: sub_4074A0+35\u2193j
                add     ecx, 1
                movzx   ebx, byte ptr [ecx-1]
                add     edx, 1
                test    bl, bl
                mov     [edx], bl
                jnz     short loc_4074C7

loc_4074D7:                             ; CODE XREF: sub_4074A0+25\u2191j
                test    esi, esi
                jz      short loc_4074DD
                mov     [esi], edx

loc_4074DD:                             ; CODE XREF: sub_4074A0+39\u2191j
                add     esp, 14h
                pop     ebx
                pop     esi
                retn
sub_4074A0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_4074F0      proc near               ; CODE XREF: sub_404590+75\u2191p
                                        ; sub_404590+A0\u2191p ...

arg_0           = dword ptr  4

                mov     eax, [esp+arg_0]
                mov     edx, 1
                mov     ecx, [eax-4]
                sub     eax, 4
                shl     edx, cl
                mov     [eax+4], ecx
                mov     [eax+8], edx
                mov     [esp+arg_0], eax
                jmp     sub_407900
sub_4074F0      endp


; =============== S U B R O U T I N E =======================================


sub_407510      proc near               ; CODE XREF: sub_405E60+BF8\u2191p
                                        ; sub_405E60+D29\u2191p ...

var_5C          = dword ptr -5Ch
var_58          = dword ptr -58h
var_4C          = dword ptr -4Ch
var_48          = dword ptr -48h
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 4Ch
                mov     eax, [esp+5Ch+arg_4]
                mov     edi, [esp+5Ch+arg_0]
                mov     edx, [eax+10h]
                xor     eax, eax
                cmp     edx, [edi+10h]
                jg      loc_407703
                mov     eax, [esp+5Ch+arg_4]
                mov     esi, [esp+5Ch+arg_0]
                add     eax, 14h
                mov     edi, eax
                mov     [esp+5Ch+var_24], eax
                lea     eax, [edx-1]
                xor     edx, edx
                mov     [esp+5Ch+var_2C], eax
                shl     eax, 2
                add     edi, eax
                lea     ebx, [esi+14h]
                add     eax, ebx
                mov     [esp+5Ch+var_34], edi
                mov     edi, [edi]
                mov     [esp+5Ch+var_20], eax
                mov     eax, [eax]
                mov     [esp+5Ch+var_30], ebx
                lea     ecx, [edi+1]
                div     ecx
                mov     [esp+5Ch+var_4C], edi
                test    eax, eax
                mov     ebp, eax
                mov     [esp+5Ch+var_28], eax
                jz      loc_40763F
                mov     edi, [esp+5Ch+var_24]
                mov     esi, ebx
                mov     [esp+5Ch+var_3C], 0
                mov     [esp+5Ch+var_38], 0
                mov     [esp+5Ch+var_4C], 0
                mov     [esp+5Ch+var_48], 0
                xchg    ax, ax

loc_4075A0:                             ; CODE XREF: sub_407510+E9\u2193j
                add     edi, 4
                mov     eax, ebp
                mul     dword ptr [edi-4]
                add     eax, [esp+5Ch+var_3C]
                adc     edx, [esp+5Ch+var_38]
                mov     [esp+5Ch+var_40], 0
                mov     [esp+5Ch+var_44], eax
                mov     ebx, edx
                mov     ecx, ebx
                xor     ebx, ebx
                mov     [esp+5Ch+var_3C], ecx
                mov     ecx, [esi]
                mov     [esp+5Ch+var_38], ebx
                xor     ebx, ebx
                sub     ecx, [esp+5Ch+var_44]
                sbb     ebx, [esp+5Ch+var_40]
                sub     ecx, [esp+5Ch+var_4C]
                sbb     ebx, [esp+5Ch+var_48]
                add     esi, 4
                mov     [esp+5Ch+var_48], 0
                mov     eax, ebx
                and     eax, 1
                cmp     [esp+5Ch+var_34], edi
                mov     [esp+5Ch+var_4C], eax
                mov     [esi-4], ecx
                jnb     short loc_4075A0
                mov     eax, [esp+5Ch+var_20]
                mov     edi, [eax]
                test    edi, edi
                jnz     short loc_40763F
                mov     ecx, [esp+5Ch+var_30]
                mov     esi, eax
                sub     eax, 4
                cmp     ecx, eax
                jnb     short loc_407634
                mov     esi, [esi-4]
                test    esi, esi
                jnz     short loc_407634
                mov     edx, [esp+5Ch+var_2C]
                jmp     short loc_407626
; ---------------------------------------------------------------------------
                align 10h

loc_407620:                             ; CODE XREF: sub_407510+11E\u2193j
                mov     ebx, [eax]
                test    ebx, ebx
                jnz     short loc_407630

loc_407626:                             ; CODE XREF: sub_407510+10D\u2191j
                sub     eax, 4
                sub     edx, 1
                cmp     ecx, eax
                jb      short loc_407620

loc_407630:                             ; CODE XREF: sub_407510+114\u2191j
                mov     [esp+5Ch+var_2C], edx

loc_407634:                             ; CODE XREF: sub_407510+100\u2191j
                                        ; sub_407510+107\u2191j
                mov     eax, [esp+5Ch+arg_0]
                mov     edi, [esp+5Ch+var_2C]
                mov     [eax+10h], edi

loc_40763F:                             ; CODE XREF: sub_407510+62\u2191j
                                        ; sub_407510+F3\u2191j
                mov     eax, [esp+5Ch+arg_4]
                mov     [esp+5Ch+var_58], eax
                mov     eax, [esp+5Ch+arg_0]
                mov     [esp+5Ch+var_5C], eax
                call    sub_407E80
                test    eax, eax
                js      loc_4076FF
                xor     esi, esi
                xor     edi, edi
                lea     eax, [ebp+1]
                mov     ebp, [esp+5Ch+var_30]
                mov     [esp+5Ch+var_4C], esi
                mov     esi, [esp+5Ch+var_24]
                mov     [esp+5Ch+var_48], edi
                mov     edi, [esp+5Ch+var_34]
                mov     [esp+5Ch+var_28], eax
                lea     esi, [esi+0]

loc_407680:                             ; CODE XREF: sub_407510+1A2\u2193j
                add     esi, 4
                mov     eax, [ebp+0]
                xor     ebx, ebx
                mov     ecx, [esi-4]
                xor     edx, edx
                sub     eax, ecx
                sbb     edx, ebx
                sub     eax, [esp+5Ch+var_4C]
                sbb     edx, [esp+5Ch+var_48]
                add     ebp, 4
                mov     [esp+5Ch+var_48], 0
                mov     ebx, edx
                and     ebx, 1
                cmp     edi, esi
                mov     [esp+5Ch+var_4C], ebx
                mov     [ebp-4], eax
                jnb     short loc_407680
                mov     eax, [esp+5Ch+var_30]
                mov     ebx, [esp+5Ch+var_2C]
                lea     edx, [eax+ebx*4]
                mov     edi, [edx]
                test    edi, edi
                jnz     short loc_4076FF
                mov     ecx, [esp+5Ch+var_30]
                lea     eax, [edx-4]
                cmp     ecx, eax
                jnb     short loc_4076F4
                mov     esi, [edx-4]
                test    esi, esi
                jnz     short loc_4076F4
                mov     edx, ebx
                jmp     short loc_4076E6
; ---------------------------------------------------------------------------
                align 10h

loc_4076E0:                             ; CODE XREF: sub_407510+1DE\u2193j
                mov     ebx, [eax]
                test    ebx, ebx
                jnz     short loc_4076F0

loc_4076E6:                             ; CODE XREF: sub_407510+1C9\u2191j
                sub     eax, 4
                sub     edx, 1
                cmp     ecx, eax
                jb      short loc_4076E0

loc_4076F0:                             ; CODE XREF: sub_407510+1D4\u2191j
                mov     [esp+5Ch+var_2C], edx

loc_4076F4:                             ; CODE XREF: sub_407510+1BE\u2191j
                                        ; sub_407510+1C5\u2191j
                mov     eax, [esp+5Ch+arg_0]
                mov     edi, [esp+5Ch+var_2C]
                mov     [eax+10h], edi

loc_4076FF:                             ; CODE XREF: sub_407510+145\u2191j
                                        ; sub_407510+1B3\u2191j
                mov     eax, [esp+5Ch+var_28]

loc_407703:                             ; CODE XREF: sub_407510+17\u2191j
                add     esp, 4Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
sub_407510      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_407710      proc near               ; CODE XREF: sub_407830+E\u2193p
                                        ; sub_407900+16\u2193p ...

var_4           = dword ptr -4

                push    ebp
                mov     ebp, esp
                push    ebx
                mov     ebx, eax
                sub     esp, 14h
                mov     edx, ds:Target
                cmp     edx, 2
                jz      short loc_4077A3
                test    edx, edx
                jnz     short loc_407745
                jmp     short loc_407754
; ---------------------------------------------------------------------------
                align 10h

loc_407730:                             ; CODE XREF: sub_407710+38\u2193j
                mov     dword ptr [esp], 1 ; dwMilliseconds
                call    Sleep
                sub     esp, 4

loc_40773F:                             ; CODE XREF: sub_407710+B3\u2193j
                mov     edx, ds:Target

loc_407745:                             ; CODE XREF: sub_407710+16\u2191j
                cmp     edx, 1
                jz      short loc_407730
                cmp     edx, 2
                jz      short loc_4077A3
                mov     ebx, [ebp+var_4]
                leave
                retn
; ---------------------------------------------------------------------------

loc_407754:                             ; CODE XREF: sub_407710+18\u2191j
                mov     dword ptr [esp+4], 1 ; Value
                mov     dword ptr [esp], offset Target ; Target
                call    InterlockedExchange
                sub     esp, 8
                test    eax, eax
                jnz     short loc_4077C0
                mov     dword ptr [esp], offset stru_40D9E0 ; lpCriticalSection
                call    InitializeCriticalSection
                sub     esp, 4
                mov     dword ptr [esp], offset stru_40D9F8 ; lpCriticalSection
                call    InitializeCriticalSection
                sub     esp, 4
                mov     dword ptr [esp], offset sub_4077E0
                call    sub_4012E0
                mov     ds:Target, 2

loc_4077A3:                             ; CODE XREF: sub_407710+12\u2191j
                                        ; sub_407710+3D\u2191j ...
                lea     eax, [ebx+ebx*2]
                lea     eax, stru_40D9E0.DebugInfo[eax*8]
                mov     [esp], eax      ; lpCriticalSection
                call    EnterCriticalSection
                mov     ebx, [ebp+var_4]
                sub     esp, 4
                leave
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4077C0:                             ; CODE XREF: sub_407710+5D\u2191j
                cmp     eax, 2
                jnz     loc_40773F
                mov     ds:Target, 2
                jmp     short loc_4077A3
sub_407710      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_4077E0      proc near               ; DATA XREF: sub_407710+7D\u2191o
                push    ebp
                mov     ebp, esp
                sub     esp, 18h
                mov     dword ptr [esp+4], 3 ; Value
                mov     dword ptr [esp], offset Target ; Target
                call    InterlockedExchange
                sub     esp, 8
                cmp     eax, 2
                jz      short loc_407804
                leave
                retn
; ---------------------------------------------------------------------------

loc_407804:                             ; CODE XREF: sub_4077E0+20\u2191j
                mov     dword ptr [esp], offset stru_40D9E0 ; lpCriticalSection
                call    DeleteCriticalSection
                sub     esp, 4
                mov     dword ptr [esp], offset stru_40D9F8 ; lpCriticalSection
                call    DeleteCriticalSection
                sub     esp, 4
                leave
                retn
sub_4077E0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_407830      proc near               ; CODE XREF: sub_405E60+54\u2191p
                                        ; sub_405E60+11E9\u2191p ...

arg_0           = dword ptr  8

                push    ebp
                xor     eax, eax
                mov     ebp, esp
                push    edi
                push    esi
                push    ebx
                sub     esp, 1Ch
                mov     esi, [ebp+arg_0]
                call    sub_407710
                cmp     esi, 9
                jg      short loc_407876
                mov     ebx, ds:dword_40D9A0[esi*4]
                test    ebx, ebx
                jz      short loc_4078C1
                mov     eax, [ebx]
                cmp     ds:Target, 2
                mov     ds:dword_40D9A0[esi*4], eax
                jnz     short loc_4078A9

loc_407865:                             ; CODE XREF: sub_407830+77\u2193j
                mov     dword ptr [esp], offset stru_40D9E0 ; lpCriticalSection
                call    LeaveCriticalSection
                sub     esp, 4
                jmp     short loc_4078A9
; ---------------------------------------------------------------------------

loc_407876:                             ; CODE XREF: sub_407830+16\u2191j
                mov     edi, 1
                mov     ecx, esi
                shl     edi, cl
                lea     eax, ds:1Bh[edi*4]
                shr     eax, 3

loc_407889:                             ; CODE XREF: sub_407830+BD\u2193j
                shl     eax, 3
                mov     [esp], eax      ; Size
                call    malloc
                test    eax, eax
                mov     ebx, eax
                jz      short loc_4078F9

loc_40789A:                             ; CODE XREF: sub_407830+C7\u2193j
                cmp     ds:Target, 2
                mov     [ebx+4], esi
                mov     [ebx+8], edi
                jz      short loc_407865

loc_4078A9:                             ; CODE XREF: sub_407830+33\u2191j
                                        ; sub_407830+44\u2191j
                mov     dword ptr [ebx+10h], 0
                mov     eax, ebx
                mov     dword ptr [ebx+0Ch], 0

loc_4078B9:                             ; CODE XREF: sub_407830+CB\u2193j
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4078C1:                             ; CODE XREF: sub_407830+21\u2191j
                mov     ebx, off_40902C
                mov     edi, 1
                mov     ecx, esi
                shl     edi, cl
                lea     eax, ds:1Bh[edi*4]
                shr     eax, 3
                mov     edx, ebx
                sub     edx, offset dword_40D0A0
                sar     edx, 3
                add     edx, eax
                cmp     edx, 120h
                ja      short loc_407889
                lea     eax, [ebx+eax*8]
                mov     off_40902C, eax
                jmp     short loc_40789A
; ---------------------------------------------------------------------------

loc_4078F9:                             ; CODE XREF: sub_407830+68\u2191j
                xor     eax, eax
                jmp     short loc_4078B9
sub_407830      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_407900      proc near               ; CODE XREF: sub_405E60+F3\u2191p
                                        ; sub_405E60+6C3\u2191p ...

var_4           = dword ptr -4
arg_0           = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    ebx
                sub     esp, 14h
                mov     ebx, [ebp+arg_0]
                test    ebx, ebx
                jz      short loc_407937
                cmp     dword ptr [ebx+4], 9
                jg      short loc_407940
                xor     eax, eax
                call    sub_407710
                mov     eax, [ebx+4]
                cmp     ds:Target, 2
                mov     edx, ds:dword_40D9A0[eax*4]
                mov     ds:dword_40D9A0[eax*4], ebx
                mov     [ebx], edx
                jz      short loc_407950

loc_407937:                             ; CODE XREF: sub_407900+C\u2191j
                mov     ebx, [ebp+var_4]
                leave
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_407940:                             ; CODE XREF: sub_407900+12\u2191j
                mov     ebx, [ebp+var_4]
                leave
                jmp     free
; ---------------------------------------------------------------------------
                align 10h

loc_407950:                             ; CODE XREF: sub_407900+35\u2191j
                mov     dword ptr [esp], offset stru_40D9E0 ; lpCriticalSection
                call    LeaveCriticalSection
                mov     ebx, [ebp+var_4]
                sub     esp, 4
                leave
                retn
sub_407900      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_407970      proc near               ; CODE XREF: sub_405E60+7B3\u2191p
                                        ; sub_405E60+BA5\u2191p ...

var_3C          = dword ptr -3Ch
Src             = dword ptr -38h
Size            = dword ptr -34h
var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                push    ebp
                xor     ecx, ecx
                push    edi
                push    esi
                push    ebx
                sub     esp, 2Ch
                mov     eax, [esp+3Ch+arg_0]
                mov     edi, [esp+3Ch+arg_8]
                mov     eax, [eax+10h]
                mov     ebp, edi
                sar     ebp, 1Fh
                mov     [esp+3Ch+var_20], eax
                mov     eax, [esp+3Ch+arg_0]
                lea     ebx, [eax+14h]
                mov     eax, [esp+3Ch+arg_4]
                mov     [esp+3Ch+var_2C], eax
                sar     eax, 1Fh
                mov     [esp+3Ch+var_28], eax

loc_4079A3:                             ; CODE XREF: sub_407970+57\u2193j
                mov     eax, [ebx+ecx*4]
                mov     esi, [esp+3Ch+var_28]
                imul    esi, eax
                mul     [esp+3Ch+var_2C]
                add     edx, esi
                add     eax, edi
                adc     edx, ebp
                mov     ebp, edx
                mov     edi, ebp
                xor     ebp, ebp
                mov     [ebx+ecx*4], eax
                add     ecx, 1
                cmp     [esp+3Ch+var_20], ecx
                jg      short loc_4079A3
                mov     edx, ebp
                mov     eax, [esp+3Ch+arg_0]
                or      edx, edi
                jz      short loc_4079F0
                mov     edx, [esp+3Ch+var_20]
                cmp     edx, [eax+8]
                jge     short loc_4079F8

loc_4079DC:                             ; CODE XREF: sub_407970+D8\u2193j
                mov     edx, [esp+3Ch+arg_0]
                mov     eax, [esp+3Ch+var_20]
                mov     [edx+eax*4+14h], edi
                add     eax, 1
                mov     [edx+10h], eax
                mov     eax, edx

loc_4079F0:                             ; CODE XREF: sub_407970+61\u2191j
                                        ; sub_407970+DC\u2193j
                add     esp, 2Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4079F8:                             ; CODE XREF: sub_407970+6A\u2191j
                mov     eax, [eax+4]
                mov     [esp+3Ch+var_2C], eax
                add     eax, 1
                mov     [esp+3Ch+var_3C], eax
                call    sub_407830
                test    eax, eax
                mov     ebx, eax
                jz      short loc_407A4A
                lea     ecx, [eax+0Ch]
                mov     eax, [esp+3Ch+arg_0]
                mov     eax, [eax+10h]
                mov     [esp+3Ch+var_3C], ecx ; void *
                lea     edx, ds:8[eax*4]
                mov     eax, [esp+3Ch+arg_0]
                mov     [esp+3Ch+Size], edx ; Size
                add     eax, 0Ch
                mov     [esp+3Ch+Src], eax ; Src
                call    memcpy
                mov     eax, [esp+3Ch+arg_0]
                mov     [esp+3Ch+var_3C], eax
                call    sub_407900
                mov     [esp+3Ch+arg_0], ebx
                jmp     short loc_4079DC
; ---------------------------------------------------------------------------

loc_407A4A:                             ; CODE XREF: sub_407970+9E\u2191j
                xor     eax, eax
                jmp     short loc_4079F0
sub_407970      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_407A50      proc near               ; CODE XREF: sub_405E60+655\u2191p
                                        ; sub_405E60+6E1\u2191p

var_1C          = dword ptr -1Ch
arg_0           = dword ptr  4

                sub     esp, 1Ch
                mov     [esp+1Ch+var_1C], 1
                call    sub_407830
                test    eax, eax
                jz      short loc_407A71
                mov     edx, [esp+1Ch+arg_0]
                mov     dword ptr [eax+10h], 1
                mov     [eax+14h], edx

loc_407A71:                             ; CODE XREF: sub_407A50+11\u2191j
                add     esp, 1Ch
                retn
sub_407A50      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_407A80      proc near               ; CODE XREF: sub_405E60+6B7\u2191p
                                        ; sub_407BE0+53\u2193p ...

var_4C          = dword ptr -4Ch
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 3Ch
                mov     edi, [esp+4Ch+arg_0]
                mov     ebp, [esp+4Ch+arg_4]
                mov     esi, [edi+10h]
                mov     ebx, [ebp+10h]
                cmp     esi, ebx
                jge     short loc_407AA5
                mov     eax, esi
                mov     esi, ebx
                mov     ebx, eax
                mov     eax, edi
                mov     edi, ebp
                mov     ebp, eax

loc_407AA5:                             ; CODE XREF: sub_407A80+17\u2191j
                lea     eax, [esi+ebx]
                cmp     eax, [edi+8]
                mov     [esp+4Ch+var_2C], eax
                setnle  al
                movzx   eax, al
                add     eax, [edi+4]
                mov     [esp+4Ch+var_4C], eax
                call    sub_407830
                test    eax, eax
                mov     [esp+4Ch+var_20], eax
                jz      loc_407BD4
                mov     ecx, [esp+4Ch+var_2C]
                lea     eax, [eax+14h]
                mov     [esp+4Ch+var_34], eax
                lea     ecx, [eax+ecx*4]
                mov     edx, ecx
                cmp     eax, edx
                mov     [esp+4Ch+var_24], ecx
                jnb     short loc_407AF5
                mov     edx, [esp+4Ch+var_24]

loc_407AE8:                             ; CODE XREF: sub_407A80+73\u2193j
                mov     dword ptr [eax], 0
                add     eax, 4
                cmp     edx, eax
                ja      short loc_407AE8

loc_407AF5:                             ; CODE XREF: sub_407A80+62\u2191j
                lea     eax, [edi+14h]
                mov     [esp+4Ch+var_28], eax
                lea     eax, [eax+esi*4]
                mov     [esp+4Ch+var_3C], eax
                lea     eax, [ebp+14h]
                lea     ebx, [eax+ebx*4]
                cmp     eax, ebx
                mov     [esp+4Ch+var_38], eax
                mov     [esp+4Ch+var_30], ebx
                jnb     short loc_407B89

loc_407B15:                             ; CODE XREF: sub_407A80+107\u2193j
                add     [esp+4Ch+var_38], 4
                mov     eax, [esp+4Ch+var_38]
                mov     ebp, [eax-4]
                test    ebp, ebp
                jz      short loc_407B7A
                mov     edi, [esp+4Ch+var_34]
                mov     esi, [esp+4Ch+var_28]
                mov     [esp+4Ch+var_44], 0
                mov     [esp+4Ch+var_40], 0
                jmp     short loc_407B42
; ---------------------------------------------------------------------------
                align 10h

loc_407B40:                             ; CODE XREF: sub_407A80+F1\u2193j
                mov     edi, eax

loc_407B42:                             ; CODE XREF: sub_407A80+BD\u2191j
                add     esi, 4
                mov     ecx, [edi]
                mov     eax, ebp
                mul     dword ptr [esi-4]
                xor     ebx, ebx
                add     ecx, eax
                adc     ebx, edx
                add     ecx, [esp+4Ch+var_44]
                adc     ebx, [esp+4Ch+var_40]
                mov     [edi], ecx
                mov     edx, ebx
                mov     eax, edx
                xor     edx, edx
                cmp     [esp+4Ch+var_3C], esi
                mov     [esp+4Ch+var_44], eax
                lea     eax, [edi+4]
                mov     [esp+4Ch+var_40], edx
                ja      short loc_407B40
                mov     eax, [esp+4Ch+var_44]
                mov     [edi+4], eax

loc_407B7A:                             ; CODE XREF: sub_407A80+A3\u2191j
                mov     eax, [esp+4Ch+var_38]
                add     [esp+4Ch+var_34], 4
                cmp     [esp+4Ch+var_30], eax
                ja      short loc_407B15

loc_407B89:                             ; CODE XREF: sub_407A80+93\u2191j
                mov     edi, [esp+4Ch+var_2C]
                test    edi, edi
                jle     short loc_407BC1
                mov     ebx, [esp+4Ch+var_24]
                mov     esi, [ebx-4]
                test    esi, esi
                jnz     short loc_407BC1
                mov     edx, [esp+4Ch+var_2C]
                mov     eax, edx
                shl     eax, 2
                sub     ebx, eax
                mov     eax, ebx
                jmp     short loc_407BB8
; ---------------------------------------------------------------------------
                align 10h

loc_407BB0:                             ; CODE XREF: sub_407A80+13B\u2193j
                mov     ecx, [eax+edx*4-4]
                test    ecx, ecx
                jnz     short loc_407BBD

loc_407BB8:                             ; CODE XREF: sub_407A80+129\u2191j
                sub     edx, 1
                jnz     short loc_407BB0

loc_407BBD:                             ; CODE XREF: sub_407A80+136\u2191j
                mov     [esp+4Ch+var_2C], edx

loc_407BC1:                             ; CODE XREF: sub_407A80+10F\u2191j
                                        ; sub_407A80+11A\u2191j
                mov     eax, [esp+4Ch+var_20]
                mov     ebx, [esp+4Ch+var_2C]
                mov     [eax+10h], ebx

loc_407BCC:                             ; CODE XREF: sub_407A80+156\u2193j
                add     esp, 3Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_407BD4:                             ; CODE XREF: sub_407A80+46\u2191j
                xor     eax, eax
                jmp     short loc_407BCC
sub_407A80      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_407BE0      proc near               ; CODE XREF: sub_405E60+6A7\u2191p
                                        ; sub_405E60+6F7\u2191p ...

var_1C          = dword ptr -1Ch
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                push    ebx
                sub     esp, 1Ch
                mov     ebx, [ebp+arg_4]
                mov     edx, [ebp+arg_0]
                mov     eax, ebx
                and     eax, 3
                jnz     loc_407C98

loc_407BFA:                             ; CODE XREF: sub_407BE0+D7\u2193j
                sar     ebx, 2
                mov     eax, edx
                test    ebx, ebx
                jz      short loc_407C51
                mov     edi, ds:dword_40D080
                test    edi, edi
                jz      loc_407CE6

loc_407C11:                             ; CODE XREF: sub_407BE0+127\u2193j
                                        ; sub_407BE0+142\u2193j
                test    bl, 1
                jnz     short loc_407C29

loc_407C16:                             ; CODE XREF: sub_407BE0+47\u2193j
                sar     ebx, 1
                jz      short loc_407C4F

loc_407C1A:                             ; CODE XREF: sub_407BE0+6D\u2193j
                mov     esi, [edi]
                test    esi, esi
                xchg    ax, ax
                jz      short loc_407C60

loc_407C22:                             ; CODE XREF: sub_407BE0+9D\u2193j
                mov     edi, esi

loc_407C24:                             ; CODE XREF: sub_407BE0+B6\u2193j
                test    bl, 1
                jz      short loc_407C16

loc_407C29:                             ; CODE XREF: sub_407BE0+34\u2191j
                mov     [esp+4], edi
                mov     [esp], edx
                mov     [ebp+var_1C], edx
                call    sub_407A80
                test    eax, eax
                mov     esi, eax
                jz      short loc_407CBD
                mov     edx, [ebp+var_1C]
                mov     [esp], edx
                call    sub_407900
                sar     ebx, 1
                mov     edx, esi
                jnz     short loc_407C1A

loc_407C4F:                             ; CODE XREF: sub_407BE0+38\u2191j
                mov     eax, edx

loc_407C51:                             ; CODE XREF: sub_407BE0+21\u2191j
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_407C60:                             ; CODE XREF: sub_407BE0+40\u2191j
                mov     eax, 1
                mov     [ebp+var_1C], edx
                call    sub_407710
                mov     esi, [edi]
                mov     edx, [ebp+var_1C]
                test    esi, esi
                jz      short loc_407CC7

loc_407C76:                             ; CODE XREF: sub_407BE0+104\u2193j
                cmp     ds:Target, 2
                jnz     short loc_407C22
                mov     dword ptr [esp], offset stru_40D9F8 ; lpCriticalSection
                mov     edi, esi
                mov     [ebp+var_1C], edx
                call    LeaveCriticalSection
                mov     edx, [ebp+var_1C]
                sub     esp, 4
                jmp     short loc_407C24
; ---------------------------------------------------------------------------

loc_407C98:                             ; CODE XREF: sub_407BE0+14\u2191j
                mov     eax, ds:flt_40A49C[eax*4]
                mov     [esp], edx
                mov     dword ptr [esp+8], 0
                mov     [esp+4], eax
                call    sub_407970
                test    eax, eax
                mov     edx, eax
                jnz     loc_407BFA

loc_407CBD:                             ; CODE XREF: sub_407BE0+5C\u2191j
                                        ; sub_407BE0+F9\u2193j
                xor     eax, eax

loc_407CBF:                             ; CODE XREF: sub_407BE0+183\u2193j
                lea     esp, [ebp-0Ch]
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_407CC7:                             ; CODE XREF: sub_407BE0+94\u2191j
                mov     [esp+4], edi
                mov     [esp], edi
                call    sub_407A80
                test    eax, eax
                mov     esi, eax
                mov     [edi], eax
                jz      short loc_407CBD
                mov     dword ptr [eax], 0
                mov     edx, [ebp+var_1C]
                jmp     short loc_407C76
; ---------------------------------------------------------------------------

loc_407CE6:                             ; CODE XREF: sub_407BE0+2B\u2191j
                mov     eax, 1
                mov     [ebp+var_1C], edx
                call    sub_407710
                mov     edi, ds:dword_40D080
                mov     edx, [ebp+var_1C]
                test    edi, edi
                jz      short loc_407D27

loc_407D00:                             ; CODE XREF: sub_407BE0+175\u2193j
                cmp     ds:Target, 2
                jnz     loc_407C11
                mov     dword ptr [esp], offset stru_40D9F8 ; lpCriticalSection
                mov     [ebp+var_1C], edx
                call    LeaveCriticalSection
                mov     edx, [ebp+var_1C]
                sub     esp, 4
                jmp     loc_407C11
; ---------------------------------------------------------------------------

loc_407D27:                             ; CODE XREF: sub_407BE0+11E\u2191j
                mov     dword ptr [esp], 1
                call    sub_407830
                test    eax, eax
                mov     edi, eax
                jz      short loc_407D57
                mov     dword ptr [eax+14h], 271h
                mov     edx, [ebp+var_1C]
                mov     dword ptr [eax+10h], 1
                mov     ds:dword_40D080, eax
                mov     dword ptr [eax], 0
                jmp     short loc_407D00
; ---------------------------------------------------------------------------

loc_407D57:                             ; CODE XREF: sub_407BE0+157\u2191j
                mov     ds:dword_40D080, 0
                xor     eax, eax
                jmp     loc_407CBF
sub_407BE0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_407D70      proc near               ; CODE XREF: sub_405E60+74D\u2191p
                                        ; sub_405E60+767\u2191p ...

var_3C          = dword ptr -3Ch
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 2Ch
                mov     eax, [esp+3Ch+arg_0]
                mov     esi, [esp+3Ch+arg_4]
                mov     edi, eax
                mov     edx, [eax+4]
                mov     eax, [eax+10h]
                mov     ebx, esi
                sar     ebx, 5
                add     eax, ebx
                lea     ebp, [eax+1]
                mov     [esp+3Ch+var_24], eax
                mov     eax, [edi+8]
                cmp     ebp, eax
                jle     short loc_407DA9
                lea     esi, [esi+0]

loc_407DA0:                             ; CODE XREF: sub_407D70+37\u2193j
                add     eax, eax
                add     edx, 1
                cmp     ebp, eax
                jg      short loc_407DA0

loc_407DA9:                             ; CODE XREF: sub_407D70+2A\u2191j
                mov     [esp+3Ch+var_3C], edx
                call    sub_407830
                test    eax, eax
                mov     [esp+3Ch+var_28], eax
                jz      loc_407E79
                test    ebx, ebx
                lea     edx, [eax+14h]
                jle     short loc_407DD7
                xor     eax, eax

loc_407DC6:                             ; CODE XREF: sub_407D70+62\u2193j
                mov     dword ptr [edx+eax*4], 0
                add     eax, 1
                cmp     eax, ebx
                jnz     short loc_407DC6
                lea     edx, [edx+eax*4]

loc_407DD7:                             ; CODE XREF: sub_407D70+52\u2191j
                mov     edi, [esp+3Ch+arg_0]
                mov     eax, [esp+3Ch+arg_0]
                mov     ecx, [edi+10h]
                add     eax, 14h
                and     esi, 1Fh
                mov     [esp+3Ch+var_30], esi
                lea     edi, [eax+ecx*4]
                mov     ecx, edi
                jz      short loc_407E65
                mov     [esp+3Ch+var_2C], 20h ; ' '
                mov     [esp+3Ch+var_20], ebp
                mov     ebp, ecx
                sub     [esp+3Ch+var_2C], esi
                xor     esi, esi
                jmp     short loc_407E12
; ---------------------------------------------------------------------------
                align 10h

loc_407E10:                             ; CODE XREF: sub_407D70+C1\u2193j
                mov     edx, edi

loc_407E12:                             ; CODE XREF: sub_407D70+97\u2191j
                mov     ebx, [eax]
                add     eax, 4
                movzx   ecx, byte ptr [esp+3Ch+var_30]
                lea     edi, [edx+4]
                shl     ebx, cl
                movzx   ecx, byte ptr [esp+3Ch+var_2C]
                or      ebx, esi
                mov     [edx], ebx
                mov     esi, [eax-4]
                shr     esi, cl
                cmp     ebp, eax
                ja      short loc_407E10
                test    esi, esi
                mov     ebp, [esp+3Ch+var_20]
                mov     [edx+4], esi
                jz      short loc_407E45
                mov     ebp, [esp+3Ch+var_24]
                add     ebp, 2

loc_407E45:                             ; CODE XREF: sub_407D70+CC\u2191j
                                        ; sub_407D70+107\u2193j
                mov     edi, [esp+3Ch+var_28]
                lea     eax, [ebp-1]
                mov     [edi+10h], eax
                mov     eax, [esp+3Ch+arg_0]
                mov     [esp+3Ch+var_3C], eax
                call    sub_407900
                mov     eax, edi

loc_407E5D:                             ; CODE XREF: sub_407D70+10B\u2193j
                add     esp, 2Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_407E65:                             ; CODE XREF: sub_407D70+81\u2191j
                mov     ebx, edi

loc_407E67:                             ; CODE XREF: sub_407D70+105\u2193j
                add     eax, 4
                mov     ecx, [eax-4]
                add     edx, 4
                cmp     ebx, eax
                mov     [edx-4], ecx
                ja      short loc_407E67
                jmp     short loc_407E45
; ---------------------------------------------------------------------------

loc_407E79:                             ; CODE XREF: sub_407D70+47\u2191j
                xor     eax, eax
                jmp     short loc_407E5D
sub_407D70      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_407E80      proc near               ; CODE XREF: sub_405E60+7C1\u2191p
                                        ; sub_405E60+C11\u2191p ...

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebx
                mov     ecx, [esp+4+arg_0]
                mov     edx, [esp+4+arg_4]
                mov     eax, [ecx+10h]
                mov     ebx, [edx+10h]
                sub     eax, ebx
                test    eax, eax
                jnz     short loc_407EB9
                shl     ebx, 2
                add     ecx, 14h
                lea     eax, [ecx+ebx]
                lea     edx, [edx+ebx+14h]
                jmp     short loc_407EA8
; ---------------------------------------------------------------------------

loc_407EA4:                             ; CODE XREF: sub_407E80+32\u2193j
                cmp     ecx, eax
                jnb     short loc_407EC0

loc_407EA8:                             ; CODE XREF: sub_407E80+22\u2191j
                sub     edx, 4
                sub     eax, 4
                mov     ebx, [edx]
                cmp     [eax], ebx
                jz      short loc_407EA4
                sbb     eax, eax
                or      eax, 1

loc_407EB9:                             ; CODE XREF: sub_407E80+13\u2191j
                pop     ebx
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_407EC0:                             ; CODE XREF: sub_407E80+26\u2191j
                xor     eax, eax
                pop     ebx
                retn
sub_407E80      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_407ED0      proc near               ; CODE XREF: sub_405E60+C23\u2191p

var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 2Ch
                mov     esi, [esp+3Ch+arg_0]
                mov     ebx, [esp+3Ch+arg_4]
                mov     [esp+3Ch+var_3C], esi
                mov     [esp+3Ch+var_38], ebx
                call    sub_407E80
                test    eax, eax
                jz      loc_408012
                js      loc_408038
                xor     edi, edi

loc_407EFB:                             ; CODE XREF: sub_407ED0+173\u2193j
                mov     eax, [esi+4]
                mov     [esp+3Ch+var_3C], eax
                call    sub_407830
                test    eax, eax
                mov     edx, eax
                mov     [esp+3Ch+var_20], eax
                jz      loc_408048
                mov     [eax+0Ch], edi
                mov     eax, [esi+10h]
                add     esi, 14h
                lea     ebp, [ebx+14h]
                lea     edi, [edx+14h]
                mov     [esp+3Ch+var_34], 0
                mov     [esp+3Ch+var_24], eax
                lea     eax, [esi+eax*4]
                mov     [esp+3Ch+var_2C], eax
                mov     eax, [ebx+10h]
                mov     [esp+3Ch+var_30], 0
                lea     eax, [ebp+eax*4+0]
                mov     [esp+3Ch+var_28], eax
                lea     esi, [esi+0]

loc_407F50:                             ; CODE XREF: sub_407ED0+B7\u2193j
                add     ebp, 4
                add     esi, 4
                mov     ecx, [ebp-4]
                mov     eax, [esi-4]
                xor     edx, edx
                xor     ebx, ebx
                sub     eax, ecx
                sbb     edx, ebx
                sub     eax, [esp+3Ch+var_34]
                sbb     edx, [esp+3Ch+var_30]
                add     edi, 4
                mov     [esp+3Ch+var_30], 0
                mov     ecx, edx
                and     ecx, 1
                cmp     [esp+3Ch+var_28], ebp
                mov     [esp+3Ch+var_34], ecx
                mov     [edi-4], eax
                ja      short loc_407F50
                cmp     [esp+3Ch+var_2C], esi
                jbe     short loc_407FDA
                mov     ebx, [esp+3Ch+var_30]
                mov     ecx, [esp+3Ch+var_34]
                mov     [esp+3Ch+var_28], edi
                mov     [esp+3Ch+var_34], esi
                nop

loc_407FA0:                             ; CODE XREF: sub_407ED0+EF\u2193j
                add     esi, 4
                mov     eax, [esi-4]
                xor     edx, edx
                sub     eax, ecx
                sbb     edx, ebx
                add     edi, 4
                mov     ebp, edx
                xor     ebx, ebx
                and     ebp, 1
                cmp     [esp+3Ch+var_2C], esi
                mov     ecx, ebp
                mov     [edi-4], eax
                ja      short loc_407FA0
                mov     ebp, [esp+3Ch+var_34]
                mov     edi, [esp+3Ch+var_2C]
                mov     ebx, [esp+3Ch+var_28]
                not     ebp
                lea     edx, [ebp+edi+0]
                shr     edx, 2
                lea     edi, [ebx+edx*4+4]

loc_407FDA:                             ; CODE XREF: sub_407ED0+BD\u2191j
                test    eax, eax
                jnz     short loc_407FFF
                mov     edx, [esp+3Ch+var_24]
                mov     eax, edx
                shl     eax, 2
                sub     edi, eax
                mov     eax, edx
                nop
                lea     esi, [esi+0]

loc_407FF0:                             ; CODE XREF: sub_407ED0+129\u2193j
                sub     eax, 1
                mov     ebp, [edi+eax*4-4]
                test    ebp, ebp
                jz      short loc_407FF0
                mov     [esp+3Ch+var_24], eax

loc_407FFF:                             ; CODE XREF: sub_407ED0+10C\u2191j
                mov     eax, [esp+3Ch+var_20]
                mov     edx, [esp+3Ch+var_24]
                mov     [eax+10h], edx

loc_40800A:                             ; CODE XREF: sub_407ED0+17A\u2193j
                add     esp, 2Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_408012:                             ; CODE XREF: sub_407ED0+1D\u2191j
                mov     [esp+3Ch+var_3C], 0
                call    sub_407830
                test    eax, eax
                jz      short loc_408048
                mov     dword ptr [eax+10h], 1
                mov     dword ptr [eax+14h], 0
                add     esp, 2Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_408038:                             ; CODE XREF: sub_407ED0+23\u2191j
                mov     eax, esi
                mov     edi, 1
                mov     esi, ebx
                mov     ebx, eax
                jmp     loc_407EFB
; ---------------------------------------------------------------------------

loc_408048:                             ; CODE XREF: sub_407ED0+3E\u2191j
                                        ; sub_407ED0+150\u2191j
                xor     eax, eax
                jmp     short loc_40800A
sub_407ED0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_408050      proc near               ; CODE XREF: sub_405E60+1A3\u2191p

var_24          = qword ptr -24h
var_18          = dword ptr -18h
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebp
                mov     ecx, 20h ; ' '
                push    edi
                push    esi
                push    ebx
                sub     esp, 14h
                mov     eax, [esp+24h+arg_0]
                mov     edi, [esp+24h+arg_4]
                lea     ebx, [eax+14h]
                mov     eax, [eax+10h]
                lea     ebp, [ebx+eax*4]
                mov     edx, [ebp-4]
                lea     esi, [ebp-4]
                bsr     eax, edx
                xor     eax, 1Fh
                sub     ecx, eax
                cmp     eax, 0Ah
                mov     [edi], ecx
                jg      short loc_4080C0
                mov     ecx, 0Bh
                mov     edi, edx
                sub     ecx, eax
                shr     edi, cl
                or      edi, 3FF00000h
                mov     dword ptr [esp+24h+var_24+4], edi
                xor     edi, edi
                cmp     ebx, esi
                mov     dword ptr [esp+24h+var_24], 0
                jnb     short loc_4080A9
                mov     edi, [ebp-8]
                shr     edi, cl

loc_4080A9:                             ; CODE XREF: sub_408050+52\u2191j
                lea     ecx, [eax+15h]
                shl     edx, cl
                or      edi, edx
                mov     dword ptr [esp+24h+var_24], edi
                fld     [esp+24h+var_24]
                add     esp, 14h
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4080C0:                             ; CODE XREF: sub_408050+30\u2191j
                xor     edi, edi
                cmp     ebx, esi
                jnb     short loc_4080CC
                mov     edi, [ebp-8]
                lea     esi, [ebp-8]

loc_4080CC:                             ; CODE XREF: sub_408050+74\u2191j
                mov     ecx, eax
                sub     ecx, 0Bh
                mov     [esp+24h+var_18], ecx
                jz      short loc_408120
                movzx   ecx, byte ptr [esp+24h+var_18]
                mov     ebp, 2Bh ; '+'
                sub     ebp, eax
                mov     eax, edi
                mov     dword ptr [esp+24h+var_24], 0
                shl     edx, cl
                mov     ecx, ebp
                shr     eax, cl
                or      edx, 3FF00000h
                or      edx, eax
                xor     eax, eax
                cmp     esi, ebx
                mov     dword ptr [esp+24h+var_24+4], edx
                jbe     short loc_408109
                mov     eax, [esi-4]
                shr     eax, cl

loc_408109:                             ; CODE XREF: sub_408050+B2\u2191j
                movzx   ecx, byte ptr [esp+24h+var_18]
                shl     edi, cl
                or      eax, edi
                mov     dword ptr [esp+24h+var_24], eax
                fld     [esp+24h+var_24]
                add     esp, 14h
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_408120:                             ; CODE XREF: sub_408050+85\u2191j
                or      edx, 3FF00000h
                mov     dword ptr [esp+24h+var_24], edi
                mov     dword ptr [esp+24h+var_24+4], edx
                fld     [esp+24h+var_24]
                add     esp, 14h
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
sub_408050      endp

; ---------------------------------------------------------------------------
                align 10h
                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 1Ch
                fld     qword ptr [esp+30h]
                mov     dword ptr [esp], 1
                fstp    qword ptr [esp+8]
                call    sub_407830
                test    eax, eax
                jz      loc_408228
                mov     edx, [esp+0Ch]
                mov     ebx, edx
                and     edx, 7FFFFFFFh
                shr     edx, 14h
                and     ebx, 0FFFFFh
                test    edx, edx
                jz      short loc_408182
                or      ebx, 100000h

loc_408182:                             ; CODE XREF: .text:0040817A\u2191j
                mov     edi, [esp+8]
                test    edi, edi
                jnz     short loc_4081C8
                tzcnt   ecx, ebx
                shr     ebx, cl
                test    edx, edx
                lea     esi, [ecx+20h]
                mov     ecx, 1
                mov     [eax+14h], ebx
                mov     dword ptr [eax+10h], 1
                jz      short loc_4081FC

loc_4081A6:                             ; CODE XREF: .text:004081FA\u2193j
                mov     edi, [esp+38h]
                lea     edx, [esi+edx-433h]
                mov     [edi], edx
                mov     edx, 35h ; '5'
                sub     edx, esi
                mov     esi, [esp+3Ch]
                mov     [esi], edx

loc_4081C0:                             ; CODE XREF: .text:0040822A\u2193j
                add     esp, 1Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4081C8:                             ; CODE XREF: .text:00408188\u2191j
                tzcnt   esi, edi
                mov     ecx, esi
                shr     edi, cl
                test    esi, esi
                jz      short loc_408223
                mov     ecx, 20h ; ' '
                mov     ebp, ebx
                sub     ecx, esi
                shl     ebp, cl
                mov     ecx, ebp
                or      ecx, edi
                mov     [eax+14h], ecx
                mov     ecx, esi
                shr     ebx, cl

loc_4081EA:                             ; CODE XREF: .text:00408226\u2193j
                cmp     ebx, 1
                sbb     ecx, ecx
                add     ecx, 2
                test    edx, edx
                mov     [eax+18h], ebx
                mov     [eax+10h], ecx
                jnz     short loc_4081A6

loc_4081FC:                             ; CODE XREF: .text:004081A4\u2191j
                mov     edi, [esp+38h]
                sub     esi, 432h
                bsr     edx, [eax+ecx*4+10h]
                shl     ecx, 5
                mov     [edi], esi
                mov     esi, [esp+3Ch]
                xor     edx, 1Fh
                sub     ecx, edx
                mov     [esi], ecx
                add     esp, 1Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_408223:                             ; CODE XREF: .text:004081D2\u2191j
                mov     [eax+14h], edi
                jmp     short loc_4081EA
; ---------------------------------------------------------------------------

loc_408228:                             ; CODE XREF: .text:0040815D\u2191j
                xor     eax, eax
                jmp     short loc_4081C0
; ---------------------------------------------------------------------------
                align 10h
                mov     ecx, [esp+8]
                mov     eax, [esp+4]
                lea     edx, [ecx+1]
                movzx   ecx, byte ptr [ecx]
                test    cl, cl
                mov     [eax], cl
                jz      short locret_408254

loc_408244:                             ; CODE XREF: .text:00408252\u2193j
                add     edx, 1
                movzx   ecx, byte ptr [edx-1]
                add     eax, 1
                test    cl, cl
                mov     [eax], cl
                jnz     short loc_408244

locret_408254:                          ; CODE XREF: .text:00408242\u2191j
                rep retn
; ---------------------------------------------------------------------------
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION wcstombs. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION wcslen. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION tolower. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strstr. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION strlen. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcoll. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION setlocale. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION puts. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memset. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION memcpy. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION mbstowcs. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION localeconv. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION isspace. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ftell. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION fseek. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION fread. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputc. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION fopen. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION calloc. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _setmode. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fullpath. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _errno. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __p__fmode. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION __p__environ. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION WideCharToMultiByte. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION VirtualQuery. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION VirtualProtect. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION TlsGetValue. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION Sleep. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION SetUnhandledExceptionFilter. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION MultiByteToWideChar. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION LeaveCriticalSection. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION IsDBCSLeadByteEx. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION InterlockedExchange. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION InitializeCriticalSection. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetProcAddress. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleHandleA. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetLastError. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetCommandLineA. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION FindNextFileA. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION FindFirstFileA. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION FindClose. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION ExitProcess. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h
; [00000006 BYTES: COLLAPSED FUNCTION EnterCriticalSection. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION DeleteCriticalSection. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h

; =============== S U B R O U T I N E =======================================


sub_408450      proc near               ; CODE XREF: sub_403C80+AC\u2191p

var_24          = dword ptr -24h
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 14h
                mov     esi, [esp+24h+arg_C]
                mov     edi, [esp+24h+arg_0]
                mov     ebp, [esp+24h+arg_4]
                mov     ecx, [esp+24h+arg_8]
                test    esi, esi
                mov     [esp+24h+var_24], edi
                mov     eax, ebp
                mov     edx, ecx
                jnz     short loc_4084A0
                cmp     ecx, ebp
                ja      short loc_4084D2
                test    ecx, ecx
                mov     ebx, ecx
                jnz     short loc_408487
                mov     eax, 1
                xor     edx, edx
                div     ecx
                mov     ebx, eax

loc_408487:                             ; CODE XREF: sub_408450+2A\u2191j
                mov     eax, ebp
                xor     edx, edx
                div     ebx
                mov     ebp, eax
                mov     eax, edi
                div     ebx
                mov     edx, ebp

loc_408495:                             ; CODE XREF: sub_408450+74\u2193j
                                        ; sub_408450+E7\u2193j ...
                add     esp, 14h
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4084A0:                             ; CODE XREF: sub_408450+20\u2191j
                cmp     esi, ebp
                ja      short loc_4084C6
                bsr     ebx, esi
                xor     ebx, 1Fh
                jnz     short loc_4084E2
                cmp     ecx, [esp+24h+var_24]
                mov     edx, 0
                jbe     loc_408540
                cmp     esi, ebp
                jb      loc_408540
                xor     eax, eax
                jmp     short loc_408495
; ---------------------------------------------------------------------------

loc_4084C6:                             ; CODE XREF: sub_408450+52\u2191j
                xor     edx, edx
                xor     eax, eax
                add     esp, 14h
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4084D2:                             ; CODE XREF: sub_408450+24\u2191j
                mov     eax, edi
                mov     edx, ebp
                div     ecx
                xor     edx, edx
                add     esp, 14h
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4084E2:                             ; CODE XREF: sub_408450+5A\u2191j
                mov     edi, 20h ; ' '
                mov     ecx, ebx
                sub     edi, ebx
                mov     ebp, edx
                shl     esi, cl
                mov     ecx, edi
                shr     ebp, cl
                mov     ecx, ebx
                shl     edx, cl
                or      ebp, esi
                mov     [esp+24h+var_20], edx
                mov     edx, [esp+24h+var_24]
                mov     ecx, edi
                mov     esi, eax
                shr     esi, cl
                mov     ecx, ebx
                shl     eax, cl
                mov     ecx, edi
                shr     edx, cl
                mov     edi, edx
                mov     edx, esi
                or      edi, eax
                mov     eax, edi
                div     ebp
                mov     esi, edx
                mov     edi, eax
                mul     [esp+24h+var_20]
                cmp     esi, edx
                jb      short loc_408550
                mov     ebp, [esp+24h+var_24]
                mov     ecx, ebx
                shl     ebp, cl
                cmp     ebp, eax
                jnb     short loc_408533
                cmp     esi, edx
                jz      short loc_408550

loc_408533:                             ; CODE XREF: sub_408450+DD\u2191j
                mov     eax, edi
                xor     edx, edx
                jmp     loc_408495
; ---------------------------------------------------------------------------
                align 10h

loc_408540:                             ; CODE XREF: sub_408450+64\u2191j
                                        ; sub_408450+6C\u2191j
                mov     eax, 1
                jmp     loc_408495
; ---------------------------------------------------------------------------
                align 10h

loc_408550:                             ; CODE XREF: sub_408450+D2\u2191j
                                        ; sub_408450+E1\u2191j
                lea     eax, [edi-1]
                xor     edx, edx
                add     esp, 14h
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
sub_408450      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_408560      proc near               ; CODE XREF: sub_403C80+8A\u2191p

var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    ebp
                push    edi
                push    esi
                push    ebx
                sub     esp, 1Ch
                mov     eax, [esp+2Ch+arg_C]
                mov     ecx, [esp+2Ch+arg_0]
                mov     ebp, [esp+2Ch+arg_4]
                mov     ebx, [esp+2Ch+arg_8]
                test    eax, eax
                mov     edx, eax
                mov     [esp+2Ch+var_20], ecx
                mov     esi, ebp
                mov     [esp+2Ch+var_2C], ebx
                mov     [esp+2Ch+var_28], ecx
                mov     [esp+2Ch+var_24], ebp
                jnz     short loc_4085A4
                cmp     ebx, ebp
                jbe     short loc_4085E0
                mov     eax, ecx
                mov     edx, ebp
                div     ebx

loc_408598:                             ; CODE XREF: sub_408560+9B\u2193j
                mov     eax, edx
                xor     edx, edx
                add     esp, 1Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_4085A4:                             ; CODE XREF: sub_408560+2C\u2191j
                cmp     eax, ebp
                ja      short loc_408600
                bsr     edi, eax
                xor     edi, 1Fh
                jnz     short loc_408610
                mov     edi, [esp+2Ch+var_28]
                cmp     [esp+2Ch+var_2C], edi
                ja      loc_4086A1

loc_4085BD:                             ; CODE XREF: sub_408560+145\u2193j
                mov     edi, ebp
                mov     esi, ecx
                sub     esi, ebx
                sbb     edi, eax
                mov     [esp+2Ch+var_28], esi
                mov     [esp+2Ch+var_24], edi

loc_4085CD:                             ; CODE XREF: sub_408560+14B\u2193j
                mov     eax, [esp+2Ch+var_28]
                mov     edx, [esp+2Ch+var_24]
                add     esp, 1Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_4085E0:                             ; CODE XREF: sub_408560+30\u2191j
                test    ebx, ebx
                mov     edi, ebx
                jnz     short loc_4085F1
                mov     eax, 1
                xor     edx, edx
                div     ebx
                mov     edi, eax

loc_4085F1:                             ; CODE XREF: sub_408560+84\u2191j
                mov     eax, ebp
                xor     edx, edx
                div     edi
                mov     eax, ecx
                div     edi
                jmp     short loc_408598
; ---------------------------------------------------------------------------
                align 10h

loc_408600:                             ; CODE XREF: sub_408560+46\u2191j
                mov     eax, ecx
                mov     edx, ebp
                add     esp, 1Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_408610:                             ; CODE XREF: sub_408560+4E\u2191j
                mov     ebp, [esp+2Ch+var_2C]
                mov     ebx, 20h ; ' '
                mov     ecx, edi
                sub     ebx, edi
                shl     edx, cl
                mov     ecx, ebx
                mov     eax, ebp
                shr     eax, cl
                mov     ecx, edi
                mov     [esp+2Ch+var_2C], eax
                mov     eax, ebp
                shl     eax, cl
                mov     ecx, ebx
                mov     ebp, eax
                mov     [esp+2Ch+var_24], eax
                mov     eax, [esp+2Ch+var_20]
                or      [esp+2Ch+var_2C], edx
                mov     edx, esi
                shr     edx, cl
                mov     ecx, edi
                shl     esi, cl
                mov     ecx, ebx
                shr     eax, cl
                mov     ecx, edi
                or      eax, esi
                mov     esi, [esp+2Ch+var_20]
                div     [esp+2Ch+var_2C]
                shl     esi, cl
                mov     [esp+2Ch+var_28], esi
                mov     esi, edx
                mul     ebp
                cmp     esi, edx
                mov     ecx, eax
                mov     ebp, edx
                jb      short loc_408694
                cmp     [esp+2Ch+var_28], eax
                jb      short loc_408690

loc_40866B:                             ; CODE XREF: sub_408560+132\u2193j
                                        ; sub_408560+13F\u2193j
                mov     eax, [esp+2Ch+var_28]
                sub     eax, ecx
                sbb     esi, ebp
                mov     ecx, edi
                mov     edx, esi
                shr     eax, cl
                mov     ecx, ebx
                shl     edx, cl
                mov     ecx, edi
                shr     esi, cl
                or      eax, edx
                mov     edx, esi
                add     esp, 1Ch
                pop     ebx
                pop     esi
                pop     edi
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_408690:                             ; CODE XREF: sub_408560+109\u2191j
                cmp     esi, edx
                jnz     short loc_40866B

loc_408694:                             ; CODE XREF: sub_408560+103\u2191j
                mov     ebp, edx
                mov     ecx, eax
                sub     ecx, [esp+2Ch+var_24]
                sbb     ebp, [esp+2Ch+var_2C]
                jmp     short loc_40866B
; ---------------------------------------------------------------------------

loc_4086A1:                             ; CODE XREF: sub_408560+57\u2191j
                cmp     eax, [esp+2Ch+var_24]
                jb      loc_4085BD
                jmp     loc_4085CD
sub_408560      endp

; [00000006 BYTES: COLLAPSED FUNCTION _stricoll. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup. PRESS CTRL-NUMPAD+ TO EXPAND]
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_4086C0      proc near               ; DATA XREF: .text:004086E4\u2193o
                push    ebp
                mov     ebp, esp
                sub     esp, 18h
                call    sub_401300
                mov     dword ptr [esp], offset sub_401390
                call    sub_4012E0
                leave
                retn
sub_4086C0      endp

; ---------------------------------------------------------------------------
                align 10h
dword_4086E0    dd 0FFFFFFFFh           ; DATA XREF: sub_401BD0-4C\u2191r
                                        ; sub_401BD0:loc_401B93\u2191r ...
                dd offset sub_4086C0
                dd 0
                dd 0FFFFFFFFh
dword_4086F0    dd 44h dup(0)           ; DATA XREF: .data:off_409014\u2193o
                dd 200h dup(?)
_text           ends

; Section 2. (virtual address 00009000)
; Virtual size                  : 00000034 (     52.)
; Section size in file          : 00000200 (    512.)
; Offset to raw data for section: 00007C00
; Flags C0300040: Data Readable Writable
; Alignment     : 4 bytes
; Exported entry   6. start_str
; ===========================================================================

; Segment type: Pure data
; Segment permissions: Read/Write
_data           segment dword public 'DATA' use32
                assume cs:_data
                ;org 409000h
                public start_str
; char start_str[]
start_str       db '/start',0           ; DATA XREF: parse_string+6\u2191o
                                        ; parse_string:loc_401427\u2191o
; Exported entry   2. end_str
                public end_str
end_str         db '/end',0
dword_40900C    dd 2                    ; DATA XREF: sub_401260+B\u2191r
                                        ; sub_401750+9\u2191r ...
dword_409010    dd 4000h                ; DATA XREF: sub_401180+59\u2191w
                                        ; sub_401180+9A\u2191r
off_409014      dd offset dword_4086F0  ; DATA XREF: sub_401B50\u2191r
                                        ; sub_401B50+12\u2191r ...
dword_409018    dd 40h, 0FFFFBFC3h, 3FC0h, 1, 0
                                        ; DATA XREF: sub_4038D0+84\u2191o
off_40902C      dd offset dword_40D0A0  ; DATA XREF: sub_407830:loc_4078C1\u2191r
                                        ; sub_407830+C2\u2191w
dword_409030    dd 0                    ; DATA XREF: sub_401300:loc_401348\u2191r
                                        ; sub_401300+82\u2191o
                align 1000h
_data           ends

; Section 3. (virtual address 0000A000)
; Virtual size                  : 00000880 (   2176.)
; Section size in file          : 00000A00 (   2560.)
; Offset to raw data for section: 00007E00
; Flags 40600040: Data Readable
; Alignment     : 32 bytes
; ===========================================================================

; Segment type: Pure data
; Segment permissions: Read
_rdata          segment align_32 public 'DATA' use32
                assume cs:_rdata
                ;org 40A000h
; const CHAR ModuleName[]
ModuleName      db 'libgcc_s_dw2-1.dll',0
                                        ; DATA XREF: sub_401300+6\u2191o
                                        ; sub_401390+6\u2191o
; const CHAR ProcName[]
ProcName        db '__register_frame_info',0
                                        ; DATA XREF: sub_401300+1E\u2191o
; const CHAR aLibgcj13Dll[]
aLibgcj13Dll    db 'libgcj-13.dll',0    ; DATA XREF: sub_401300+51\u2191o
; const CHAR aJvRegisterclas[]
aJvRegisterclas db '_Jv_RegisterClasses',0
                                        ; DATA XREF: sub_401300+69\u2191o
; const CHAR aDeregisterFram[]
aDeregisterFram db '__deregister_frame_info',0
                                        ; DATA XREF: sub_401390+1E\u2191o
                align 4
; Exported entry   7. var
                public var
var             dd 2
; const char Buffer[]
Buffer          db 0Ah                  ; DATA XREF: _main:loc_4014CC\u2191o
                db 'VERSION: 0.3',0
                align 4
; const char asc_40A078[]
asc_40A078      db 0Ah                  ; DATA XREF: _main+91\u2191o
                db '==============================================================',0
; const char Format[]
Format          db 'ERROR: Variant in binary was changed (%d)<->(%d)',0Ah,0
                                        ; DATA XREF: _main+B8\u2191o
; const char aVariantD[]
aVariantD       db 'Variant: %d',0Ah,0  ; DATA XREF: _main+D3\u2191o
                align 4
; const char asc_40A0F8[]
asc_40A0F8      db '==============================================================',0Ah
                                        ; DATA XREF: _main+DF\u2191o
                db 0
; const char aConfigD[]
aConfigD        db 'config_%d',0        ; DATA XREF: _main+F8\u2191o
aS              db '%s',0               ; DATA XREF: vuln_func+31\u2191o
; const char aBufferS[]
aBufferS        db 'buffer: %s',0Ah,0   ; DATA XREF: vuln_func+55\u2191o
; const char aRb[]
aRb             db 'rb',0               ; DATA XREF: read_config+6\u2191o
; const char aErrorCouldnTOp[]
aErrorCouldnTOp db 'Error: couldn`t open config file ',27h,'%s',27h,0Ah,0
                                        ; DATA XREF: read_config+29\u2191o
                align 4
; const char aReadConfigShel[]
aReadConfigShel db 'read config:  shell_len %d  dst_len %d',0Ah
                                        ; DATA XREF: read_config+103\u2191o
                db 0Ah,0
; const char aErrorVariantDo[]
aErrorVariantDo db 'ERROR: variant does not match',0
                                        ; DATA XREF: read_config+12F\u2191o
                align 4
off_40A1C4      dd offset TlsCallback_0 ; DATA XREF: sub_401180+7\u2191r
aMingwRuntimeFa db 'Mingw runtime failure:',0Ah,0
                                        ; DATA XREF: sub_401F20+1E\u2191o
; const char aVirtualqueryFa[]
aVirtualqueryFa db '  VirtualQuery failed for %d bytes at address %p',0
                                        ; DATA XREF: sub_401F70+D7\u2191o
                align 4
; const char aUnknownPseudoR_0[]
aUnknownPseudoR_0 db '  Unknown pseudo relocation protocol version %d.',0Ah,0
                                        ; DATA XREF: sub_402060+1C5\u2191o
                align 4
; const char aUnknownPseudoR[]
aUnknownPseudoR db '  Unknown pseudo relocation bit size %d.',0Ah,0
                                        ; DATA XREF: sub_402060+BB\u2191o
                align 4
asc_40A274      db '.',0                ; DATA XREF: sub_402970+A8\u2191o
aGlob10Mingw32  db 'glob-1.0-mingw32',0 ; DATA XREF: sub_402F20:loc_402F3E\u2191o
                                        ; sub_402F20+2D\u2191o ...
                align 4
; const char Locale[2]
Locale          db 2 dup(0)             ; DATA XREF: sub_403020:loc_403050\u2191o
; const wchar_t Source
Source          db '.',0                ; DATA XREF: sub_403020+55\u2191o
                                        ; sub_403020+86\u2191o
                align 10h
aS_0            db '%s',0               ; DATA XREF: sub_403420+55\u2191o
                                        ; sub_4034C0+36\u2191o
                align 4
aNan            db 'NaN',0              ; DATA XREF: sub_4048A0+549\u2191o
aInf            db 'Inf',0              ; DATA XREF: sub_4048A0+565\u2191o
aNull_0:                                ; DATA XREF: sub_404E70:loc_40570C\u2191o
                text "UTF-16LE", '(null)',0
aNull           db '(null)',0           ; DATA XREF: sub_404E70+844\u2191o
; const char VarName[]
VarName         db 'PRINTF_EXPONENT_DIGITS',0
                                        ; DATA XREF: sub_404E70+17\u2191o
jpt_404F65      dd offset loc_405500, offset def_404F65, offset def_404F65
                                        ; DATA XREF: sub_404E70+F5\u2191r
                dd offset loc_4054E0, offset def_404F65, offset loc_4054D0 ; jump table for switch statement
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset def_404F65, offset loc_405490, offset loc_405470
                dd offset def_404F65, offset loc_405450, offset loc_405430
                dd offset def_404F65, offset loc_4053C6, offset def_404F65
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset loc_4053A1, offset def_404F65, offset loc_405375
                dd offset def_404F65, offset loc_405350, offset loc_405325
                dd offset loc_405300, offset def_404F65, offset loc_4052D0
                dd offset def_404F65, offset def_404F65, offset loc_404FE0
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset loc_405520, offset def_404F65, offset def_404F65
                dd offset def_404F65, offset def_404F65, offset loc_405180
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset def_404F65, offset def_404F65, offset def_404F65
                dd offset def_404F65, offset def_404F65, offset loc_405150
                dd offset def_404F65, offset loc_405040, offset loc_405270
                dd offset loc_405240, offset loc_405210, offset loc_4051E4
                dd offset loc_4050E0, offset loc_405270, offset loc_4050C0
                dd offset def_404F65, offset loc_404FC7, offset def_404F65
                dd offset loc_405080, offset loc_405180, offset loc_405104
                dd offset def_404F65, offset def_404F65, offset loc_405007
                dd offset loc_404F70, offset loc_405180, offset def_404F65
                dd offset def_404F65, offset loc_405180, offset def_404F65
                dd offset loc_404F70
                align 8
aInfinity       db 'Infinity',0         ; DATA XREF: sub_405E60+180\u2191o
aNan_0          db 'NaN',0              ; DATA XREF: sub_405E60+14C\u2191o
a0              db '0',0                ; DATA XREF: sub_405E60+114\u2191o
                align 4
jpt_405E8C      dd offset loc_405F58    ; DATA XREF: sub_405E60+2C\u2191r
                dd offset loc_405E93    ; jump table for switch statement
                dd offset loc_405E93
                dd offset loc_405FC4
                dd offset loc_405F90
flt_40A45C      dd 1.5                  ; DATA XREF: sub_405E60+1E6\u2191r
dbl_40A460      dq 0.289529654602168    ; DATA XREF: sub_405E60+1EC\u2191r
dbl_40A468      dq 0.1760912590558      ; DATA XREF: sub_405E60+1F2\u2191r
dbl_40A470      dq 0.301029995663981    ; DATA XREF: sub_405E60+1FC\u2191r
dbl_40A478      dq 7.0e-17              ; DATA XREF: sub_405E60+20E\u2191r
dbl_40A480      dq 0.30103              ; DATA XREF: sub_405E60+55D\u2191r
flt_40A488      dd 1.0                  ; DATA XREF: sub_405E60+451\u2191r
                                        ; sub_405E60+483\u2191r
flt_40A48C      dd 10.0                 ; DATA XREF: sub_405E60+479\u2191r
                                        ; sub_405E60+A4C\u2191r ...
flt_40A490      dd 3.0                  ; DATA XREF: sub_405E60+11C6\u2191r
flt_40A494      dd 7.0                  ; DATA XREF: sub_405E60+3BD\u2191r
                                        ; sub_405E60+5A6\u2191r ...
flt_40A498      dd 5.0                  ; DATA XREF: sub_405E60+5BA\u2191r
                                        ; sub_405E60+821\u2191r
flt_40A49C      dd 0.5                  ; DATA XREF: sub_405E60+3F1\u2191r
                                        ; sub_405E60+EBC\u2191r ...
                dd 5, 19h, 7Dh, 3 dup(0)
dbl_40A4B8      dq 0.0                  ; DATA XREF: sub_405E60+3F7\u2191r
                                        ; sub_405E60+E51\u2191r
dbl_40A4C0      dq 1.0                  ; DATA XREF: sub_405E60+25F\u2191r
                                        ; sub_405E60+7F0\u2191r
                dd 0
                dd 40240000h, 0
                dd 40590000h, 0
                dd 408F4000h, 0
                dd 40C38800h, 0
                dd 40F86A00h, 0
                dd 412E8480h, 0
                dd 416312D0h, 0
                dd 4197D784h, 0
aEnna           db 'eÍÍA',0
                db 2 dup(0), 20h
                dd 4202A05Fh, 0E8000000h, 42374876h, 0A2000000h, 426D1A94h
                dd 0E5400000h, 42A2309Ch, 1E900000h, 42D6BCC4h, 26340000h
                dd 430C6BF5h, 37E08000h, 4341C379h, 85D8A000h, 43763457h
                dd 674EC800h, 43ABC16Dh, 60913D00h, 43E158E4h, 78B58C40h
                dd 4415AF1Dh, 0D6E2EF50h, 444B1AE4h, 64DD592h, 4480F0CFh
                dd 2 dup(0)
                dd 97D889BCh, 3C9CD2B2h, 0D5A8A733h, 3949F623h, 44F4A73Dh
                dd 32A50FFDh, 0CF8C979Dh, 255BBA08h, 64AC6F43h, 0AC80628h
                dd 6 dup(0)
                dd 37E08000h, 4341C379h, 0B5056E17h, 4693B8B5h, 0E93FF9F5h
                dd 4D384F03h, 0F9301D32h, 5A827748h, 7F73BF3Ch, 75154FDDh
                dd 6 dup(0)
aGccGnu482      db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu481      db 'GCC: (GNU) 4.8.1',0
                align 4
aGccGnu481_0    db 'GCC: (GNU) 4.8.1',0
                align 4
aGccGnu482_0    db 'GCC: (GNU) 4.8.2',0
                align 10h
aGccGnu482_1    db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_2    db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_3    db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_4    db 'GCC: (GNU) 4.8.2',0
                align 10h
aGccGnu482_5    db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_6    db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_7    db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_8    db 'GCC: (GNU) 4.8.2',0
                align 10h
aGccGnu482_9    db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_10   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_11   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu481_1    db 'GCC: (GNU) 4.8.1',0
                align 10h
aGccGnu482_12   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_13   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_14   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_15   db 'GCC: (GNU) 4.8.2',0
                align 10h
aGccGnu482_16   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_17   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_18   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_19   db 'GCC: (GNU) 4.8.2',0
                align 10h
aGccGnu482_20   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_21   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_22   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu482_23   db 'GCC: (GNU) 4.8.2',0
                align 10h
aGccGnu482_24   db 'GCC: (GNU) 4.8.2',0
                align 4
aGccGnu481_2    db 'GCC: (GNU) 4.8.1',0
                align 4
aGccGnu481_3    db 'GCC: (GNU) 4.8.1',0
                align 4
aGccGnu481_4    db 'GCC: (GNU) 4.8.1',0
                align 10h
dword_40A880    dd 0                    ; DATA XREF: sub_402060:loc_402070\u2191o
                                        ; sub_402060+15\u2191o ...
dword_40A884    dd 0                    ; DATA XREF: sub_402060+46\u2191r
dword_40A888    dd 0                    ; DATA XREF: sub_402060+54\u2191r
dword_40A88C    dd 5Dh dup(0)           ; DATA XREF: sub_402060+5A\u2191o
                align 800h
_rdata          ends

; Section 4. (virtual address 0000B000)
; Virtual size                  : 000015F4 (   5620.)
; Section size in file          : 00001600 (   5632.)
; Offset to raw data for section: 00008800
; Flags 40300040: Data Readable
; Alignment     : 4 bytes
; ===========================================================================

; Segment type: Pure data
; Segment permissions: Read
_eh_fram        segment dword public 'DATA' use32
                assume cs:_eh_fram
                ;org 40B000h
                dd 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 20h, 1Ch, 0FFFF5FE0h
                dd 173h, 80E4100h, 0E430283h, 0A510220h, 0C341080Eh, 0B4A040Eh
                dd 18h, 40h, 0FFFF613Ch, 0DFh, 80E4100h, 0D420285h, 3834405h
                dd 14h, 5Ch, 0FFFF6200h, 3Fh, 400E4300h, 40E7Bh, 10h, 74h
                dd 0FFFF6228h, 15h, 200E4300h, 10h, 88h, 0FFFF6234h, 15h
                dd 200E4300h, 10h, 9Ch, 0FFFF6240h, 7, 0
                dd 10h, 0B0h, 0FFFF623Ch, 7, 0
dword_40B0C0    dd 14h, 0               ; DATA XREF: sub_401300+3F\u2191o
                                        ; sub_401390+37\u2191o
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 2 dup(1Ch), 0FFFF6220h
                dd 8Dh, 80E4100h, 0D420285h, 0C5890205h, 4040Ch, 1Ch, 3Ch
                dd 0FFFF6290h, 42h, 80E4100h, 0D420285h, 0CC57E05h, 404h
                dd 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 2 dup(1Ch), 0FFFF62A8h
                dd 67h, 80E4100h, 0D420285h, 0C5630205h, 4040Ch, 28h, 3Ch
                dd 0FFFF62EFh, 146h, 80E4100h, 0D420285h, 3874B05h, 35030483h
                dd 0C741C301h, 40CC541h, 4, 1Ch, 68h, 0FFFF6409h, 63h
                dd 80E4100h, 0D420285h, 0C55F0205h, 4040Ch, 1Ch, 88h, 0FFFF644Ch
                dd 14Eh, 80E4100h, 0D420285h, 14A0305h, 4040CC5h, 14h
                dd 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 3Ch, 1Ch, 0FFFF6574h
                dd 30Bh, 80E4100h, 0D420285h, 3874605h, 5830486h, 0A015903h
                dd 41C641C3h, 0CC541C7h, 0B410404h, 0A017303h, 41C641C3h
                dd 0CC541C7h, 0B410404h, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 2 dup(1Ch), 0FFFF682Ch
                dd 0DCh, 80E5D00h, 0A4020283h, 42040EC3h, 283080Eh, 14h
                dd 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 10h, 1Ch, 0FFFF68D4h
                dd 3, 0
                dd 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 14h, 1Ch, 0FFFF68B8h
                dd 2Ch, 100E4E00h, 40E5Ch, 20h, 34h, 0FFFF68D0h, 49h, 80E4100h
                dd 0E430283h, 0E0A6D20h, 0EC34108h, 0B4104h, 10h, 58h
                dd 0FFFF68FCh, 1Ch, 0
                dd 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 2 dup(1Ch), 0FFFF68F0h
                dd 43h, 200E4300h, 40E0A55h, 0E600B48h, 4, 38h, 3Ch, 0FFFF6920h
                dd 86h, 80E4100h, 0E410286h, 4303830Ch, 0A64200Eh, 0C3460C0Eh
                dd 0C641080Eh, 0B43040Eh, 0C0E0A6Bh, 80EC346h, 40EC641h
                dd 0B43h, 10h, 78h, 0FFFF6974h, 3, 0
                dd 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 24h, 1Ch, 0FFFF6958h
                dd 62h, 80E4100h, 0D420285h, 3864505h, 57020483h, 41C641C3h
                dd 4040CC5h, 34h, 44h, 0FFFF69A0h, 81h, 80E4100h, 0D420285h
                dd 3864105h, 4F048346h, 0C641C30Ah, 40CC541h, 20B4504h
                dd 41C30A57h, 0CC541C6h, 0B410404h, 2Ch, 7Ch, 0FFFF69F8h
                dd 91h, 80E4100h, 0D420285h, 3834405h, 0C3C50A52h, 4704040Ch
                dd 0A45020Bh, 40CC5C3h, 0B4104h, 28h, 0ACh, 0FFFF6A68h
                dd 97h, 80E4100h, 0D420285h, 0C50A6105h, 4104040Ch, 0A47020Bh
                dd 4040CC5h, 0B44h, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 2 dup(1Ch), 0FFFF6AC4h
                dd 4Ah, 80E4100h, 0E410286h, 4303830Ch, 200Eh, 2 dup(3Ch)
                dd 0FFFF6AF4h, 0E3h, 80E4100h, 0D420285h, 3874105h, 43048643h
                dd 43020583h, 0C641C30Ah, 0C541C741h, 4104040Ch, 0A76020Bh
                dd 41C641C3h, 0CC541C7h, 0B410404h, 34h, 7Ch, 0FFFF6BA4h
                dd 1D1h, 80E6A00h, 0E410287h, 4103860Ch, 483100Eh, 2300E43h
                dd 100E0AE3h, 0C0EC341h, 80EC641h, 40EC741h, 0B41h, 14h
                dd 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 14h, 1Ch, 0FFFF6D64h
                dd 2Bh, 200E4300h, 40E67h, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 34h, 1Ch, 0FFFF6D64h
                dd 76h, 80E4100h, 0E410286h, 4303830Ch, 4002300Eh, 410C0E0Ah
                dd 41080EC3h, 41040EC6h, 0C0E6B0Bh, 80EC341h, 40EC641h
                dd 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 38h, 1Ch, 0FFFF6D94h
                dd 90h, 80E4100h, 0E430287h, 4103860Ch, 483100Eh, 0C30A4D02h
                dd 0C6410C0Eh, 0C741080Eh, 0B41040Eh, 0C0EC378h, 80EC641h
                dd 40EC741h, 6Ch, 58h, 0FFFF6DE8h, 20Fh, 80E4100h, 0E410285h
                dd 4103870Ch, 486100Eh, 83140E41h, 180E4305h, 0E0ADC02h
                dd 0EC34314h, 0EC64110h, 0EC7410Ch, 0EC54108h, 20B4704h
                dd 140E0A86h, 100EC341h, 0C0EC644h, 80EC741h, 40EC541h
                dd 78020B43h, 44140E0Ah, 41100EC3h, 410C0EC6h, 41080EC7h
                dd 41040EC5h, 0Bh, 38h, 0C8h, 0FFFF6F88h, 5Eh, 80E4100h
                dd 0E410285h, 4103870Ch, 486100Eh, 83140E43h, 300E4305h
                dd 140E5002h, 100EC341h, 0C0EC641h, 80EC741h, 40EC541h
                dd 54h, 104h, 0FFFF6FACh, 230h, 80E4100h, 0E410285h, 4303870Ch
                dd 486100Eh, 83140E41h, 400E4305h, 0E0AAA02h, 0EC34114h
                dd 0EC64110h, 0EC7410Ch, 0EC54108h, 20B4104h, 140E0A43h
                dd 100EC343h, 0C0EC641h, 80EC741h, 40EC541h, 0B41h, 30h
                dd 15Ch, 0FFFF7184h, 4Dh, 80E4100h, 0E430287h, 4103860Ch
                dd 483100Eh, 7F200E43h, 0C343100Eh, 0C6410C0Eh, 0C741080Eh
                dd 40Eh, 44h, 190h, 0FFFF71A0h, 61h, 80E4100h, 0E410287h
                dd 4303860Ch, 483100Eh, 2200E45h, 100E0A45h, 0C0EC343h
                dd 80EC641h, 40EC741h, 0E430B41h, 0EC34610h, 0EC6410Ch
                dd 0EC74108h, 4, 10h, 1D8h, 0FFFF71C8h, 19h, 0
                dd 28h, 1ECh, 0FFFF71D4h, 3Ah, 80E4100h, 0E430286h, 4503830Ch
                dd 0E6E200Eh, 0EC3410Ch, 0EC64108h, 4, 3Ch, 218h, 0FFFF71E8h
                dd 5AFh, 80E4100h, 0D420285h, 3874305h, 5830486h, 0C30A5902h
                dd 0C741C641h, 40CC541h, 30B4104h, 0C30A032Dh, 0C741C641h
                dd 40CC541h, 0B4104h, 38h, 258h, 0FFFF7758h, 0DAh, 80E4100h
                dd 0D420285h, 3874605h, 5830486h, 0C30A4602h, 0C741C641h
                dd 40CC541h, 20B4104h, 0C641C381h, 0C543C741h, 4040Ch
                dd 10h, 294h, 0FFFF77FCh, 15h, 0
                dd 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 3Ch, 1Ch, 0FFFF77F0h
                dd 3FDh, 80E4100h, 0D420285h, 3874605h, 5830486h, 0C30AAE02h
                dd 0C741C641h, 40CC541h, 30B4604h, 0C30A0266h, 0C741C643h
                dd 40CC541h, 0B4504h, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 40h, 1Ch, 0FFFF7B98h
                dd 9Ch, 80E4100h, 0D420285h, 3864105h, 78048349h, 0C641C30Ah
                dd 40CC541h, 20B4104h, 41C30A43h, 0CC541C6h, 0B430404h
                dd 0C641C349h, 40CC541h, 4, 28h, 60h, 0FFFF7BF4h, 0CDh
                dd 80E4100h, 0D420285h, 3864205h, 6B020483h, 0C641C30Ah
                dd 40CC541h, 0B4104h, 40h, 8Ch, 0FFFF7C98h, 19Bh, 80E4100h
                dd 0E410285h, 4103870Ch, 486100Eh, 83140E41h, 0C00E4605h
                dd 1290302h, 41140E0Ah, 41100EC3h, 410C0EC6h, 41080EC7h
                dd 41040EC5h, 0Bh, 20h, 0D0h, 0FFFF7DF4h, 46h, 80E4100h
                dd 0E430283h, 0E0A7110h, 0EC34108h, 0B4104h, 24h, 0F4h
                dd 0FFFF7E20h, 44h, 80E4100h, 0D420285h, 3834405h, 0C3C50A6Ah
                dd 4104040Ch, 0Bh, 28h, 11Ch, 0FFFF7E48h, 5Ah, 80E4100h
                dd 0D420285h, 3834405h, 0C3C50A6Bh, 4104040Ch, 0C5C3660Bh
                dd 4040Ch, 18h, 148h, 0FFFF7E7Ch, 27h, 100E4300h, 40E0A51h
                dd 0B41h, 34h, 164h, 0FFFF7E90h, 63h, 80E4100h, 0E410286h
                dd 4303830Ch, 4A02200Eh, 410C0E0Ah, 41080EC3h, 41040EC6h
                dd 0C0E4E0Bh, 80EC341h, 40EC641h, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 20h, 1Ch, 0FFFF7EB0h
                dd 0FEh, 80E4100h, 0E450283h, 0AA90250h, 0C341080Eh, 0B41040Eh
                dd 28h, 40h, 0FFFF7F8Ch, 54h, 80E4100h, 0E430283h, 0E0A6920h
                dd 0EC34108h, 620B4204h, 0C341080Eh, 40Eh, 3Ch, 6Ch, 0FFFF7FC0h
                dd 108h, 80E4100h, 0E410285h, 4103870Ch, 486100Eh, 83140E43h
                dd 600E4505h, 0E0AC102h, 0EC34114h, 0EC64110h, 0EC7410Ch
                dd 0EC54108h, 0B4104h, 2Ch, 0ACh, 0FFFF8090h, 0A7h, 80E4100h
                dd 0E460287h, 4303860Ch, 483100Eh, 0C30A8102h, 0C6410C0Eh
                dd 0C741080Eh, 0B43040Eh, 3Ch, 0DCh, 0FFFF8110h, 8Fh, 80E4100h
                dd 0E410285h, 4103870Ch, 486100Eh, 83140E41h, 300E4305h
                dd 0E0A4102h, 0EC34114h, 0EC64110h, 0EC7410Ch, 0EC54108h
                dd 0B4404h, 30h, 11Ch, 0FFFF8160h, 228h, 80E4100h, 0D420285h
                dd 3874105h, 43048643h, 93030583h, 41C30A01h, 41C741C6h
                dd 4040CC5h, 0B41h, 30h, 150h, 0FFFF835Ch, 2D6h, 80E4100h
                dd 0D420285h, 3874105h, 46048643h, 0AD030583h, 41C30A01h
                dd 41C741C6h, 4040CC5h, 0B43h, 30h, 184h, 0FFFF8608h, 32Fh
                dd 80E4100h, 0D420285h, 3874205h, 83430486h, 1520305h
                dd 0C641C30Ah, 0C541C741h, 4304040Ch, 0Bh, 3Ch, 1B8h, 0FFFF8904h
                dd 0C7h, 80E4100h, 0E440285h, 4303870Ch, 486100Eh, 83140E46h
                dd 300E4805h, 0E0AA302h, 0EC34114h, 0EC64110h, 0EC7410Ch
                dd 0EC54108h, 0B4304h, 34h, 1F8h, 0FFFF8994h, 0ABh, 80E4100h
                dd 0E410286h, 4503830Ch, 7602500Eh, 410C0E0Ah, 41080EC3h
                dd 41040EC6h, 0C0E680Bh, 80EC341h, 40EC641h, 44h, 230h
                dd 0FFFF8A0Ch, 0DDh, 80E4100h, 0E410287h, 4103860Ch, 483100Eh
                dd 2500E45h, 100E0A9Dh, 0C0EC341h, 80EC641h, 40EC741h
                dd 0E690B48h, 0EC34110h, 0EC6410Ch, 0EC74108h, 4, 44h
                dd 278h, 0FFFF8AA4h, 175h, 80E4100h, 0E410287h, 4103860Ch
                dd 483100Eh, 2500E45h, 100E0AD4h, 0C0EC341h, 80EC641h
                dd 40EC741h, 0A6F0B41h, 0C341100Eh, 0C6410C0Eh, 0C741080Eh
                dd 0B41040Eh, 30h, 2C0h, 0FFFF8BDCh, 5C5h, 80E4100h, 0D420285h
                dd 3874105h, 83048647h, 47B0305h, 0C641C30Ah, 0C541C741h
                dd 4704040Ch, 0Bh, 3Ch, 2F4h, 0FFFF9178h, 968h, 80E4100h
                dd 0E410285h, 4103870Ch, 486100Eh, 83140E41h, 700E4305h
                dd 0A013203h, 0C341140Eh, 0C641100Eh, 0C7410C0Eh, 0C541080Eh
                dd 0B43040Eh, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 4Ch, 1Ch, 0FFFF9A90h
                dd 17Bh, 80E4100h, 0D420285h, 3864505h, 0A1020483h, 0C641C30Ah
                dd 40CC541h, 590B4504h, 0C641C30Ah, 40CC541h, 4E0B4504h
                dd 0C641C30Ah, 40CC541h, 20B4104h, 41C30A68h, 0CC541C6h
                dd 0B450404h, 2Ch, 6Ch, 0FFFF9BC0h, 97h, 80E4100h, 0E430286h
                dd 4303830Ch, 7A02400Eh, 410C0E0Ah, 41080EC3h, 41040EC6h
                dd 0Bh, 68h, 9Ch, 0FFFF9C30h, 16Dh, 80E4100h, 0E410285h
                dd 4103870Ch, 486100Eh, 83140E41h, 500E4305h, 0E0ADE02h
                dd 0EC34314h, 0EC64110h, 0EC7410Ch, 0EC54108h, 20B4504h
                dd 140E0A59h, 100EC343h, 0C0EC641h, 80EC741h, 40EC541h
                dd 0A430B41h, 0C343140Eh, 0C641100Eh, 0C7410C0Eh, 0C541080Eh
                dd 0B47040Eh, 20h, 108h, 0FFFF9D34h, 87h, 80E4100h, 0E450283h
                dd 0A760240h, 0C341080Eh, 0B43040Eh, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 24h, 1Ch, 0FFFF9D88h
                dd 89h, 80E4100h, 0D420285h, 0C50A6205h, 4104040Ch, 0C562020Bh
                dd 4040Ch, 34h, 44h, 0FFFF9DF0h, 76h, 80E4100h, 0E410287h
                dd 4103860Ch, 483100Eh, 2300E43h, 100E0A64h, 0C0EC341h
                dd 80EC641h, 40EC741h, 0B43h, 80h, 7Ch, 0FFFF9E38h, 14Bh
                dd 80E4100h, 0E410285h, 4103870Ch, 486100Eh, 83140E43h
                dd 500E4305h, 0E0AA202h, 0EC34114h, 0EC64110h, 0EC7410Ch
                dd 0EC54108h, 4B0B4104h, 43140E0Ah, 41100EC3h, 410C0EC6h
                dd 41080EC7h, 41040EC5h, 0E0A4D0Bh, 0EC34114h, 0EC64410h
                dd 0EC7410Ch, 0EC54108h, 20B4104h, 140E0A53h, 100EC343h
                dd 0C0EC641h, 80EC741h, 40EC541h, 0B41h, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 84h, 1Ch, 0FFFF9EECh
                dd 149Fh, 80E4100h, 0E410285h, 4103870Ch, 486100Eh, 83140E41h
                dd 800E4305h, 1200301h, 41140E0Ah, 41100EC3h, 410C0EC6h
                dd 41080EC7h, 45040EC5h, 0E0A6F0Bh, 0EC34114h, 0EC64110h
                dd 0EC7410Ch, 0EC54108h, 6F0B4104h, 41140E0Ah, 41100EC3h
                dd 410C0EC6h, 41080EC7h, 41040EC5h, 735030Bh, 41140E0Ah
                dd 41100EC3h, 410C0EC6h, 41080EC7h, 41040EC5h, 0Bh, 14h
                dd 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 54h, 1Ch, 0FFFFB2ECh
                dd 112h, 80E4100h, 0E410285h, 4103870Ch, 486100Eh, 83140E41h
                dd 240E4305h, 0E0AC202h, 0EC34114h, 0EC64110h, 0EC7410Ch
                dd 0EC54108h, 790B4304h, 41140E0Ah, 41100EC3h, 410C0EC6h
                dd 41080EC7h, 41040EC5h, 0Bh, 24h, 74h, 0FFFFB3B4h, 3Eh
                dd 80E4100h, 0A700283h, 41040EC3h, 0C30A470Bh, 0B41040Eh
                dd 40EC343h, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 2 dup(1Ch), 0FFFFB3B4h
                dd 32h, 80E4100h, 0E450283h, 80E6720h, 40EC344h, 28h, 3Ch
                dd 0FFFFB3D4h, 43h, 80E4100h, 0E410286h, 4303830Ch, 0E7B200Eh
                dd 0EC3410Ch, 0EC64108h, 4, 10h, 68h, 0FFFFB3F8h, 20h
                dd 0
                dd 3Ch, 7Ch, 0FFFFB404h, 1FBh, 80E4100h, 0E410285h, 4103870Ch
                dd 486100Eh, 83140E41h, 600E4305h, 0E01EF03h, 0EC34114h
                dd 0EC64110h, 0EC7410Ch, 0EC54108h, 4, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 2Ch, 1Ch, 0FFFFB5ACh
                dd 0C5h, 80E4100h, 0D420285h, 3834105h, 0C3C50A7Fh, 4104040Ch
                dd 0A68020Bh, 40CC5C3h, 0B4404h, 24h, 4Ch, 0FFFFB64Ch
                dd 44h, 80E4100h, 0D420285h, 0C50A6005h, 4104040Ch, 0CC55F0Bh
                dd 404h, 2Ch, 74h, 0FFFFB674h, 0CDh, 80E4100h, 0D440285h
                dd 3874605h, 5830486h, 0C30A8202h, 0C741C641h, 40CC541h
                dd 0B4104h, 30h, 0A4h, 0FFFFB714h, 64h, 80E4100h, 0D420285h
                dd 3834405h, 0C3C50A74h, 4504040Ch, 0C50A440Bh, 4040CC3h
                dd 0C3530B4Ch, 4040CC5h, 3Ch, 0D8h, 0FFFFB750h, 0DEh, 80E4100h
                dd 0E430285h, 4103870Ch, 486100Eh, 83140E41h, 400E4305h
                dd 0E0A7A02h, 0EC34114h, 0EC64110h, 0EC7410Ch, 0EC54108h
                dd 0B4104h, 14h, 118h, 0FFFFB7F0h, 25h, 200E4300h, 40E61h
                dd 3Ch, 130h, 0FFFFB808h, 158h, 80E4100h, 0E410285h, 4103870Ch
                dd 486100Eh, 83140E41h, 500E4305h, 0A014803h, 0C341140Eh
                dd 0C641100Eh, 0C7410C0Eh, 0C541080Eh, 0B41040Eh, 3Ch
                dd 170h, 0FFFFB928h, 188h, 80E4100h, 0D420285h, 3874605h
                dd 5830486h, 0C30A6C02h, 0C741C641h, 40CC541h, 20B4804h
                dd 41C30A63h, 41C741C6h, 4040CC5h, 0B41h, 3Ch, 1B0h, 0FFFFBA78h
                dd 10Dh, 80E4100h, 0E410285h, 4103870Ch, 486100Eh, 83140E41h
                dd 400E4305h, 0E0AE902h, 0EC34114h, 0EC64110h, 0EC7410Ch
                dd 0EC54108h, 0B4104h, 20h, 1F0h, 0FFFFBB48h, 44h, 80E4100h
                dd 0A790283h, 46040EC3h, 0EC3430Bh, 4, 54h, 214h, 0FFFFBB74h
                dd 17Ch, 80E4100h, 0E410285h, 4103870Ch, 486100Eh, 83140E41h
                dd 400E4305h, 0A013603h, 0C341140Eh, 0C641100Eh, 0C7410C0Eh
                dd 0C541080Eh, 0B41040Eh, 140E0A61h, 100EC341h, 0C0EC641h
                dd 80EC741h, 40EC541h, 0B41h, 68h, 26Ch, 0FFFFBC9Ch, 0E8h
                dd 80E4100h, 0E460285h, 4103870Ch, 486100Eh, 83140E41h
                dd 280E4305h, 0E0A5D02h, 0EC34114h, 0EC64110h, 0EC7410Ch
                dd 0EC54108h, 20B4304h, 140E0A5Bh, 100EC341h, 0C0EC641h
                dd 80EC741h, 40EC541h, 0E530B41h, 0EC34114h, 0EC64110h
                dd 0EC7410Ch, 0EC54108h, 4, 54h, 2D8h, 0FFFFBD20h, 0ECh
                dd 80E4100h, 0E410285h, 4103870Ch, 486100Eh, 83140E41h
                dd 300E4305h, 0E0A7C02h, 0EC34114h, 0EC64110h, 0EC7410Ch
                dd 0EC54108h, 20B4104h, 140E0A56h, 100EC341h, 0C0EC641h
                dd 80EC741h, 40EC541h, 0B41h, 10h, 330h, 0FFFFBDB8h, 26h
                dd 0
                dd 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 7Ch, 1Ch, 0FFFFBFACh
                dd 10Dh, 80E4100h, 0E410285h, 4103870Ch, 486100Eh, 83140E41h
                dd 280E4305h, 0E0A4102h, 0EC34114h, 0EC64110h, 0EC7410Ch
                dd 0EC54108h, 6D0B4404h, 41140E0Ah, 41100EC3h, 410C0EC6h
                dd 41080EC7h, 41040EC5h, 0E0A4B0Bh, 0EC34114h, 0EC64110h
                dd 0EC7410Ch, 0EC54108h, 20B4104h, 41140E76h, 41100EC3h
                dd 410C0EC6h, 41080EC7h, 40EC5h, 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 80h, 1Ch, 0FFFFC024h
                dd 150h, 80E4100h, 0E410285h, 4103870Ch, 486100Eh, 83140E41h
                dd 300E4305h, 140E0A78h, 100EC341h, 0C0EC641h, 80EC741h
                dd 40EC541h, 0A740B41h, 0C341140Eh, 0C641100Eh, 0C7410C0Eh
                dd 0C541080Eh, 0B44040Eh, 140E0A67h, 100EC341h, 0C0EC641h
                dd 80EC741h, 40EC541h, 78020B45h, 41140E0Ah, 41100EC3h
                dd 410C0EC6h, 41080EC7h, 44040EC5h, 0Bh, 0
                dd 14h, 0
                dd 527A01h, 1087C01h, 4040C1Bh, 188h, 2 dup(1Ch), 0FFFFC0E4h
                dd 19h, 80E4100h, 0D420285h, 0CC55505h, 404h, 3 dup(0)
                align 1000h
_eh_fram        ends

; Section 5. (virtual address 0000D000)
; Virtual size                  : 00000A60 (   2656.)
; Section size in file          : 00000000 (      0.)
; Offset to raw data for section: 00000000
; Flags C0600080: Bss Readable Writable
; Alignment     : 32 bytes
; ===========================================================================

; Segment type: Uninitialized
; Segment permissions: Read/Write
_bss            segment align_32 public 'BSS' use32
                assume cs:_bss
                ;org 40D000h
                assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; char **argv
argv            dd ?                    ; DATA XREF: sub_401180+BA\u2191r
                                        ; sub_401260+10\u2191o ...
; int argc
argc            dd ?                    ; DATA XREF: sub_401180+C3\u2191r
                                        ; sub_401260+18\u2191o ...
dword_40D008    dd 6 dup(?)             ; DATA XREF: sub_401300+37\u2191o
; int Mode
Mode            dd ?                    ; DATA XREF: sub_401180+4A\u2191r
                                        ; sub_401180+6D\u2191r ...
dword_40D024    dd ?                    ; DATA XREF: sub_401A60+35\u2191w
                                        ; sub_401A60+41\u2191w ...
dword_40D028    dd ?                    ; DATA XREF: sub_401BD0\u2191r
                                        ; sub_401BD0:loc_401BE0\u2191w
                dd 3 dup(?)
TlsIndex        dd ?                    ; DATA XREF: .tls:TlsIndex_ptr\u2193o
dword_40D03C    dd ?                    ; DATA XREF: sub_401CE0+14\u2191r
                                        ; .text:00401DA1\u2191r ...
dword_40D040    dd ?                    ; DATA XREF: .text:00401D5A\u2191r
                                        ; .text:00401DE7\u2191r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection _RTL_CRITICAL_SECTION <?>
                                        ; DATA XREF: sub_401CE0+8\u2191o
                                        ; sub_401CE0:loc_401D2C\u2191o ...
dword_40D05C    dd ?                    ; DATA XREF: sub_402060\u2191r
                                        ; sub_402060+1D\u2191w
                dd ?
dword_40D064    dd ?                    ; DATA XREF: TlsCallback_0+5\u2191r
                                        ; TlsCallback_0+12\u2191w
; void *Block
Block           dd ?                    ; DATA XREF: sub_403020+70\u2191r
                                        ; sub_403020+7D\u2191w ...
byte_40D06C     db ?                    ; DATA XREF: sub_404E70:loc_404FB0\u2191r
                align 10h
dword_40D070    dd ?                    ; DATA XREF: .text:loc_405BF0\u2191o
dword_40D074    dd ?                    ; DATA XREF: .text:loc_405B60\u2191o
dword_40D078    dd 2 dup(?)             ; DATA XREF: sub_405960:loc_4059F0\u2191o
dword_40D080    dd ?                    ; DATA XREF: sub_407BE0+23\u2191r
                                        ; sub_407BE0+113\u2191r ...
                align 20h
dword_40D0A0    dd 240h dup(?)          ; DATA XREF: sub_407830+AC\u2191o
                                        ; .data:off_40902C\u2191o
dword_40D9A0    dd ?                    ; DATA XREF: sub_407830+18\u2191r
                                        ; sub_407830+2C\u2191w ...
                dd 9 dup(?)
; LONG Target
Target          dd ?                    ; DATA XREF: sub_407710+9\u2191r
                                        ; sub_407710:loc_40773F\u2191r ...
                align 20h
; struct _RTL_CRITICAL_SECTION stru_40D9E0
stru_40D9E0     _RTL_CRITICAL_SECTION <?>
                                        ; DATA XREF: sub_407710+5F\u2191o
                                        ; sub_407710+96\u2191o ...
; struct _RTL_CRITICAL_SECTION stru_40D9F8
stru_40D9F8     _RTL_CRITICAL_SECTION <?>
                                        ; DATA XREF: sub_407710+6E\u2191o
                                        ; sub_4077E0+33\u2191o ...
                align 20h
; Exported entry   1. cfg
                public cfg
cfg             dd ?                    ; DATA XREF: _main+117\u2191o
dword_40DA24    dd ?                    ; DATA XREF: parse_string+28\u2191r
dword_40DA28    dd ?                    ; DATA XREF: parse_string+22\u2191r
                align 800h
_bss            ends

;
; Imports from func.dll
;
; Section 7. (virtual address 0000F000)
; Virtual size                  : 00000798 (   1944.)
; Section size in file          : 00000800 (   2048.)
; Offset to raw data for section: 0000A000
; Flags C0300040: Data Readable Writable
; Alignment     : 4 bytes
; ===========================================================================

; Segment type: Externs
; _idata
                extrn __imp_Func1:dword ; DATA XREF: Func1\u2191r

;
; Imports from KERNEL32.dll
;
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
                extrn __imp_DeleteCriticalSection:dword
                                        ; DATA XREF: DeleteCriticalSection\u2191r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
                extrn __imp_EnterCriticalSection:dword
                                        ; DATA XREF: EnterCriticalSection\u2191r
; void __stdcall __noreturn ExitProcess(UINT uExitCode)
                extrn __imp_ExitProcess:dword
                                        ; DATA XREF: ExitProcess\u2191r
; BOOL __stdcall FindClose(HANDLE hFindFile)
                extrn __imp_FindClose:dword
                                        ; DATA XREF: FindClose\u2191r
; HANDLE __stdcall FindFirstFileA(LPCSTR lpFileName, LPWIN32_FIND_DATAA lpFindFileData)
                extrn __imp_FindFirstFileA:dword
                                        ; DATA XREF: FindFirstFileA\u2191r
; BOOL __stdcall FindNextFileA(HANDLE hFindFile, LPWIN32_FIND_DATAA lpFindFileData)
                extrn __imp_FindNextFileA:dword
                                        ; DATA XREF: FindNextFileA\u2191r
; LPSTR __stdcall GetCommandLineA()
                extrn __imp_GetCommandLineA:dword
                                        ; DATA XREF: GetCommandLineA\u2191r
; DWORD __stdcall GetLastError()
                extrn __imp_GetLastError:dword
                                        ; DATA XREF: GetLastError\u2191r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
                extrn __imp_GetModuleHandleA:dword
                                        ; DATA XREF: GetModuleHandleA\u2191r
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
                extrn __imp_GetProcAddress:dword
                                        ; DATA XREF: GetProcAddress\u2191r
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
                extrn __imp_InitializeCriticalSection:dword
                                        ; DATA XREF: InitializeCriticalSection\u2191r
; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
                extrn __imp_InterlockedExchange:dword
                                        ; DATA XREF: InterlockedExchange\u2191r
; BOOL __stdcall IsDBCSLeadByteEx(UINT CodePage, BYTE TestChar)
                extrn __imp_IsDBCSLeadByteEx:dword
                                        ; DATA XREF: IsDBCSLeadByteEx\u2191r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
                extrn __imp_LeaveCriticalSection:dword
                                        ; DATA XREF: LeaveCriticalSection\u2191r
; int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar)
                extrn __imp_MultiByteToWideChar:dword
                                        ; DATA XREF: MultiByteToWideChar\u2191r
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
                extrn __imp_SetUnhandledExceptionFilter:dword
                                        ; DATA XREF: SetUnhandledExceptionFilter\u2191r
; void __stdcall Sleep(DWORD dwMilliseconds)
                extrn __imp_Sleep:dword ; DATA XREF: Sleep\u2191r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
                extrn __imp_TlsGetValue:dword
                                        ; DATA XREF: TlsGetValue\u2191r
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
                extrn __imp_VirtualProtect:dword
                                        ; DATA XREF: VirtualProtect\u2191r
; SIZE_T __stdcall VirtualQuery(LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
                extrn __imp_VirtualQuery:dword
                                        ; DATA XREF: VirtualQuery\u2191r
; int __stdcall WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWCH lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCCH lpDefaultChar, LPBOOL lpUsedDefaultChar)
                extrn __imp_WideCharToMultiByte:dword
                                        ; DATA XREF: WideCharToMultiByte\u2191r

;
; Imports from msvcrt.dll
;
; char *__cdecl _strdup(const char *String)
                extrn __imp__strdup:dword ; DATA XREF: _strdup\u2191r
; int __cdecl _stricoll(const char *String1, const char *String2)
                extrn __imp__stricoll:dword
                                        ; DATA XREF: _stricoll\u2191r

;
; Imports from msvcrt.dll
;
                extrn __imp___getmainargs:dword
                                        ; DATA XREF: __getmainargs\u2191r
; int _mb_cur_max
                extrn __mb_cur_max:dword
                                        ; DATA XREF: sub_405960:loc_405974\u2191r
                                        ; .text:loc_405A5E\u2191r ...
; char ***__cdecl __p__environ()
                extrn __imp___p__environ:dword
                                        ; DATA XREF: __p__environ\u2191r
; int *__cdecl __p__fmode()
                extrn __imp___p__fmode:dword
                                        ; DATA XREF: __p__fmode\u2191r
; void __cdecl _set_app_type(_crt_app_type Type)
                extrn __set_app_type:dword
                                        ; CODE XREF: start+A\u2191p
                                        ; .text:004012CA\u2191p
                                        ; DATA XREF: ...
; void __cdecl _cexit()
                extrn __imp__cexit:dword ; DATA XREF: _cexit\u2191r
; int *__cdecl _errno()
                extrn __imp__errno:dword ; DATA XREF: _errno\u2191r
; char *__cdecl _fullpath(char *Buffer, const char *Path, size_t BufferCount)
                extrn __imp__fullpath:dword
                                        ; DATA XREF: _fullpath\u2191r
; FILE iob[]
                extrn _iob:dword        ; DATA XREF: sub_401180+53\u2191r
                                        ; sub_401F20+5\u2191r
; _onexit_t __cdecl onexit(_onexit_t Func)
                extrn _onexit:dword     ; DATA XREF: .text:004012F0\u2191r
; int __cdecl _setmode(int FileHandle, int Mode)
                extrn __imp__setmode:dword
                                        ; DATA XREF: _setmode\u2191r
; void __cdecl __noreturn abort()
                extrn __imp_abort:dword ; DATA XREF: abort\u2191r
; int __cdecl atexit(void (__cdecl *)())
                extrn atexit:dword      ; DATA XREF: sub_4012E0\u2191r
; int __cdecl atoi(const char *String)
                extrn __imp_atoi:dword  ; DATA XREF: atoi\u2191r
; void *__cdecl calloc(size_t Count, size_t Size)
                extrn __imp_calloc:dword ; DATA XREF: calloc\u2191r
; void __cdecl __noreturn exit(int Code)
                extrn __imp_exit:dword  ; DATA XREF: exit\u2191r
; int __cdecl fclose(FILE *Stream)
                extrn __imp_fclose:dword ; DATA XREF: fclose\u2191r
; int __cdecl fflush(FILE *Stream)
                extrn __imp_fflush:dword ; DATA XREF: fflush\u2191r
; FILE *__cdecl fopen(const char *FileName, const char *Mode)
                extrn __imp_fopen:dword ; DATA XREF: fopen\u2191r
; int __cdecl fputc(int Character, FILE *Stream)
                extrn __imp_fputc:dword ; DATA XREF: fputc\u2191r
; size_t __cdecl fread(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
                extrn __imp_fread:dword ; DATA XREF: fread\u2191r
; void __cdecl free(void *Block)
                extrn __imp_free:dword  ; DATA XREF: free\u2191r
; int __cdecl fseek(FILE *Stream, int Offset, int Origin)
                extrn __imp_fseek:dword ; DATA XREF: fseek\u2191r
; int __cdecl ftell(FILE *Stream)
                extrn __imp_ftell:dword ; DATA XREF: ftell\u2191r
; size_t __cdecl fwrite(const void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
                extrn __imp_fwrite:dword ; DATA XREF: fwrite\u2191r
; char *__cdecl getenv(const char *VarName)
                extrn __imp_getenv:dword ; DATA XREF: getenv\u2191r
; int __cdecl isspace(int C)
                extrn __imp_isspace:dword ; DATA XREF: isspace\u2191r
; struct lconv *__cdecl localeconv()
                extrn __imp_localeconv:dword
                                        ; DATA XREF: localeconv\u2191r
; void *__cdecl malloc(size_t Size)
                extrn __imp_malloc:dword ; DATA XREF: malloc\u2191r
; size_t __cdecl mbstowcs(wchar_t *Dest, const char *Source, size_t MaxCount)
                extrn __imp_mbstowcs:dword
                                        ; DATA XREF: mbstowcs\u2191r
; void *__cdecl memcpy(void *, const void *Src, size_t Size)
                extrn __imp_memcpy:dword ; DATA XREF: memcpy\u2191r
; void *__cdecl memset(void *, int Val, size_t Size)
                extrn __imp_memset:dword ; DATA XREF: memset\u2191r
; int printf(const char *const Format, ...)
                extrn __imp_printf:dword ; DATA XREF: printf\u2191r
; int __cdecl puts(const char *Buffer)
                extrn __imp_puts:dword  ; DATA XREF: puts\u2191r
; void *__cdecl realloc(void *Block, size_t Size)
                extrn __imp_realloc:dword ; DATA XREF: realloc\u2191r
; char *__cdecl setlocale(int Category, const char *Locale)
                extrn __imp_setlocale:dword
                                        ; DATA XREF: setlocale\u2191r
; _crt_signal_t __cdecl signal(int Signal, _crt_signal_t Function)
                extrn __imp_signal:dword ; DATA XREF: signal\u2191r
; int sprintf(char *const Buffer, const char *const Format, ...)
                extrn __imp_sprintf:dword ; DATA XREF: sprintf\u2191r
; char *__cdecl strchr(const char *Str, int Val)
                extrn __imp_strchr:dword ; DATA XREF: strchr\u2191r
; int __cdecl strcoll(const char *String1, const char *String2)
                extrn __imp_strcoll:dword ; DATA XREF: strcoll\u2191r
; size_t __cdecl strlen(const char *Str)
                extrn __imp_strlen:dword ; DATA XREF: strlen\u2191r
; char *__cdecl strstr(const char *Str, const char *SubStr)
                extrn __imp_strstr:dword ; DATA XREF: strstr\u2191r
; int __cdecl tolower(int C)
                extrn __imp_tolower:dword ; DATA XREF: tolower\u2191r
; int __cdecl vfprintf(FILE *const Stream, const char *const Format, va_list ArgList)
                extrn __imp_vfprintf:dword
                                        ; DATA XREF: vfprintf\u2191r
; size_t __cdecl wcslen(const wchar_t *String)
                extrn __imp_wcslen:dword ; DATA XREF: wcslen\u2191r
; size_t __cdecl wcstombs(char *Dest, const wchar_t *Source, size_t MaxCount)
                extrn __imp_wcstombs:dword
                                        ; DATA XREF: wcstombs\u2191r


; Section 8. (virtual address 00010000)
; Virtual size                  : 00000018 (     24.)
; Section size in file          : 00000200 (    512.)
; Offset to raw data for section: 0000A800
; Flags C0300040: Data Readable Writable
; Alignment     : 4 bytes
; ===========================================================================

; Segment type: Pure data
; Segment permissions: Read/Write
_CRT            segment dword public 'DATA' use32
                assume cs:_CRT
                ;org 410000h
                dd 0
TlsCallbacks    dd offset TlsCallback_0 ; DATA XREF: .tls:TlsCallbacks_ptr\u2193o
                dd offset TlsCallback_1
                dd 0
                dd 0
dword_410014    dd 0                    ; DATA XREF: TlsCallback_0:loc_401C73\u2191o
                                        ; TlsCallback_0+38\u2191o ...
                align 1000h
_CRT            ends

; Section 9. (virtual address 00011000)
; Virtual size                  : 00000020 (     32.)
; Section size in file          : 00000200 (    512.)
; Offset to raw data for section: 0000AA00
; Flags C0300040: Data Readable Writable
; Alignment     : 4 bytes
; ===========================================================================

; Segment type: Pure data
; Segment permissions: Read/Write
_tls            segment dword public 'DATA' use32
                assume cs:_tls
                ;org 411000h
                db 0
TlsStart        db 3 dup(0)             ; DATA XREF: .tls:TlsDirectory\u2193o
TlsDirectory    dd offset TlsStart
TlsEnd_ptr      dd offset TlsEnd
TlsIndex_ptr    dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
TlsEnd          dd 79h dup(0)           ; DATA XREF: .tls:TlsEnd_ptr\u2191o
                align 1000h
_tls            ends


                end start
